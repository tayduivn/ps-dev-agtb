/*
Copyright 2017 SugarCRM, Inc.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
(function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@sugarcrm/d3-sugar")):"function"==typeof define&&define.amd?define(["exports","@sugarcrm/d3-sugar"],e):e(t.sucrose=t.sucrose||{},t.d3sugar)})(this,function(t,e){"use strict";function n(t,e,n){return function(){var r=n.apply(e,arguments);return r===e?t:r}}function r(){function t(d){return d.each(function(d){function m(){return j.range().length>1?Math.abs(j.range()[1]-j.range()[0]):0}function w(){return j.range().length>1?Math.max(.25,1-B.round(j.bandwidth()/m(),2)):0}function k(){return"function"==typeof j.rangeExtent?j.rangeExtent():j.range()}function M(){return h?j.bandwidth():0}function I(){return h?j.range()[0]:0}function A(){return I()/L()}function L(){var t=0,n;return h?t=j.range().length>1?Math.abs(j.range()[1]-j.range()[0]):e.max(k())/2:(n=j.ticks(it.size()),t=j(n[n.length-1])-j(n[n.length-2])),t}function T(t){if("rtl"===o){if("start"===t)return"end";if("end"===t)return"start"}return t}function E(){return"left"!==s&&"bottom"!==s}function P(t){t=t||1,S=F.tickPadding()+(Z?v:y)*t}function z(){N(),v=e.max(J,function(t){return t.width}),y=e.max(J,function(t){return t.height})}function N(){J=[],Q={},a&&ct.style("opacity",1).attr("transform",function(t,e){var n=Z?"0,"+j(t):j(t)+",0";return"translate("+n+")"}),dt.each(function(t,e){var n=this.getBoundingClientRect();n.width>0&&J.push({key:t,width:parseInt(n.width,10),height:parseInt(n.height,10),left:n.left,right:n.right,top:n.top,bottom:n.bottom})}),J.sort(function(t,e){return t.key-e.key}).forEach(function(t,e){t.index=e,Q["key-"+t.key.toString()]=t}),tt=J[0],et=J[J.length-1]}function H(t){N();for(var e=a?2:t||1,n=a?1:0,r=J.length-e;r>n;n+=1)if(J[n].right+U>J[n+t].left)return!0;return!1}function _(t){var e=t?(t+180)%180:0,n=e>90,r=null,a=null;if(J.forEach(function(t,i){var o=null===r||t.left<=r,s=null===a||t.right>=a,l=0,c=0,u=0;(o||s)&&(u=e?t.width-6:t.width/2,l=j(t.key)+h*M()/2,!o||e&&!n||(r=t.left,c=Math.abs(q[0]-l),Y.left=Math.max(u-c,0)),!s||e&&n||(a=t.right,c=Math.abs(q[1]-l),Y.right=Math.max(u-c,0)))}),!h){var i=C.right-Math.max(C.right,Y.right);i+=C.left-Math.max(C.left,Y.left);var o=[q[0],q[1]+i];j.range(o),q=k(),X=Math.abs(q[1]-q[0]),F.scale(j),at.call(F)}}function R(){Y={top:0,right:0,bottom:0,left:0},j=n.copy(),q=k(),X=Math.abs(q[1]-q[0]),F.scale(n),at.call(F),dt.selectAll("tspan").remove(),dt.attr("dy",Z?".32em":.355+.355*K+"em").attr("x",Z?F.tickPadding()*K:0).attr("y",Z?0:F.tickPadding()*K).attr("transform","translate(0,0)").style("text-anchor","middle").style("opacity",1),ut.text(function(t,e,n){return b(t,e,n,"maxmin")}),z(),P()}function O(){var t=L();dt.each(function(n,r,a){var i=b(n,r,a,"no-ellipsis"),o=e.select(this),s=B.isValidDate(B.parseDatetime(i)),l=1===K?.71:-1,c=0,u=(i&&""!==i?s?i:i.replace("/","/ "):[]).split(" "),d=u.length;this.textContent="";var f,h=o.append("tspan").text(u[c]+" ").attr("dy",l+"em").attr("x",0);for(c+=1,l=1;d>c;)for(h=o.append("tspan").text(u[c]+" ").attr("dy",l+"em").attr("x",0),c+=1;d>c;){if(f=h.text(),h.text(f+" "+u[c]),!(this.getBoundingClientRect().width<=t)){h.text(f);break}c+=1}}),z(),P()}function V(){dt.attr("transform",function(t,e){var n=Q["key-"+t.toString()].index%2*y;return"translate(0,"+n+")"}),z(),P(2)}function W(t){var e=(t+180)%180,n=e>90,r=(e-(n?180:0))*K,a=T(n?"end":"start"),i=Math.abs(Math.cos(t*Math.PI/180));dt.attr("transform",function(t,e,n){return"translate(0,"+F.tickPadding()*K+") rotate("+r+")"}).attr("y","0").style("text-anchor",a),z(),P(),S+=11*i}var G=e.select(this),j=F.scale().copy(),Y={top:0,right:0,bottom:0,left:0},q=k(),X=Math.abs(q[1]-q[0]);D=D||F.scale();var Z="left"===s||"right"===s?!0:!1,K="left"===s||"top"===s?-1:1,U=6,$=0,J=[],Q={},tt={},et={};S=0,null!==p?F.ticks(p):Z?F.ticks(Math.ceil(X/48)):F.ticks(Math.ceil(X/100)),F.tickFormat(function(t,e,n){return b(t,e,n,"axis")}),u&&!B.isNumeric(String(u))&&(u=30),h&&(a=!1);var nt=G.selectAll("g.sc-wrap.sc-axis").data([d]),rt=nt.enter().append("g").attr("class","sc-wrap sc-axis").append("g").attr("class","sc-axis-inner"),at=G.select(".sc-axis-inner").merge(rt);at.call(F);var it=at.selectAll("g.tick"),ot=a?e.extent(n.domain()):[],st=at.selectAll("g.sc-axisMaxMin").data(ot),lt=st.enter().append("g").attr("class","sc-axisMaxMin");st.exit().remove();var ct=at.selectAll("g.sc-axisMaxMin").merge(lt);lt.append("text").style("opacity",0),lt.append("line").style("opacity",0);var ut=ct.select("text"),dt=at.selectAll("g.tick, g.sc-axisMaxMin").select("text").filter(function(t){return this.getBoundingClientRect().width}),ft=r?[r]:[],ht=at.selectAll("text.sc-axislabel").data(ft),gt=ht.enter().append("text").attr("class","sc-axislabel");ht.exit().remove();var pt=at.selectAll("text.sc-axislabel").merge(gt);pt.text(B.identity);var mt=!1,vt=!1,yt=!1;if(Z?(R(!0),dt.style("text-anchor",T(g||(E()?"start":"end")))):(R(!1),_(),H(1)&&(l&&(R(!1),O(),_(),O(),H(1)||(mt=!0)),!mt&&c&&(R(!1),V(),_(),V(),H(2)||(vt=!0)),mt||vt||(u||(u=30),R(!0),W(u),_(u),W(u),yt=!0))),a?(ct.select("line").attr("x1",0).attr("y1",0).attr("y2",Z?0:(F.tickSize()-Y.bottom)*K).attr("x2",Z?F.tickSize()*K:0).style("opacity",function(t,e){return E()?e?0:1:e?1:0}),it.each(function(t,n){var r=e.select(this),a=Q["key-"+t.toString()],i=!1;Z?(i=a.bottom>tt.top||a.top<et.bottom,r.select("line").style("opacity",1-i)):i=yt?!1:vt?(a.left<tt.right+U||a.right>et.left+U)&&(a.bottom<tt.top||a.top>et.bottom):a.left<tt.right+U||a.right>et.left+U,r.select("text").style("opacity",1-i)})):(it.filter(function(t){return j(t)===q[0+E()]}).classed("zero",i),it.select("line").style("opacity",function(t,e){return j(t)===q[0+E()]?0:1})),r){var bt=Z?f?X/-2:(S+x)*K:X/2,xt=Z?f?(S+x)*K:X/2:(S+x)*K;pt.attr("x",bt).attr("y",xt).attr("dy",.355+.355*K+"em").attr("transform",Z&&f?"rotate(-90)":"").style("text-anchor",Z&&!f?T("end"):"middle"),pt.each(function(t,e){$+=Z?parseInt(this.getBoundingClientRect().width/1.3,10):parseInt(this.getBoundingClientRect().height/1.3,10)}),S+=$+x}D=n.copy(),C={top:Y.top,right:Y.right,bottom:Y.bottom,left:Y.left},C[s]=S,t.resizeTickLines=function(t){at.selectAll("g.tick, g.sc-axisMaxMin").select("line").attr(Z?"x2":"y2",t*K)},t.labelThickness=function(){return $}}),t}var n=e.scaleLinear(),r=null,a=!0,i=!0,o="ltr",s="bottom",l=!1,c=!1,u=30,d=!1,f=!0,h=!1,g=null,p=null,m=4,v=0,y=0,b=function(t){return t},x=8,w,k,M,I,A,C={top:0,right:0,bottom:0,left:0},S=0,F=e.axisBottom(),D;return t.axis=F,B.rebind(t,n,"domain","range"),t.width=function(e){return arguments.length?t:S},t.height=function(e){return arguments.length?t:S},t.margin=function(e){return arguments.length?(C=e,t):C},t.ticks=function(e){return arguments.length?(p=e,t):p},t.axisLabel=function(e){return arguments.length?(r=e,t):r},t.showMaxMin=function(e){return arguments.length?(a=e,t):a},t.highlightZero=function(e){return arguments.length?(i=e,t):i},t.wrapTicks=function(e){return arguments.length?(l=e,t):l},t.rotateTicks=function(e){return arguments.length?(u=e,t):u},t.staggerTicks=function(e){return arguments.length?(c=e,t):c},t.reduceXTicks=function(e){return arguments.length?(d=e,t):d},t.rotateYLabel=function(e){return arguments.length?(f=e,t):f},t.axisLabelDistance=function(e){return arguments.length?(x=e,t):x},t.maxLabelWidth=function(e){return arguments.length?(v=e,t):v},t.textAnchor=function(e){return arguments.length?(g=e,t):g},t.direction=function(e){return arguments.length?(o=e,t):o},t.orient=function(n){return arguments.length?(s=n,F="bottom"===s?e.axisBottom():"right"===s?e.axisRight():"left"===s?e.axisLeft():"top"===s?e.axisTop():e.axisBottom(),t):s},t.scale=function(e){return arguments.length?(n=e,F.scale(n),h="function"==typeof n.padding,B.rebind(t,n,"domain","range"),t):n},t.valueFormat=function(e){return arguments.length?(b=e,t):b||F.tickFormat()},t.tickFormat=function(e){return arguments.length?(w=e,F.tickFormat(e),t):w||F.tickFormat()},t.tickValues=function(e){return arguments.length?(k=e,F.tickValues(e),t):k},t.tickSize=function(e){return arguments.length?(M=e,F.tickSize(e),t):M},t.tickPadding=function(e){return arguments.length?(m=e,F.tickPadding(e),t):m},t.tickSizeInner=function(e){return arguments.length?(I=e,F.tickSizeInner(e),t):I},t.tickSizeOuter=function(e){return arguments.length?(A=e,F.tickSizeOuter(e),t):A},t}function a(){function t(o){return o.each(function(o){function f(){F=W(ut),D=G(),L=j(ut)}function h(){var t=V(D,F),n=0,r=4,a=F-2*w*D,i=D;o.forEach(function(e,o){e.values.forEach(function(e){e._height=ct>0?O(t*e.value/ct,a):0,e._height<r?(n+=e._height-r,e._height=r):0>n&&e._height+n>r&&(e._height+=n,n=0),e._base=a,e._bottom=i,e._top=e._bottom-e._height,a+=2*w*e._height,i-=e._height})});var s=M||e.extent(e.merge(o.map(function(t){return t.values.map(function(t){return t._top})})).concat(I));k.domain(s).range([D,0])}function g(){At.selectAll("polyline").remove(),At.selectAll("rect").remove(),At.selectAll("text").remove(),At.append("rect").attr("class","sc-label-box").attr("x",0).attr("y",0).attr("width",0).attr("height",0).attr("rx",2).attr("ry",2).style("pointer-events","none").style("stroke-width",0).style("fill-opacity",0),At.append("text").text(c).call(tt,"sc-label",.85,"middle",J),At.select(".sc-label").call(N,A?z:H,Y,function(t,e){tt(t,"sc-label",e,"middle",J)}),At.append("text").text(u).call(tt,"sc-value",.85,"middle",J),At.select(".sc-value").append("tspan").text(d),At.call(et).call(Z).call(nt),At.classed("sc-label-side",function(t){return t.tooTall||t.tooWide})}function T(){var t=0,n=0,r,a,i,o;for(Ct=At.filter(".sc-label-side"),Ct.selectAll(".sc-label").remove(),Ct.selectAll("rect").remove(),Ct.selectAll("polyline").remove(),Ct.append("text").text(c).call(tt,"sc-label",.85,"start","#555"),Ct.select(".sc-label").call(N,A?z:H,A?q:_,function(t,e){tt(t,"sc-label",e,"start","#555")}),Ct.call(et),Ct.select(".sc-value").style("text-anchor","start").style("fill","#555"),Ct.call(K),r=Ct.nodes(),i=r.length-1;i>=0;i-=1)if(n=e.select(r[i]).data()[0]){if(!t){n.labelBottom=n.labelTop+n.labelHeight+st,t=n.labelBottom;continue}n.labelTop=Math.max(t,n.labelTop),n.labelBottom=n.labelTop+n.labelHeight+st,t=n.labelBottom}if(t&&t-st>e.max(k.range())){for(t=0,r=Ct.nodes(),a=0,o=r.length;o>a;a+=1)if(n=e.select(r[a]).data()[0]){if(!t){n.labelBottom=D-1,n.labelTop=n.labelBottom-n.labelHeight,t=n.labelTop;continue}n.labelBottom=Math.min(t,n.labelBottom),n.labelTop=n.labelBottom-n.labelHeight-st,t=n.labelTop}0>t&&Ct.each(function(e){e.labelTop-=t,e.labelBottom-=t})}t=0,Ct.call($)}function E(){g(),T()}function P(t,e,n){return{id:i,key:c(e),value:s(e),count:l(e),data:e,series:e.series,seriesIndex:e.series.seriesIndex,e:t}}function z(t,n,r,a){var i=n.text(),o=parseFloat(n.attr("dy")),s,l=i.split(/\s+/).reverse(),c=[],u=0,d=r(t,0),f=e.select(n.node().parentNode);for(n.text(null);s=l.pop();)c.push(s),n.text(c.join(" ")),n.node().getBoundingClientRect().width>d&&c.length>1&&(c.pop(),n.text(c.join(" ")),c=[s],n=f.append("text"),n.text(s).call(a,1.1*++u+o))}function N(t,n,r,a){t.each(function(t){var i=e.select(this);n(t,i,r,a)})}function H(t,e,n,r){var a=e.text(),i=parseFloat(e.attr("dy")),o=n(t);e.text(B.stringEllipsify(a,it,o)).call(r,i)}function _(t){var e=Math.max(rt-at/1.1,C),n=t._bottom,r=n*w,a=e+r,i=Math.abs(t.labelBottom-n),o=i*w,s=ot+o+ot+ot,l=a-s;return Math.max(l,C)}function R(t,e,n){var r=t._bottom,a=t._top,i=n/2-w*r,o=n/2-w*a,s=L;return s-i+","+r*e+" "+(s-o)+","+a*e+" "+(s+o)+","+a*e+" "+(s+i)+","+r*e}function O(t,e){var n=e/w/2;return Math.abs(Math.sqrt(t/w+n*n))-n}function V(t,e){return t*(e-t*w)}function W(t){return Math.round(Math.max(Math.min(at/1.1,rt-t),40))}function G(){return Math.min(1.1*F,(F-F*w)/(2*w))}function j(t){return F/2+t}function Y(t){var e=F,n=t._bottom-t._height/2;return e-n*w*2}function q(t,e){var n=Math.max((rt-F)/2,e),r=t._top;return n+r*w}function X(t){return e.select(t).node().getBoundingClientRect()}function Z(t){t.each(function(t){var e=X(this);t.labelHeight=e.height,t.labelWidth=e.width,t.labelTop=t._bottom-t._height/2-t.labelHeight/2,t.labelBottom=t.labelTop+t.labelHeight+st,t.tooWide=t.labelWidth>Y(t),t.tooTall=t.labelHeight>t._height-4})}function K(t){t.each(function(t){var e=X(this);t.labelHeight=e.height,t.labelWidth=e.width,t.labelTop=t._top,t.labelBottom=t.labelTop+t.labelHeight+st})}function U(t){for(var n=t.size(),r=t.nodes(),a=r.length-1;a>=0;--a){var i=e.select(r[a]),o=i.data()[0],s=n-1>a?e.select(r[a+1]).data()[0]:null,l=a?e.select(r[a-1]).data()[0]:null,c=Math.round(o.labelHeight)+.5,u=Math.round(o._bottom-o.labelTop)-.5,d=s?s.labelWidth-(o.labelBottom-s.labelBottom)*w:0,f=o.labelWidth,h=l&&u>c?l.labelWidth:0,g=Math.round(Math.max(d,f,h))+ot,p=Math.round(q(o,ut))-lt-ot,m="0,"+c+" "+g+","+c+" "+(g+Math.abs(c-u)*w)+","+u+" "+p+","+u;o.labelWidth=g,i.attr("points",m)}}function $(t){var e=(rt-F)/2,n=0;t.each(function(t){var e=t._bottom,r=Math.abs(t.labelBottom+ot-e)*w,a=e*w,i=t.labelWidth+r+3*ot-a;i>=n&&(n=i)}),n=Math.round(10*n)/10,0>=n?(lt=e,ut=e):n>0&&e>n?(lt=e-n,ut=e):(lt=0,ut=n)}function J(t,n,r){var a=e.select(this.parentNode).style("fill");return B.getTextContrast(a,n)}function Q(t){return B.isRTLChar(t.slice(-1))?"rtl":"ltr"}function tt(t,e,n,r,a){t.attr("x",0).attr("y",0).attr("dy",n+"em").attr("class",e).attr("direction",function(){return"ltr"}).style("pointer-events","none").style("text-anchor",r).style("fill",a)}function et(t){t.each(function(t){var n=e.select(this),r=n.selectAll(".sc-label").size()+1,a=.85+r-1+"em";n.select(".sc-value").attr("dy",a)})}function nt(t){t.each(function(t,n){var r=e.select(this);r.select(".sc-label-box").attr("x",(t.labelWidth+6)/-2).attr("y",-2).attr("width",t.labelWidth+6).attr("height",t.labelHeight+4).attr("rx",2).attr("ry",2).style("fill-opacity",1)})}var rt=r-n.left-n.right,at=a-n.top-n.bottom,it=e.select(this),ot=5,st=5,lt=0,ct=0,ut=0;ct=e.sum(o,function(t){return t.value}),f(),h();var dt=it.selectAll("g.sc-wrap").data([o]),ft=dt.enter().append("g").attr("class","sc-wrap sc-funnel"),ht=it.select(".sc-wrap.sc-funnel").merge(ft),gt=ft.append("defs"),pt=ht.select("defs");if(ht.attr("transform",B.translation(n.left,n.top)),b)var mt=B.createTexture(gt,i);t.gradientFill=function(t,e,n){var r=i+"-"+e,a=m(t,e);return v(t,r,n,a,pt)};var vt=ht.selectAll(".sc-series").data(o,function(t){return t.seriesIndex}),yt=vt.enter().append("g").attr("class","sc-series");vt.exit().remove();var bt=ht.selectAll(".sc-series").merge(yt);yt.style("stroke","#FFF").style("stroke-width",2).style("stroke-opacity",1).on("mouseover",function(t,n,r){e.select(this).classed("hover",!0)}).on("mouseout",function(t,n,r){e.select(this).classed("hover",!1)}),bt.attr("class",function(t){return x(t,t.seriesIndex)}).attr("fill",function(t){return y(t,t.seriesIndex)}).classed("sc-active",function(t){return"active"===t.active}).classed("sc-inactive",function(t){return"inactive"===t.active}),bt.transition().duration(p).style("stroke-opacity",1).style("fill-opacity",1);var xt=bt.selectAll("g.sc-slice").data(function(t){return t.values},function(t){return t.seriesIndex});xt.exit().remove();var wt=xt.enter().append("g").attr("class","sc-slice"),kt=bt.selectAll("g.sc-slice").merge(wt);wt.append("polygon").attr("class","sc-base"),kt.select("polygon.sc-base").attr("points",function(t){return R(t,0,F)}),b&&(wt.append("polygon").attr("class","sc-texture").style("mask","url("+mt+")"),kt.select("polygon.sc-texture").attr("points",function(t){return R(t,0,F)})),wt.on("mouseover",function(t,n){e.select(this).classed("hover",!0);var r=P(e.event,t,n);S.call("elementMouseover",this,r)}).on("mousemove",function(t,n){var r=e.event;S.call("elementMousemove",this,r)}).on("mouseout",function(t,n){e.select(this).classed("hover",!1),S.call("elementMouseout",this)}).on("click",function(t,n){e.event.stopPropagation();var r=P(e.event,t,n);S.call("elementClick",this,r)}).on("dblclick",function(t,n){e.event.stopPropagation();var r=P(e.event,t,n);S.call("elementDblClick",this,r)});var Mt=bt.selectAll(".sc-label-value").data(function(t){return t.values},function(t){return t.seriesIndex});Mt.exit().remove();var It=Mt.enter().append("g").attr("class","sc-label-value"),At=bt.selectAll("g.sc-label-value").merge(It);At.attr("transform","translate("+L+",0)");var Ct=At.filter(".sc-label-side");E(),f(),h(),E(),f(),h(),E(),f(),h(),kt.select(".sc-base").attr("points",function(t){return R(t,1,F)}),b&&kt.selectAll(".sc-texture").attr("points",function(t){return R(t,1,F)}).style("fill",J),At.attr("transform",function(t){var e=t.tooTall?0:L,n=t.tooTall?0:t.labelTop;return"translate("+e+","+n+")"}),Ct.attr("transform",function(t){return"translate("+lt+","+t.labelTop+")"}),Ct.append("polyline").attr("class","sc-label-leader").style("fill-opacity",0).style("stroke","#999").style("stroke-width",1).style("stroke-opacity",.5),Ct.selectAll("polyline").call(U)}),t}var n={top:0,right:0,bottom:0,left:0},r=960,a=500,i=Math.floor(1e4*Math.random()),o=function(t){return(t.series||t).key},s=function(t,e){return(t.series||t).value},l=function(t,e){return(t.series||t).count},c=function(t){return o(t)},u=function(t){return s(t)},d=function(t){return isNaN(l(t))?"":" ("+l(t)+")"},f=B.buildLocality(),h="ltr",g=0,p=0,m=function(t,e){return B.defaultColor()(t.series,t.seriesIndex)},v=B.colorLinearGradient,y=m,b=!1,x=function(t,e){return"sc-series sc-series-"+t.seriesIndex},w=.3,k=e.scaleLinear(),M=null,I=[0],A=!0,C=75,S=e.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove"),F=0,D=0,L=0;return t.dispatch=S,t.id=function(e){return arguments.length?(i=e,t):i},t.color=function(e){return arguments.length?(m=e,t):m},t.fill=function(e){return arguments.length?(y=e,t):y},t.classes=function(e){return arguments.length?(x=e,t):x},t.gradient=function(e){return arguments.length?(v=e,t):v},t.margin=function(e){return arguments.length?(n.top="undefined"!=typeof e.top?e.top:n.top,n.right="undefined"!=typeof e.right?e.right:n.right,n.bottom="undefined"!=typeof e.bottom?e.bottom:n.bottom,n.left="undefined"!=typeof e.left?e.left:n.left,t):n},t.width=function(e){return arguments.length?(r=e,t):r},t.height=function(e){return arguments.length?(a=e,t):a},t.getKey=function(e){return arguments.length?(o=e,t):o},t.getValue=function(e){return arguments.length?(s=e,t):s},t.getCount=function(e){return arguments.length?(l=e,t):l},t.fmtKey=function(e){return arguments.length?(c=e,t):c},t.fmtValue=function(e){return arguments.length?(u=e,t):u},t.fmtCount=function(e){return arguments.length?(d=e,t):d},t.direction=function(e){return arguments.length?(h=e,t):h},t.delay=function(e){return arguments.length?(g=e,t):g},t.duration=function(e){return arguments.length?(p=e,t):p},t.locality=function(e){return arguments.length?(f=B.buildLocality(e),t):f},t.textureFill=function(e){return arguments.length?(b=e,t):b},t.yScale=function(e){return arguments.length?(k=e,t):k},t.yDomain=function(e){return arguments.length?(M=e,t):M},t.forceY=function(e){return arguments.length?(I=e,t):I},t.wrapLabels=function(e){return arguments.length?(A=e,t):A},t.minLabelWidth=function(e){return arguments.length?(C=e,t):C},t}function i(){function t(o){return o.each(function(o){function l(t,n,r){return{point:n,index:r,e:e.event,id:i}}function c(t){L=t,ht.transition().duration(v).ease(e.easeElastic).attr("transform","rotate("+d(t)+")"),J.select(".sc-odomText").text(L),J.call(u)}function u(t){var e=t.select(".sc-odomText").node().getBoundingClientRect();t.select(".sc-odomBox").attr("d",B.roundedRectangle(-e.width/2,-e.height+W(1.5),e.width+W(4),e.height+W(2),W(2))),t.attr("transform","translate("+H+","+(n.top+W(70)+e.height)+")")}function d(t){return P+R(t)*_}function f(t){return B.angleToRadians(d(t.y0))}function h(t){return B.angleToRadians(d(t.y1))}function g(){return"translate("+H+","+H+")"}function p(t){var e=(h(t)-f(t))/(2*Math.PI);return e>C?1:0}var m=r-n.left-n.right,I=a-n.top-n.bottom,F=e.select(this),H=Math.min(m/2,I)/((100+N)/100),_=z-P,R=e.scaleLinear().range([0,1]).domain([T,E]),O=0,V=o.map(function(t,e){var n={key:t.key,seriesIndex:t.seriesIndex,y0:O,y1:t.y,color:t.color,classes:t.classes,values:t.values};return O=t.y,n}),W=function(t){return t*H/100},G=F.selectAll("g.sc-wrap").data([o]),j=G.enter().append("g").attr("class","sc-wrap sc-gauge"),Y=F.select(".sc-wrap.sc-gauge").merge(j),q=j.append("defs"),X=Y.select("defs");j.append("g").attr("class","sc-group");var Z=Y.select(".sc-group");j.append("g").attr("class","sc-labels");var K=Y.select(".sc-labels");j.append("g").attr("class","sc-pointer");var U=Y.select(".sc-pointer"),$=j.append("g").attr("class","sc-odometer"),J=Y.select(".sc-odometer");Y.attr("transform","translate("+(n.left/2+n.right/2+W(N))+","+(n.top+W(N))+")"),t.gradientFill=function(t,e){var n=i+"-"+e,r={x:0,y:0,r:H,s:M/100,u:"userSpaceOnUse"},a=y(t,e);return b(t,n,r,a,X)},Z.attr("transform",g);var Q=Z.selectAll(".sc-series").data(V),tt=Q.enter().append("g").attr("class","sc-series");Q.exit().remove();var et=Z.selectAll(".sc-series").merge(tt);tt.style("stroke","#FFF").style("stroke-width",2).style("stroke-opacity",0).on("mouseover",function(t,n,r){e.select(this).classed("hover",!0)}).on("mouseout",function(t,n,r){e.select(this).classed("hover",!1)}),et.attr("class",function(t){return w(t,t.seriesIndex)}).attr("fill",function(t){return x(t,t.seriesIndex)}).classed("sc-active",function(t){return"active"===t.active}).classed("sc-inactive",function(t){return"inactive"===t.active});var nt=e.arc().innerRadius(W(M)).outerRadius(H).startAngle(f).endAngle(h),rt=et.selectAll("g.sc-slice").data(function(t,e){return t.values.map(function(e,n){return e.y0=t.y0,e.y1=t.y1,e})},function(t){return t.seriesIndex});rt.exit().remove();var at=rt.enter().append("g").attr("class","sc-slice"),it=et.selectAll("g.sc-slice").merge(at);at.append("path").attr("class","sc-base").attr("d",nt).on("mouseover",function(t,n){e.select(this).classed("hover",!0);var r=l(e.event,t,n);k.call("elementMouseover",this,r)}).on("mousemove",function(t,n){var r=e.event;k.call("elementMousemove",this,r)}).on("mouseout",function(t,n){e.select(this).classed("hover",!1),k.call("elementMouseout",this)}).on("click",function(t,n){e.event.stopPropagation();var r=l(e.event,t,n);k.call("elementClick",this,r)}).on("dblclick",function(t,n){e.event.stopPropagation();var r=l(e.event,t,n);k.call("elementDblClick",this,r)}),it.select(".sc-base").attr("d",nt).style("stroke-opacity",1);var ot=o.map(function(t){return t.values[0]});K.attr("transform",g);var st=K.selectAll("text").data(ot),lt=st.enter().append("text");st.exit().remove();var ct=K.selectAll("text").merge(lt);if(ct.attr("transform",function(t){return"rotate("+d(t.y)+") translate(0,"+(W(-1.5)-H)+")"}).text(s).style("fill-opacity",p).style("text-anchor","middle").style("font-size",W(.6)+"em"),A){var ut=[[Math.round(W(S)/2),0],[0,-Math.round(W(D))],[-Math.round(W(S)/2),0],[0,Math.round(W(S))],[Math.round(W(S)/2),0]];U.attr("transform",g);var dt=U.selectAll("path").data([ut]),ft=dt.enter().append("path").attr("transform","rotate("+P+")");dt.exit().remove();var ht=U.selectAll("path").merge(ft);ht.attr("d",e.line()),$.append("text").attr("class","sc-odom sc-odomText").attr("x",0).attr("y",0).style("text-anchor","middle").style("stroke","none").style("fill","black"),J.select(".sc-odomText").style("font-size",W(.7)+"em").text(L),$.insert("path",".sc-odomText").attr("class","sc-odom sc-odomBox").attr("fill","#EFF").attr("stroke","black").attr("stroke-width","2px").attr("opacity",.8),J.call(u)}else U.selectAll("path").remove(),J.select(".sc-odomText").remove(),J.select(".sc-odomBox").remove();t.setGaugePointer=c}),t}var n={top:0,right:0,bottom:0,left:0},r=null,a=null,i=Math.floor(1e4*Math.random()),o=function(t){return t.key},s=function(t){return t.y},l=function(t){return"undefined"==typeof t.key?t:t.key},c=function(t,e){return isNaN(t.value)?t:t.value},u=function(t,e){return isNaN(t.count)?t:t.count},d=function(t){return l(t)},f=function(t){return c(t)},h=function(t){return(" ("+u(t)+")").replace(" ()","")},g=B.buildLocality(),p="ltr",m=0,v=0,y=function(t,e){return B.defaultColor()(t,t.seriesIndex)},b=B.colorRadialGradient,x=y,w=function(t,e){return"sc-slice sc-series-"+t.seriesIndex},k=e.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove"),M=50,I=!0,A=!0,C=.01,S=5,F=5,D=90,L=0,T=0,E=10,P=-90,z=90,N=10;return t.dispatch=k,t.id=function(e){return arguments.length?(i=e,t):i},t.color=function(e){return arguments.length?(y=e,t):y},t.fill=function(e){return arguments.length?(x=e,t):x},t.classes=function(e){return arguments.length?(w=e,t):w},t.gradient=function(e){return arguments.length?(b=e,t):b},t.margin=function(e){return arguments.length?(n.top="undefined"!=typeof e.top?e.top:n.top,n.right="undefined"!=typeof e.right?e.right:n.right,n.bottom="undefined"!=typeof e.bottom?e.bottom:n.bottom,n.left="undefined"!=typeof e.left?e.left:n.left,t):n},t.width=function(e){return arguments.length?(r=e,t):r},t.height=function(e){return arguments.length?(a=e,t):a},t.x=function(e){return arguments.length?(o=e,t):o},t.y=function(e){return arguments.length?(s=B.functor(e),t):s},t.getKey=function(e){return arguments.length?(l=e,t):l},t.getValue=function(e){return arguments.length?(c=e,t):c},t.getCount=function(e){return arguments.length?(u=e,t):u},t.fmtKey=function(e){return arguments.length?(d=e,t):d},t.fmtValue=function(e){return arguments.length?(f=e,t):f},t.fmtCount=function(e){return arguments.length?(h=e,t):h},t.direction=function(e){return arguments.length?(p=e,t):p},t.delay=function(e){return arguments.length?(m=e,t):m},t.duration=function(e){return arguments.length?(v=e,t):v},t.locality=function(e){return arguments.length?(g=B.buildLocality(e),t):g},t.showLabels=function(e){return arguments.length?(I=e,t):I},t.labelThreshold=function(e){return arguments.length?(C=e,t):C},t.ringWidth=function(e){return arguments.length?(M=e,t):M},t.pointerWidth=function(e){return arguments.length?(S=e,t):S},t.pointerTailLength=function(e){return arguments.length?(F=e,t):F},t.pointerHeadLength=function(e){return arguments.length?(D=e,t):D},t.setPointer=function(e){return arguments.length?(t.setGaugePointer(e),t):t.setGaugePointer},t.showPointer=function(e){return arguments.length?(A=e,t):A},t.minValue=function(e){return arguments.length?(T=e,t):T},t.maxValue=function(e){return arguments.length?(E=e,t):E},t.minAngle=function(e){return arguments.length?(P=e,t):P},t.maxAngle=function(e){return arguments.length?(z=e,t):z},t.labelInset=function(e){return arguments.length?(N=e,t):N},t}function o(){function t(r){return r.each(function(r){function b(){X.style("opacity",.9*A).style("display",A?"inline":"none"),J.style("opacity",A).style("display",A?"inline":"none"),K.text(1===A?t.strings().close:t.strings().open)}var L=e.select(this),T=[],E=0,P=0,z="",N="start"===s?!0:!1,H="rtl"===o?!0:!1,_=d*(N?1:.6),R=u+(N?c+f:0);if(!r||!r.length||!r.filter(function(t){return!t.values||t.values.length}).length)return t;var O=r.filter(function(t){return t.hasOwnProperty("seriesIndex")}).length;r.filter(function(t){return!t.hasOwnProperty("seriesIndex")}).map(function(t,e){t.seriesIndex=O,O+=1}),y=!0,z=r[0].type&&"bar"!==r[0].type?"line":"bar",i=H&&"center"!==i?"left"===i?"right":"left":i;var V=L.selectAll("g.sc-wrap").data([r]),W=V.enter().append("g").attr("class","sc-wrap sc-menu"),G=L.select("g.sc-wrap").merge(W);G.attr("transform","translate(0,0)");var j=W.append("defs"),Y=G.select("defs");j.append("clipPath").attr("id","sc-edge-clip-"+x).append("rect");var q=G.select("#sc-edge-clip-"+x+" rect");W.append("rect").attr("class","sc-menu-background");var X=G.select(".sc-menu-background"),Z=B.dropShadow("menu_back_"+x,Y,{blur:2});W.append("text").attr("class","sc-menu-link");var K=G.select(".sc-menu-link"),U=W.append("g").attr("class","sc-menu-mask"),$=G.select(".sc-menu-mask");U.append("g").attr("class","sc-group");var J=G.select(".sc-group"),Q=J.selectAll(".sc-series").data(B.identity,function(t){return t.seriesIndex});Q.exit().remove();var tt=Q.enter().append("g").attr("class","sc-series").on("mouseover",function(t,e){I.call("legendMouseover",this,t)}).on("mouseout",function(t,e){I.call("legendMouseout",this,t)}).on("click",function(t,n){e.event.preventDefault(),e.event.stopPropagation(),I.call("legendClick",this,t)}),et=J.selectAll(".sc-series").merge(tt);et.attr("class",M).attr("fill",k).attr("stroke",k);var nt=tt.append("rect").attr("x",(c+f)/-2).attr("y",(c+_)/-2).attr("width",c+f).attr("height",c+_).style("fill","#FFE").style("stroke-width",0).style("opacity",.1),rt=et.selectAll("rect").merge(nt),at=tt.selectAll("circle").data(function(t){return"line"===z?[t,t]:[t]});at.exit().remove();var it=at.enter().append("circle").attr("r",l).style("stroke-width","2px"),ot=et.selectAll("circle").merge(it),st=tt.selectAll("line").data("line"===z?function(t){return[t]}:[]);st.exit().remove();var lt=st.enter().append("line").attr("x0",0).attr("y0",0).attr("y1",0).style("stroke-width","4px"),ct=et.selectAll("line").merge(lt),ut=tt.append("text").attr("dx",0),dt=et.selectAll("text").merge(ut);dt.attr("dy",N?".36em":".71em").text(w),q.attr("x",.5).attr("y",.5).attr("width",0).attr("height",0),X.attr("x",.5).attr("y",.5).attr("width",0).attr("height",0).style("opacity",0).style("pointer-events","all").on("click",function(t,n){e.event.stopPropagation()}),K.text(1===A?t.strings().close:t.strings().open).attr("text-anchor","left"===i?H?"end":"start":H?"start":"end").attr("dy",".36em").attr("dx",0).style("opacity",0).on("click",function(t,n){e.event.preventDefault(),e.event.stopPropagation(),I.call("toggleMenu",this,t,n)}),et.classed("disabled",function(t){return t.disabled}),t.calcMaxWidth=function(){return T=[],J.style("display","inline"),dt.each(function(t,n){var r=e.select(this).node().getBoundingClientRect().width;T.push(Math.max(Math.floor(r),"line"===z?50:20))}),t.width(e.sum(T)+T.length*R-u),t.width()},t.getLineHeight=function(){J.style("display","inline");var t=Math.floor(dt.node().getBoundingClientRect().height);return t},t.arrange=function(r){function o(t){return T[t]+R}function y(t){return T[t]+R-u}function b(t){return t?1:-1}0===T.length&&this.calcMaxWidth();var w=T.length,k=1,M=w,I=[],L=[],B=r-n.left-n.right,O=a,V=0,W=this.getLineHeight(),G=c+(N?0:W)+_,j={top:7,right:7,bottom:7,left:7},Y=0,U=0,Q,tt,nt;if(h){for(;M>0;){for(I=[],Q=0;w>Q;Q+=1)o(Q)>(I[Q%M]||0)&&(I[Q%M]=o(Q));if(e.sum(I)-u<B)break;M-=1}for(M=M||1,k=Math.ceil(w/M),V=e.sum(I)-u,Q=0;w>Q;Q+=1)tt=Q%M,N?0===tt?Y=H?V:0:Y+=I[tt-1]*b(!H):0===tt?Y=(H?V:0)+(I[tt]-u)/2*b(!H):Y+=(I[tt-1]+I[tt])/2*b(!H),U=Math.floor(Q/M)*G,L[Q]={x:Y,y:U}}else if(H)for(Y=B,Q=0;w>Q;Q+=1)Y-y(Q)<0&&(V=Math.max(V,y(Q)),Y=B,Q&&(k+=1)),Y-y(Q)>V&&(V=Y-y(Q)),L[Q]={x:Y,y:(k-1)*(_+c)},Y-=o(Q);else for(Y=0,Q=0;w>Q;Q+=1)Q&&Y+y(Q)>B&&(Y=0,k+=1),Y+y(Q)>V&&(V=Y+y(Q)),L[Q]={x:Y,y:(k-1)*(_+c)},Y+=o(Q);if(!p&&(g||v>=k)){switch(A=0,m=!1,C=!1,t.width(n.left+V+n.right).height(n.top+k*G-_+n.bottom),i){case"left":nt=0;break;case"center":nt=(r-t.width())/2;break;case"right":nt=0}q.attr("y",0).attr("width",t.width()).attr("height",t.height()),X.attr("x",nt).attr("width",t.width()).attr("height",t.height()).attr("rx",0).attr("ry",0).attr("filter","none").style("display","inline").style("opacity",0),$.attr("clip-path","none").attr("transform",function(t,e){var r=nt+n.left+(N?l*b(!H):0),a=n.top+j.top;return"translate("+r+","+a+")"}),J.style("opacity",1).style("display","inline"),et.attr("transform",function(t){var e=L[t.seriesIndex];return"translate("+e.x+","+e.y+")"}),rt.attr("x",function(t){var e=0;return N?(e=(c+u)/2*b(H),e-=H?o(t.seriesIndex):0):e=o(t.seriesIndex)/-2,e}).attr("width",function(t){return o(t.seriesIndex)}).attr("height",G),ot.attr("r",function(t){return"dash"===t.type?0:l}).attr("transform",function(t,e){var n=N||"bar"===z?0:3*l*b(e);return"translate("+n+",0)"}),ct.attr("x1",function(t){return"dash"===t.type?8*l:4*l}).attr("transform",function(t){var e=l*("dash"===t.type?-4:-2);return"translate("+e+",0)"}).style("stroke-dasharray",function(t){return"dash"===t.type?"8, 8":"none"}).style("stroke-dashoffset",-4),
dt.attr("dy",N?".36em":".71em").attr("text-anchor",s).attr("transform",function(t){var e=N?(l+f)*b(!H):0,n=N?0:(c+_)/2;return"translate("+e+","+n+")"})}else m=!0,C=!0,t.width(j.left+e.max(T)+c+f+j.right).height(n.top+c+n.top),E=j.top+c*w+d*(w-1)+j.bottom,P=Math.min(O-t.height(),E),q.attr("x",.5-j.top-l).attr("y",.5-j.top-l).attr("width",t.width()).attr("height",P),X.attr("x",.5).attr("y",.5+t.height()).attr("width",t.width()).attr("height",P).attr("rx",2).attr("ry",2).attr("filter",Z).style("opacity",.9*A).style("display",A?"inline":"none"),K.attr("transform",function(e,r){var a="left"===i?.5:.5+t.width(),o=n.top+l;return"translate("+a+","+o+")"}).style("opacity",1),$.attr("clip-path","url(#sc-edge-clip-"+x+")").attr("transform",function(e,n){var r=j.left+l,a=t.height()+j.top+l;return"translate("+r+","+a+")"}),J.style("opacity",A).style("display",A?"inline":"none").attr("transform",function(t,n){var r=H?e.max(T)+l:0;return"translate("+r+",0)"}),et.attr("transform",function(t,e){var n=e*(c+d);return"translate(0,"+n+")"}),rt.attr("x",function(t){var e=(c+u)/2*b(H);return e-=H?o(t.seriesIndex):0}).attr("width",function(t){return o(t.seriesIndex)}).attr("height",c+_),ot.attr("r",function(t){return"dash"===t.type?0:"line"===t.type?l-2:l}).attr("transform",""),ct.attr("x1",16).attr("transform","translate(-8,0)").style("stroke-dasharray",function(t){return"dash"===t.type?"6, 4, 6":"none"}).style("stroke-dashoffset",0),dt.attr("text-anchor","start").attr("dy",".36em").attr("transform",function(t){var e=(l+f)*b(!H);return"translate("+e+",0)"});if(S){var at=P-E,it=function(t){if(t){var n=e.zoom().on("zoom",st);X.call(n),J.call(n)}else X.on(".zoom",null),J.on(".zoom",null)},st=function(){var t=e.event,n,r=0,a=0,i=0,o="";!t||"click"!==t.type&&"zoom"!==t.type||(n=t.sourceEvent,"zoom"===t.type&&n&&("wheel"===n.type?(r=-n.deltaX,a=-n.deltaY,i=F+(Math.abs(r)>Math.abs(a)?r:a)):"mousemove"===n.type?(r=n.movementX,a=n.movementY,i=F+(Math.abs(r)>Math.abs(a)?r:a)):"touchmove"===n.type&&(r=t.transform.x,a=t.transform.y,i=Math.abs(r)>Math.abs(a)?r:a)),F=Math.min(Math.max(i,at),0),o="translate("+(H?e.max(T)+l:0)+","+F+")",(i>0||at>i)&&D(Math.abs(a)>Math.abs(r)?a:0),J.attr("transform",o))};it(C)}},I.on("toggleMenu",function(t){e.event.stopPropagation(),A=1-A,b()}),I.on("closeMenu",function(t){1===A&&(A=0,b())})}),t}var n={top:10,right:10,bottom:15,left:10},r=0,a=0,i="right",o="ltr",s="start",l=6,c=2*l,u=10,d=12,f=5,h=!0,g=!1,p=!1,m=!1,v=3,y=!1,b={close:"Hide legend",type:"Show legend",noLabel:"undefined"},x=Math.floor(1e4*Math.random()),w=function(e){return e.key.length>0||!isNaN(parseFloat(e.key))&&B.isNumeric(e.key)?e.key:t.strings().noLabel},k=function(t){return B.defaultColor()(t,t.seriesIndex)},M=function(t){return"sc-series sc-series-"+t.seriesIndex},I=e.dispatch("legendClick","legendMouseover","legendMouseout","toggleMenu","closeMenu"),A=0,C=!1,S=!0,F=0,D=function(t){};return t.dispatch=I,t.margin=function(e){return arguments.length?(n.top="undefined"!=typeof e.top?e.top:n.top,n.right="undefined"!=typeof e.right?e.right:n.right,n.bottom="undefined"!=typeof e.bottom?e.bottom:n.bottom,n.left="undefined"!=typeof e.left?e.left:n.left,t):n},t.width=function(e){return arguments.length?(r=Math.round(e),t):r},t.height=function(e){return arguments.length?(a=Math.round(e),t):a},t.id=function(e){return arguments.length?(x=e,t):x},t.key=function(e){return arguments.length?(w=e,t):w},t.color=function(e){return arguments.length?(k=B.getColor(e),t):k},t.classes=function(e){return arguments.length?(M=e,t):M},t.align=function(e){return arguments.length?(i=e,t):i},t.position=function(e){return arguments.length?(s=e,t):s},t.showAll=function(e){return arguments.length?(g=e,t):g},t.showMenu=function(e){return arguments.length?(p=e,t):p},t.collapsed=function(t){return m},t.rowsCount=function(e){return arguments.length?(v=e,t):v},t.spacing=function(e){return arguments.length?(d=e,t):d},t.gutter=function(e){return arguments.length?(u=e,t):u},t.radius=function(e){return arguments.length?(l=e,t):l},t.strings=function(e){return arguments.length?(b=e,t):b},t.equalColumns=function(e){return arguments.length?(h=e,t):h},t.enabled=function(e){return arguments.length?(y=e,t):y},t.direction=function(e){return arguments.length?(o=e,t):o},t}function s(){function t(o){return o.each(function(o){var y=e.select(this),b=y.select(".sc-chart-wrap"),x=b.select(".sc-title-wrap"),w=b.select(".sc-controls-wrap"),k=b.select(".sc-legend-wrap"),M=a.margin(),I=0,A=0,C=0,S=0,F=0,D={width:0,height:0,top:0,left:0},L=0,T=0,E=0;if(d=d&&l&&l.length>0,x.select(".sc-title").remove(),d&&(x.append("text").attr("class","sc-title").attr("x","rtl"===m?n:0).attr("y",0).attr("dy",".75em").attr("text-anchor","start").attr("stroke","none").attr("fill","black").text(l),D=B.getTextBBox(x.select(".sc-title"),!0),D.top-=y.node().getBoundingClientRect().top,L=D.height),f&&(i.id("controls_"+a.id()).strings(v.controls).color(["#444"]).align(g).height(r-L),w.datum(c).call(i),C=i.calcMaxWidth()),h&&(s.id("legend_"+a.id()).strings(v.legend).align(p).height(r-L),k.datum(u).call(s),S=s.calcMaxWidth()),F=n/(C+S),C=Math.floor(C*F),S=Math.floor(S*F),f&&(i.arrange(C),S=n-i.width()),h&&(s.arrange(S),C=n-s.width()),f&&(I="rtl"===m?n-i.width():0,A=d?D.height-M.top+D.top:0-i.margin().top,w.attr("transform",B.translation(I,A)),T=i.height()-(d?0:i.margin().top)),h){var P=B.getTextBBox(k.select(".sc-menu-link")),z=n-D.width-6,N=d&&!f&&s.collapsed()&&z>P.width?!0:!1;I="rtl"===m||!s.collapsed()&&"center"===p?0:n-s.width(),N?(A=D.height-s.height()/2-P.height/2,A-=M.top-D.top):A=d?D.height-M.top+D.top:0-s.margin().top,k.attr("transform",B.translation(I,A)),E=N?s.margin().bottom:s.height()-(d?0:s.margin().top)}t.getHeight=function(){var t=L+Math.max(T,E,10);return t}}),t}var n=960,r=500,a=null,i=o(),s=o(),l="",c=[],u=[],d=!1,f=!1,h=!1,g="left",p="right",m="ltr",v={legend:{close:"Hide legend",open:"Show legend"},controls:{close:"Hide controls",open:"Show controls"},noData:"No Data Available.",noLabel:"undefined"};return t.controls=i,t.legend=s,t.chart=function(e){return arguments.length?(a=e,t):a},t.width=function(e){return arguments.length?(n=e,t):n},t.height=function(e){return arguments.length?(r=e,t):r},t.title=function(e){return arguments.length?(l=e,t):l},t.controlsData=function(e){return arguments.length?(c=e,t):c},t.legendData=function(e){return arguments.length?(u=e,t):u},t.showTitle=function(e){return arguments.length?(d=e,t):d},t.showControls=function(e){return arguments.length?(f=e,t):f},t.showLegend=function(e){return arguments.length?(h=e,t):h},t.alignControls=function(e){return arguments.length?(g=e,t):g},t.alignLegend=function(e){return arguments.length?(p=e,t):p},t.direction=function(e){return arguments.length?(m=e,s.direction(e),i.direction(e),t):m},t.strings=function(e){if(!arguments.length)return v;for(var n in e)e.hasOwnProperty(n)&&(v[n]=e[n]);return s.strings(v.legend),i.strings(v.controls),t},t}function l(){function t(C){return C.each(function(C){function E(){if(u.domain(b||e.extent(J.map(h).concat(m))),d.domain(x||e.extent(J.map(g).concat(v))),L&&C[0])if(-1===T){var t=Math.sqrt(k[1]/Math.PI);u.range([0+t,Z-t]),d.range([K-t,0+t])}else 1>T?(u.range([(Z*T+Z)/(2*C[0].values.length),Z-Z*(1+T)/(2*C[0].values.length)]),d.range([K,0])):(u.range([T,Z-T]),d.range([K-T,T]));else u.range([0,Z]),d.range([K,0]);V&&d.nice(),R=u.domain()[0]===u.domain()[1]||d.domain()[0]===d.domain()[1],u.domain()[0]===u.domain()[1]&&(u.domain()[0]?u.domain([u.domain()[0]-.1*u.domain()[0],u.domain()[1]+.1*u.domain()[1]]):u.domain([-1,1])),d.domain()[0]===d.domain()[1]&&(d.domain()[0]?d.domain([d.domain()[0]-.1*d.domain()[0],d.domain()[1]+.1*d.domain()[1]]):d.domain([-1,1])),f.domain(w||e.extent(J.map(function(t){return t.size}).concat(y))).range(k),f.domain().length<2&&f.domain([0,f.domain()]),W=W||u,G=G||d,j=j||f}function z(t,e,r,a){var i={pointIndex:r,point:e,seriesIndex:a.seriesIndex,series:a,groupIndex:e.group,id:n,e:t};return i}function X(){if(!F)return!1;if(H===!0){var t=e.merge(C.map(function(t,e){return t.values.map(function(t,n){var r=h(t,n),a=g(t,n),i=t.group;return[u(r)+1e-4*Math.random(),d(a)+1e-4*Math.random(),t,e,i,n]}).filter(function(t,e){return D(t[4],e)})}));if(_){var i=et.select("#sc-points-clip-"+n).selectAll("circle").data(t),o=i.enter().append("circle"),s=et.select("#sc-points-clip-"+n).selectAll("circle").merge(o);s.attr("cx",function(t){return t[0]}).attr("cy",function(t){return t[1]}).attr("r",function(t,e){return M(t[2],e)}),i.exit().remove(),it.attr("clip-path","url(#sc-points-clip-"+n+")")}t.length<=3&&(t.push([u.range()[0]-20,d.range()[0]-20,null,null,null,null]),t.push([u.range()[1]+20,d.range()[1]+20,null,null,null,null]),t.push([u.range()[0]-20,d.range()[0]+20,null,null,null,null]),t.push([u.range()[1]+20,d.range()[1]-20,null,null,null,null]));var l=e.voronoi().extent([[-10,-10],[r+10,a+10]]).polygons(t).map(function(e,n){return{data:e,seriesIndex:t[n][3],groupIndex:t[n][4],pointIndex:t[n][5]}}).filter(function(t){return null!==t.seriesIndex}),c=it.selectAll("path").data(l),f=c.enter().append("path").attr("class",function(t,e){return"sc-path-"+e}),p=it.selectAll("path").merge(f);p.attr("d",function(t){return t?"M"+t.data.join("L")+"Z":null}),c.exit().remove(),p.on("mouseover",function(t){var n=C[t.seriesIndex],r=t.pointIndex,a=n.values[r];if(q||!n)return 0;var i=z(e.event,a,r,n);O.call("elementMouseover",this,i)}).on("mousemove",function(t){var n=e.event;O.call("elementMousemove",this,n)}).on("mouseout",function(t){var n=C[t.seriesIndex],r=t.pointIndex,a=n.values[r];if(q||!n)return 0;var i=z(e.event,a,r,n);O.call("elementMouseout",this,i)}).on("click",function(t){var n=C[t.seriesIndex],r=t.pointIndex,a=n.values[r];if(q||!n)return 0;var i=z(e.event,a,r,n);O.call("elementClick",this,i)})}else lt.selectAll(".sc-point").style("pointer-events","auto").on("mouseover",function(t,n){var r=e.select(this.parentNode).datum(),a=r.values[n];if(q||!r)return 0;var i=z(e.event,a,n,r);O.call("elementMouseover",this,i)}).on("mousemove",function(t,n){var r=e.event;O.call("elementMousemove",this,r)}).on("mouseout",function(t,n){var r=e.select(this.parentNode).datum(),a=r.values[n];if(q||!r)return 0;var i=z(e.event,a,n,r);O.call("elementMouseout",this,i)}).on("click",function(t,n){var r=e.select(this.parentNode).datum(),a=r.values[n];if(q||!r)return 0;var i=z(e.event,a,n,r);O.call("elementClick",this,i)});q=!1}var Z=r-i.left-i.right,K=a-i.top-i.bottom,U=e.select(this),$=e.transition("scatter").duration(N).ease(e.easeLinear);q=!0;var J=b&&x&&w?[]:e.merge(C.map(function(t){return t.values.map(function(t,e){return{x:h(t,e),y:g(t,e),size:p(t,e)}})}));t.resetDimensions=function(t,e){r=t,a=e,Z=t-i.left-i.right,K=e-i.top-i.bottom,E()},E();var Q=U.selectAll("g.sc-wrap.sc-scatter").data([C]),tt=Q.enter().append("g").attr("class","sc-wrap sc-scatter"),et=U.select(".sc-wrap.sc-scatter").merge(tt),nt=tt.append("defs"),rt=et.select("defs");tt.append("g").attr("class","sc-group");var at=et.select(".sc-group");tt.append("g").attr("class","sc-point-paths");var it=et.select(".sc-point-paths");et.classed("sc-single-point",R).attr("transform",B.translation(i.left,i.top)),nt.append("clipPath").attr("id","sc-edge-clip-"+n).append("rect"),nt.append("clipPath").attr("id","sc-points-clip-"+n).attr("class","sc-point-clips"),rt.select("#sc-edge-clip-"+n+" rect").attr("width",Z).attr("height",K),et.attr("clip-path",P?"url(#sc-edge-clip-"+n+")":""),t.gradientFill=function(t,e){var r=n+"-"+e,a={x:.5,y:.5,r:.5,s:0,u:"objectBoundingBox"},i=o(t,e);return s(t,r,a,i,rt)};var ot=at.selectAll(".sc-series").data(B.identity,function(t){return t.seriesIndex}),st=ot.enter().append("g").attr("class","sc-series").style("stroke-opacity",1e-6).style("fill-opacity",1e-6),lt=at.selectAll(".sc-series").merge(st);lt.attr("class",function(t,e){return c(t,t.seriesIndex)}).attr("fill",function(t,e){return l(t,t.seriesIndex)}).attr("stroke",function(t,e){return l(t,t.seriesIndex)}).classed("hover",function(t){return t.hover}),lt.transition($).style("stroke-opacity",1).style("fill-opacity",1),ot.exit().transition($).style("stroke-opacity",1e-6).style("fill-opacity",1e-6).remove();var ct,ut,dt;S?(ct=lt.selectAll("circle.sc-point").data(function(t){return t.values}),ut=ct.enter().append("circle").attr("class",function(t,e){return"sc-point sc-enter sc-point-"+e}).attr("r",M),dt=lt.selectAll(".sc-point").merge(ut),dt.filter(function(t){return e.select(this).classed("sc-enter")}).attr("cx",function(t,e){return u(h(t,e))}).attr("cy",function(t,e){return d(0)}),dt.transition($).attr("cx",function(t,e){return u(h(t,e))}).attr("cy",function(t,e){return d(g(t,e))}).on("end",function(t){e.select(this).classed("sc-enter",!1).classed("sc-active",function(t){return"active"===t.active})}),ot.exit().transition($).selectAll(".sc-point").attr("cx",function(t,e){return u(h(t,e))}).attr("cy",function(t,e){return d(0)}).remove()):(ct=lt.selectAll("path.sc-point").data(function(t){return t.values}),ut=ct.enter().append("path").attr("class",function(t,e){return"sc-point sc-enter sc-point-"+e}).attr("d",e.symbol().type(A).size(I)),dt=lt.selectAll(".sc-point").merge(ut),dt.filter(function(t){return e.select(this).classed("sc-enter")}).attr("transform",function(t,e){return"translate("+W(h(t,e))+","+d(0)+")"}),dt.transition($).attr("transform",function(t,e){return"translate("+u(h(t,e))+","+d(g(t,e))+")"}).attr("d",e.symbol().type(A).size(I)).on("end",function(t){e.select(this).classed("sc-enter",!1).classed("active",function(t){return"active"===t.active})}),ot.exit().transition($).selectAll(".sc-point").attr("transform",function(t,e){return"translate("+u(h(t,e))+","+d(0)+")"}).remove()),clearTimeout(Y),Y=setTimeout(X,300),W=u.copy(),G=d.copy(),j=f.copy(),O.on("elementMouseover.point",function(t){F&&U.select(".sc-series-"+t.seriesIndex+" .sc-point-"+t.pointIndex).classed("hover",!0)}),O.on("elementMouseout.point",function(t){F&&U.select(".sc-series-"+t.seriesIndex+" .sc-point-"+t.pointIndex).classed("hover",!1)})}),t}var n=Math.floor(1e5*Math.random()),r=960,a=500,i={top:0,right:0,bottom:0,left:0},o=function(t,e){return B.defaultColor()(t,t.seriesIndex)},s=B.colorRadialGradient,l=o,c=function(t,e){return"sc-series sc-series-"+t.seriesIndex},u=e.scaleLinear(),d=e.scaleLinear(),f=e.scaleLinear(),h=function(t){return t.x},g=function(t){return t.y},p=function(t){return t.size||1},m=[],v=[],y=[],b=null,x=null,w=null,k=[1*Math.PI,25*Math.PI],M=function(t,e){return Math.sqrt(f(p(t,e))/Math.PI)},I=function(t,e){return f(p(t,e))},A=function(t){return t.shape||"circle"},C=B.buildLocality(),S=!0,F=!0,D=function(t){return!t.notActive},L=!1,T=.1,E="ltr",P=!1,z=0,N=0,H=!0,_=!0,R=!1,O=e.dispatch("elementClick","elementMouseover","elementMouseout","elementMousemove"),V=!1,W,G,j,Y,q=!1;return t.dispatch=O,t.id=function(e){return arguments.length?(n=e,t):n},t.color=function(e){return arguments.length?(o=e,t):o},t.fill=function(e){return arguments.length?(l=e,t):l},t.classes=function(e){return arguments.length?(c=e,t):c},t.gradient=function(e){return arguments.length?(s=e,t):s},t.x=function(e){return arguments.length?(h=B.functor(e),t):h},t.y=function(e){return arguments.length?(g=B.functor(e),t):g},t.z=function(e){return arguments.length?(p=B.functor(e),t):p},t.xScale=function(e){return arguments.length?(u=e,t):u},t.yScale=function(e){return arguments.length?(d=e,t):d},t.zScale=function(e){return arguments.length?(f=e,t):f},t.xDomain=function(e){return arguments.length?(b=e,t):b},t.yDomain=function(e){return arguments.length?(x=e,t):x},t.zDomain=function(e){return arguments.length?(w=e,t):w},t.forceX=function(e){return arguments.length?(m=e,t):m},t.forceY=function(e){return arguments.length?(v=e,t):v},t.forceZ=function(e){return arguments.length?(y=e,t):y},t.size=function(e){return arguments.length?(p=B.functor(e),t):p},t.sizeRange=function(e){return arguments.length?(k=e,t):k},t.sizeDomain=function(e){return arguments.length?(w=e,t):w},t.forceSize=function(e){return arguments.length?(y=e,t):y},t.margin=function(e){if(!arguments.length)return i;for(var n in e)e.hasOwnProperty(n)&&(i[n]=e[n]);return t},t.width=function(e){return arguments.length?(r=e,t):r},t.height=function(e){return arguments.length?(a=e,t):a},t.interactive=function(e){return arguments.length?(F=e,t):F},t.pointActive=function(e){return arguments.length?(D=e,t):D},t.padData=function(e){return arguments.length?(L=e,t):L},t.padDataOuter=function(e){return arguments.length?(T=e,t):T},t.clipEdge=function(e){return arguments.length?(P=e,t):P},t.clipVoronoi=function(e){return arguments.length?(_=e,t):_},t.useVoronoi=function(e){return arguments.length?(H=e,H===!1&&(_=!1),t):H},t.circleRadius=function(e){return arguments.length?(M=e,t):M},t.clipRadius=function(e){return arguments.length?(M=e,t):M},t.shape=function(e){return arguments.length?(A=e,t):A},t.onlyCircles=function(e){return arguments.length?(S=e,t):S},t.singlePoint=function(e){return arguments.length?(R=e,t):R},t.delay=function(e){return arguments.length?(z=e,t):z},t.duration=function(e){return arguments.length?(N=e,t):N},t.direction=function(e){return arguments.length?(E=e,t):E},t.nice=function(e){return arguments.length?(V=e,t):V},t.locality=function(e){return arguments.length?(C=B.buildLocality(e),t):C},t}function c(){function t(l){return l.each(function(l){function p(t){if(!t.values||!t.values.length)return[null];if(t.values.length>1)return[t.values];var e=c.domain().map(function(e,n){if(Array.isArray(t.values[0]))return[e,t.values[0][1]];var r=JSON.parse(JSON.stringify(t.values[0]));return r.x=e,r});return[e]}var b=e.select(this),w=a-r.left-r.right,k=i-r.top-r.bottom,M="linear"===h?e.curveLinear:"cardinal"===h?e.curveCardinal:"monotone"===h?e.curveMonotoneX:"basis"===h?e.curveBasis:e.curveNatural,I=e.area().curve(M).defined(d).x(function(t,e){return c(o(t,e))}).y0(function(t,e){return u(s(t,e))}).y1(function(t,e){return u(u.domain()[0]<=0?u.domain()[1]>=0?0:u.domain()[1]:u.domain()[0])}),A=e.area().curve(M).defined(d).x(function(t,e){return c(o(t,e))}).y0(function(t,e){return u(0)}).y1(function(t,e){return u(u.domain()[0]<=0?u.domain()[1]>=0?0:u.domain()[1]:u.domain()[0])}),C=e.transition("points").duration(m).ease(e.easeLinear),S=n.id();y=function(t,e,r){return B.colorLinearGradient(t,n.id()+"-"+e,r,v(t,e),L.select("defs"))},c=n.xScale(),u=n.yScale(),t.resetDimensions=function(t,e){a=t,i=e,w=t-r.left-r.right,k=e-r.top-r.bottom,n.resetDimensions(t,e)};var F=b.selectAll("g.sc-wrap.sc-line").data([l]),D=F.enter().append("g").attr("class","sc-wrap sc-line"),L=b.select(".sc-wrap.sc-line").merge(D),T=D.append("defs");D.append("g").attr("class","sc-group");var E=L.select(".sc-group");D.append("g").attr("class","sc-scatter-wrap");var P=L.select(".sc-scatter-wrap");L.attr("transform",B.translation(r.left,r.top)),T.append("clipPath").attr("id","sc-edge-clip-"+S).append("rect"),L.select("#sc-edge-clip-"+S+" rect").attr("width",w).attr("height",k),L.attr("clip-path",g?"url(#sc-edge-clip-"+S+")":""),P.attr("clip-path",g?"url(#sc-edge-clip-"+S+")":"");var z=E.selectAll("g.sc-series").data(l,function(t){return t.seriesIndex}),N=z.enter().append("g").attr("class","sc-series").style("stroke-opacity",1e-6).style("fill-opacity",1e-6),H=E.selectAll(".sc-series").merge(N);H.classed("hover",function(t){return t.hover}).attr("class",x).attr("fill",v).attr("stroke",v),H.transition(C).style("stroke-opacity",1).style("fill-opacity",.5),z.exit().transition(C).style("stroke-opacity",1e-6).style("fill-opacity",1e-6).remove(),n.clipEdge(g).width(w).height(k),P.call(n);var _=H.selectAll("path.sc-area").data(function(t){return f(t)?[t]:[]}),R=_.enter().append("path").attr("class","sc-area sc-enter"),O=H.selectAll(".sc-area").merge(R);O.filter(function(t){return e.select(this).classed("sc-enter")}).attr("d",function(t){return A.apply(this,[t.values])}),O.transition(C).attr("d",function(t){return I.apply(this,[t.values])}).on("end",function(t){e.select(this).classed("sc-enter",!1)}),_.exit().remove(),z.exit().transition(C).selectAll(".sc-area").attr("d",function(t){return A.apply(this,[t.values])}).remove();var V=H.selectAll("path.sc-line").data(p,function(t){return t.seriesIndex}),W=V.enter().append("path").attr("class","sc-line sc-enter"),G=H.selectAll(".sc-line").merge(W);G.filter(function(t){return e.select(this).classed("sc-enter")}).attr("d",e.line().curve(M).defined(d).x(function(t,e){return c(o(t,e))}).y(function(t,e){return u(0)})),G.transition(C).attr("d",e.line().curve(M).defined(d).x(function(t,e){return c(o(t,e))}).y(function(t,e){return u(s(t,e))})).on("end",function(t){e.select(this).classed("sc-enter",!1)}),z.exit().transition(C).selectAll(".sc-line").attr("d",e.line().curve(M).defined(d).x(function(t,e){return c(o(t,e))}).y(function(t,e){return u(0)})).remove()}),t}var n=l(),r={top:0,right:0,bottom:0,left:0},a=960,i=500,o=function(t){return t.x},s=function(t){return t.y},c,u,d=function(t,e){return!isNaN(s(t,e))&&null!==s(t,e)},f=function(t){return t&&t.area||!1},h="linear",g=!1,p=0,m=0,v=function(t,e){return B.defaultColor()(t,t.seriesIndex)},y=null,b=v,x=function(t,e){return"sc-series sc-series-"+t.seriesIndex};return t.dispatch=n.dispatch,t.scatter=n,B.rebind(t,n,"id","interactive","size","xScale","yScale","zScale","xDomain","yDomain","sizeDomain","sizeRange","forceX","forceY","forceSize","useVoronoi","clipVoronoi","clipRadius","padData","padDataOuter","singlePoint","direction","nice","locality"),t.color=function(e){return arguments.length?(v=e,n.color(v),t):v},t.fill=function(e){return arguments.length?(b=e,n.fill(b),t):b},t.classes=function(e){return arguments.length?(x=e,n.classes(x),t):x},t.gradient=function(e){return arguments.length?(y=e,t):y},t.margin=function(e){if(!arguments.length)return r;for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);return t},t.width=function(e){return arguments.length?(a=e,t):a},t.height=function(e){return arguments.length?(i=e,t):i},t.x=function(e){return arguments.length?(o=e,n.x(e),t):o},t.y=function(e){return arguments.length?(s=e,n.y(e),t):s},t.delay=function(e){return arguments.length?(p=e,t):p},t.duration=function(e){return arguments.length?(m=e,n.duration(e),t):m},t.clipEdge=function(e){return arguments.length?(g=e,t):g},t.interpolate=function(e){return arguments.length?(h=e,t):h},t.defined=function(e){return arguments.length?(d=e,t):d},t.isArea=function(e){return arguments.length?(f=B.functor(e),t):f},t}function u(){function t(u){return u.each(function(u){function g(t,e){return Math.max(Math.round(Math.abs(o(c(t,e))-o(0))),0)}function k(){return i.bandwidth()/(h?1:u.length)}function M(t){return t?1:-1}function I(t){return t.reverse().filter(function(t,e,n){return-1===n.indexOf(t,e+1)}).reverse()}function A(){var t=t||I(et.map(l).concat(d)),n=y?R:O,r=y?O:R,a=h?b:b*q+b,s=b*(h?.25:1),c=Math.max(.25,(n-X*a-s)/(2*a));i.domain(t).range([0,n]).paddingInner(v?.3:.25).paddingOuter(c);var u=u||e.extent(et.map(function(t){var e=y?0:t.y,n=y?t.y:0;return h?t.y>0?t.y0+e:t.y0+n:t.y}).concat(f)),g=y?[O,0]:[0,R];if(o.domain(u).range(g),p&&(y&&h&&e.max(J)+8>k()&&(U=!0),G=y&&!U?"labelHeight":"labelWidth"),"top"===$||"total"===$){var m=r,x=0,w=0,M=0;s=y?U?2:-2:2,tt.forEach(function(t,e){var n="total"===$&&h&&y&&!U?Q:J[e];y&&t>0||!y&&0>t?o(t)-n<x&&(x=o(t)-n,M=n):o(t)+n>m&&(m=o(t)+n,w=n)}),y?o.range([r-(o.domain()[0]<0?w+s+2:0),o.domain()[1]>0?M+s:0]):o.range([o.domain()[0]<0?M+s+4:0,r-(o.domain()[1]>0?w+s:0)])}C&&o.nice(),z=z||i,N=N||o}function T(t,e,n){return{pointIndex:n,point:e,seriesIndex:e.seriesIndex,series:u[e.seri],groupIndex:e.groupIndex,id:s,e:t}}function H(t,e,n,r){var a=0,i=c(t,e)<0?-1:1,o=n===0>i?1:0,s=t.barLength-t[G];if(n?y:!y)a=(t.barThickness-(U===n?t.labelHeight:t.labelWidth))/2;else switch($){case"start":a=s*(0+o)+r*i;break;case"middle":a=s/2;break;case"end":a=s*(1-o)-r*i;break;case"top":a=t.barLength*(1-o)-t.labelWidth*(0+o);break;case"total":a=t.barLength*(1-o)-(U===n?t.labelHeight:t.labelWidth)*(0+o)}return a}var _=e.select(this),R=r-n.left-n.right,O=a-n.top-n.bottom,V=y?"width":"height",W=y?"height":"width",G=y?"width":"height",j=y?"x":"y",Y=y?"y":"x",q=0,X=0,Z=0,K=u.length-1,U=!1,$=p,J=[],Q=0,tt=[],et=[];if(h?("top"===$||$===!0)&&($="end"):$&&("total"===$?$="top":$===!0&&($="end"),U=y),h){var nt=[];u[0].values.map(function(t,e){var n=0,r=0;u.map(function(t){var a=t.values[e];a.size=Math.abs(a.y),a.y<0?(a.y0=r-(y?0:a.size),r-=a.size):(a.y0=n+(y?a.size:0),n+=a.size)}),nt[e]={neg:r,pos:n}})}if(et=e.merge(u.map(function(t){return t.values.map(function(t,e){return{x:l(t,e),y:c(t,e),y0:t.y0}})})),q=u.length,X=u[0].values.length,p){tt="total"===$&&h?nt.map(function(t){return t.neg}).concat(nt.map(function(t){return t.pos})):et.map(c);var rt=e.extent(u.map(function(t,e){return t.seriesIndex}));Z=rt[0],K=rt[1],J=B.stringSetLengths(tt,_,m,"sc-label-value"),Q=B.stringSetThickness(["Xy"],_,m,"sc-label-value")[0]}t.resetDimensions=function(t,e){r=t,a=e,R=t-n.left-n.right,O=e-n.top-n.bottom,A()},A();var at=_.selectAll("g.sc-wrap.sc-multibar").data([u]),it=at.enter().append("g").attr("class","sc-wrap sc-multibar"),ot=_.select(".sc-wrap.sc-multibar").merge(it),st=it.append("defs"),lt=ot.select("defs");if(ot.attr("transform",B.translation(n.left,n.top)),w&&(st.append("clipPath").attr("id","sc-edge-clip-"+s).append("rect"),lt.select("#sc-edge-clip-"+s+" rect").attr("width",R).attr("height",O)),ot.attr("clip-path",w?"url(#sc-edge-clip-"+s+")":""),L)var ct=B.createTexture(st,s);t.gradientFill=function(t,e,n){var r=s+"-"+e,a=S(t,e);return F(t,r,n,a,lt)};var ut=ot.selectAll(".sc-series").data(B.identity),dt=ut.enter().append("g").attr("class",E).style("stroke-opacity",1e-6).style("fill-opacity",1e-6);ut.exit().remove();var ft=ot.selectAll(".sc-series").merge(dt);ft.attr("fill",D).attr("class",E).classed("hover",function(t){return t.hover}).classed("sc-active",function(t){return"active"===t.active}).classed("sc-inactive",function(t){return"inactive"===t.active}).style("stroke-opacity",1).style("fill-opacity",1),ft.on("mouseover",function(t,n,r){e.select(this).classed("hover",!0)}).on("mouseout",function(t,n,r){e.select(this).classed("hover",!1)});var ht=ft.selectAll(".sc-bar").data(function(t){return t.values}),gt=ht.enter().append("g").attr("class","sc-bar");ht.exit().remove();var pt=ft.selectAll(".sc-bar").merge(gt);gt.append("rect").attr("class","sc-base").style("fill","inherit").attr("x",0).attr("y",0),L&&gt.append("rect").attr("class","sc-texture").attr("x",0).attr("y",0).style("mask","url("+ct+")"),gt.append("rect").attr("class","sc-label-box").attr("x",0).attr("y",0).attr("width",0).attr("height",0).attr("rx",2).attr("ry",2).style("fill","transparent").style("stroke-width",0).style("fill-opacity",0);var mt=gt.append("text").attr("class","sc-label-value"),vt=pt.select(".sc-label-value").merge(mt);pt.attr("class",function(t,e){return"sc-bar "+(c(t,e)<0?"negative":"positive")}).classed("sc-active",function(t){return"active"===t.active}).attr("transform",function(t,e){var n;return n=h?{x:Math.round(i(l(t,e))),y:Math.round(o(t.y0))}:{x:Math.round(t.seri*k()+i(l(t,e))),y:Math.round(o(c(t,e)<0?y?0:c(t,e):y?c(t,e):0))},"translate("+n[j]+","+n[Y]+")"}).style("display",function(t,e){return 0!==g(t,e)?"inline":"none"}),pt.select("rect.sc-base").attr(j,0).attr(W,g).attr(V,k),L&&pt.select("rect.sc-texture").attr(j,0).attr(W,g).attr(V,k).style("fill",function(t,e){var n=D(t),r=B.getTextContrast(n,e);return r}),pt.on("mouseover",function(t,n){var r=T(e.event,t,n);P.call("elementMouseover",this,r)}).on("mousemove",function(t,n){var r=e.event;P.call("elementMousemove",this,r)}).on("mouseout",function(t,n){var r=T(e.event,t,n);P.call("elementMouseout",this,r)}).on("click",function(t,n){e.event.stopPropagation();var r=T(e.event,t,n);P.call("elementClick",this,r)}).on("dblclick",function(t,n){e.event.stopPropagation();var r=T(e.event,t,n);P.call("elementDblClick",this,r)}),p?(vt.text(function(t,e){var n="total"===$&&h?c(t,e)<0?nt[e].neg:nt[e].pos:c(t,e);return m(n)}).each(function(t,e){var n=this.getBoundingClientRect();t.labelWidth=Math.floor(n.width)+4,t.labelHeight=Math.floor(n.height),t.barLength=g(t,e),t.barThickness=k()}),vt.attr("dy","0.35em").attr("text-anchor",function(t,e){var n="middle",r=c(t,e)<0;if(y&&!U)n="middle";else{switch($){case"start":n=r?"end":"start";break;case"middle":n="middle";break;case"end":n=r?"start":"end";break;case"top":case"total":n=r?"end":"start"}n="rtl"===x&&"middle"!==n?"start"===n?"end":"start":n}return n}).attr("transform","rotate("+(U?-90:0)+" 0,0)").attr("x",function(t,e){var n=0,r=c(t,e)<0?-1:1,a=0>r,i=(4+2*(U||!y))*r;if(y&&!U)n=t.barThickness/2;else switch($){case"start":n=t.barLength*(a-U)+i;break;case"middle":n=t.barLength*(U?-1:1)/2;break;case"end":n=t.barLength*(!U-a)-i;break;case"top":case"total":n=t.barLength*(!U-a)+2*r}return n}).attr("y",function(t,e){var n=0,r=c(t,e)<0?-1:1,a=0>r,i=(t.labelHeight/2+(4+2*U)*("total"===$?0:1))*r;if(y&&!U)switch($){case"start":n=t.barLength*(1-a)-i;break;case"middle":n=t.barLength/2;break;case"end":n=t.barLength*(0+a)+i;break;case"total":n=t.barLength*(0+a)+-1*i}else n=t.barThickness/2;return n}).style("fill",function(t,e,n){if("top"===$||"total"===$)return"#000";var r=D(t),a=B.getTextContrast(r,e);return a}).style("fill-opacity",function(t,e){if("total"===$){if(t.seriesIndex!==Z&&t.seriesIndex!==K)return 0;var n=c(t,e);return 0>n&&nt[e].neg===t.y0+(y?n:0)||n>=0&&nt[e].pos===t.y0+(y?0:n)?1:0}var r=t.barLength<(!y||U?t.labelWidth:t.labelHeight)+8,a=t.barThickness<(!y||U?t.labelHeight:t.labelWidth)+4;return"top"!==$&&(r||a)?0:1}),"total"===$&&h&&pt.select("rect.sc-label-box").style("fill-opacity",0),pt.filter(function(t,e){return"total"===$&&h?t.seriesIndex===Z||t.seriesIndex===K:!0}).select("rect.sc-label-box").attr("x",function(t,e){return H(t,e,!0,4)}).attr("y",function(t,e){return H(t,e,!1,-4)}).attr("width",function(t,e){return U?t.labelHeight:t.labelWidth}).attr("height",function(t,e){return U?t.labelWidth:t.labelHeight}).style("fill",function(t,e){return"top"===$||"total"===$?"#fff":D(t,e)}).style("fill-opacity",function(t,e){var n=t.barLength<(!y||U?t.labelWidth:t.labelHeight)+8,r=t.barThickness<(!y||U?t.labelHeight:t.labelWidth)+4;return"top"!==$&&(n||r)?0:1})):(vt.text("").style("fill-opacity",0),pt.select("rect.label-box").style("fill-opacity",0)),z=i.copy(),N=o.copy()}),t}var n={top:0,right:0,bottom:0,left:0},r=960,a=500,i=e.scaleBand(),o=e.scaleLinear(),s=Math.floor(1e4*Math.random()),l=function(t){return t.x},c=function(t){return t.y},u=B.buildLocality(),d=[],f=[0],h=!0,g,p=!1,m=function(t){return t},v=!1,y=!0,b=60,x="ltr",w=!1,k=0,M=0,I=null,A=null,C=!1,S=function(t,e){return B.defaultColor()(t,t.seriesIndex)},F=B.colorLinearGradient,D=S,L=!1,T=null,E=function(t,e){return"sc-series sc-series-"+t.seriesIndex},P=e.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove"),z,N;return t.dispatch=P,t.color=function(e){return arguments.length?(S=e,t):S},t.fill=function(e){return arguments.length?(D=e,t):D},t.classes=function(e){return arguments.length?(E=e,t):E},t.gradient=function(e){return arguments.length?(F=e,t):F},t.x=function(e){return arguments.length?(l=e,t):l},t.y=function(e){return arguments.length?(c=e,t):c},t.margin=function(e){if(!arguments.length)return n;for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);return t},t.width=function(e){return arguments.length?(r=e,t):r},t.height=function(e){return arguments.length?(a=e,t):a},t.xScale=function(e){return arguments.length?(i=e,t):i},t.yScale=function(e){return arguments.length?(o=e,t):o},t.xDomain=function(e){return arguments.length?(I=e,t):I},t.yDomain=function(e){return arguments.length?(A=e,t):A},t.forceX=function(e){return arguments.length?(d=e,t):d},t.forceY=function(e){return arguments.length?(f=e,t):f},t.stacked=function(e){return arguments.length?(h=e,t):h},t.barColor=function(e){return arguments.length?(T=B.getColor(e),t):T},t.disabled=function(e){return arguments.length?(g=e,t):g},t.id=function(e){return arguments.length?(s=e,t):s},t.delay=function(e){return arguments.length?(k=e,
t):k},t.duration=function(e){return arguments.length?(M=e,t):M},t.clipEdge=function(e){return arguments.length?(w=e,t):w},t.showValues=function(e){return arguments.length?(p=isNaN(parseInt(e,10))?e:parseInt(e,10)&&!0||!1,t):p},t.valueFormat=function(e){return arguments.length?(m=e,t):m},t.withLine=function(e){return arguments.length?(v=e,t):v},t.vertical=function(e){return arguments.length?(y=e,t):y},t.baseDimension=function(e){return arguments.length?(b=e,t):b},t.direction=function(e){return arguments.length?(x=e,t):x},t.textureFill=function(e){return arguments.length?(L=e,t):L},t.nice=function(e){return arguments.length?(C=e,t):C},t.locality=function(e){return arguments.length?(u=B.buildLocality(e),t):u},t}function d(){function t(o){return o.each(function(o){function u(t,e,n){return{id:i,key:c(e),value:s(e),count:l(e),data:e,series:e.series,seriesIndex:e.series.seriesIndex,e:t}}function d(t,n,r){function a(t){return(t+f)%s}var i=[],o=[],s=2*Math.PI,l=0,c=Math.PI/2,u=Math.PI,d=3*Math.PI/2,f=0;t.each(function(t,e){var h=0===R(t)?0:(R(t)+s)%s,g=0===O(t)?0:(O(t)+s)%s,p=Math.round(1e4*Math.sin(h))/1e4,m=Math.round(1e4*Math.sin(g))/1e4,v=Math.round(1e4*Math.cos(h))/1e4,y=Math.round(1e4*Math.cos(g))/1e4;f=h>g?s-h:0,g===h?(h=0,g=s):(h=a(h),g=a(g)),l=a(l),c=a(c),u=a(u),d=a(d),(h%s===0||g%s===0)&&(o.push(r),C&&o.push(r*P)),c>=h&&g>=c&&(i.push(n),C&&i.push(n*P)),u>=h&&g>=u&&(o.push(-r),C&&o.push(-r*P)),d>=h&&g>=d&&(i.push(-n),C&&i.push(-n*P)),i.push(n*p),i.push(n*m),C?(i.push(n*P*p),i.push(n*P*m)):i.push(0),o.push(r*v),o.push(r*y),C?(o.push(r*P*v),o.push(r*P*y)):o.push(0)}),dt=e.extent(i),ft=e.extent(o),ct*=j/(e.max(dt)-e.min(dt)),ut*=Y/(e.max(ft)-e.min(ft))}function f(){var t=[ct],n=[ut+D];it.select(".sc-base").each(function(e,r){if(p(e)){var a=(R(e)+O(e))/2,i=Math.sin(a),o=Math.cos(a),s=ct-pt-X[r],l=ut-gt,c=i?s/i:s,u=o?l/o:l;t.push(c),n.push(u)}});var r=e.min(t.concat(n).concat([]),function(t){return Math.abs(t)});return r}function g(){var t=.3*et.node().getBoundingClientRect().height,n=Math.abs(ut*e.min(ft)),r=Math.round(t-n);return r}function p(t){var e=(O(t)-R(t))/(2*Math.PI);return e>A?1:0}function T(t,e){var n=2*Math.PI,r=((R(t)+O(t))/2+n)%n;return r>0&&r<Math.PI?1:-1}function E(t){C||(t.innerRadius=0);var n=e.interpolate(this._current,t);return this._current=n(0),function(t){var e=n(t);return At(e)}}function G(t){t.innerRadius=0;var n=e.interpolate({startAngle:0,endAngle:0},t);return function(t){return At(n(t))}}var j=r-n.left-n.right,Y=a-n.top-n.bottom,q=e.select(this),X=[],Z=w&&M?!0:!1;Z&&(X=B.stringSetLengths(o,q,c,"sc-label"));var K=q.selectAll("g.sc-wrap").data([o]),U=K.enter().append("g").attr("class","sc-wrap sc-pie"),$=q.select(".sc-wrap.sc-pie").merge(U),J=U.append("defs"),Q=$.select("defs");U.append("g").attr("class","sc-group");var tt=$.select(".sc-group");U.append("g").attr("class","sc-hole-wrap");var et=$.select(".sc-hole-wrap");if($.attr("transform",B.translation(n.left,n.top)),b)var nt=B.createTexture(J,i,-j/2,-Y/2);t.gradientFill=function(t,e){var n=i+"-"+e,r={x:0,y:0,r:xt,s:C?100*P+"%":"0%",u:"userSpaceOnUse"},a=m(t,e);return v(t,n,r,a,Q)};var rt=tt.selectAll(".sc-series").data(W),at=rt.enter().append("g").attr("class","sc-series");rt.exit().remove();var it=tt.selectAll(".sc-series").merge(at);at.style("stroke","#FFF").style("stroke-width",2).style("stroke-opacity",0).on("mouseover",function(t,n,r){e.select(this).classed("hover",!0)}).on("mouseout",function(t,n,r){e.select(this).classed("hover",!1)}),it.attr("class",function(t){return x(t.data,t.data.seriesIndex)}).attr("fill",function(t){return y(t.data,t.data.seriesIndex)}).classed("sc-active",function(t){return"active"===t.data.active}).classed("sc-inactive",function(t){return"inactive"===t.data.active});var ot=it.selectAll("g.sc-slice").data(function(t,e){return t.data.values.map(function(n,r){return n.endAngle=t.endAngle,n.padAngle=t.padAngle,n.startAngle=t.startAngle,n.index=e,n})},function(t){return t.seriesIndex});ot.exit().remove();var st=ot.enter().append("g").attr("class","sc-slice"),lt=it.selectAll("g.sc-slice").merge(st);st.append("path").attr("class","sc-base").each(function(t,e){this._current=t}),b&&st.append("path").attr("class","sc-texture").each(function(t,e){this._current=t}).style("mask","url("+nt+")"),st.on("mouseover",function(t,n){e.select(this).classed("hover",!0);var r=u(e.event,t,n);H.call("elementMouseover",this,r)}).on("mousemove",function(t,n){var r=e.event;H.call("elementMousemove",this,r)}).on("mouseout",function(t,n){e.select(this).classed("hover",!1),H.call("elementMouseout",this)}).on("click",function(t,n){e.event.stopPropagation();var r=u(e.event,t,n);H.call("elementClick",this,r)}).on("dblclick",function(t,n){e.event.stopPropagation();var r=u(e.event,t,n);H.call("elementDblClick",this,r)}),st.append("g").attr("class","sc-label").attr("transform","translate(0,0)"),st.select(".sc-label").append("rect").style("fill-opacity",0).style("stroke-opacity",0),st.select(".sc-label").append("text").style("fill-opacity",0),st.append("polyline").attr("class","sc-label-leader").style("stroke-opacity",0);var ct=j/2,ut=Y/2,dt=[],ft=[],ht=0,gt=Z?5:0,pt=D+L,mt=0;lt.select(".sc-base").call(d,ct,ut),et.call(_,S?[S]:[]),S&&(mt=g(),mt>0&&(gt+=mt,ht-=mt/2));var vt=j/2,yt=Y/2;Z&&(D=Math.max(Math.min(Math.min(f())/12,20),10)),V(t)&&(z=V(t),N=V(t));var bt=Math.min(Math.max(f(),z),N),xt=bt-(Z?D:0),wt=(e.max(ft)-e.min(ft))/2+e.min(ft),kt=(bt+ht)/yt;yt+=wt*kt+ht/2;var Mt=(e.max(dt)-e.min(dt))/2-e.max(dt),It=bt/vt;vt+=Mt*It,tt.attr("transform","translate("+vt+","+yt+")"),et.attr("transform","translate("+vt+","+yt+")"),tt.select(nt).attr("x",-xt/2).attr("y",-xt/2);var At=e.arc().innerRadius(C?xt*P:0).outerRadius(xt).startAngle(R).endAngle(O),Ct=e.arc().innerRadius(0).outerRadius(xt).startAngle(R).endAngle(O);M&&(!C||I?Ct.innerRadius(bt).outerRadius(bt):Ct.outerRadius(xt*P)),lt.select(".sc-base").attr("d",At).style("stroke-opacity",function(t){return R(t)===O(t)?0:1}),b&&lt.select(".sc-texture").attr("d",At).style("stroke-opacity",function(t){return R(t)===O(t)?0:1}).style("fill",function(t,n){var r=e.select(this.parentNode).style("fill");return B.getTextContrast(r,n)}),w?(lt.select(".sc-label").attr("transform",function(t){if(F){t.outerRadius=xt+10,t.innerRadius=xt+15;var e=(R(t)+O(t))/2*(180/Math.PI);return e+=90*T(t,Ct),"translate("+Ct.centroid(t)+") rotate("+e+")"}var n=Ct.centroid(t),r=k?(D+L)*T(t,Ct):0;return"translate("+[n[0]+r,n[1]]+")"}),lt.select(".sc-label text").text(c).attr("dy",".35em").style("fill","#555").style("fill-opacity",p).style("text-anchor",function(t){if(!M)return"middle";var e=1===T(t,Ct)?"start":"end";return"rtl"===h&&(e="start"===e?"end":"start"),e}),lt.each(function(t,n){var r,a,i,o,s,l;(X[n]>z||bt===z)&&(r=(R(t)+O(t))/2,a=Math.abs(Math.sin(r)),i=X[t.index],o=bt*a+D+L+i,s=j/2-vt+j/2-o,0>s&&(l=B.stringEllipsify(c(t),q,i+s),e.select(this).select("text").text(l)))}),M?k&&lt.select(".sc-label-leader").attr("points",function(t){if(!p(t))return"0,0 0,0";var n=e.arc().innerRadius(xt).outerRadius(xt).startAngle(R).endAngle(O),r=k?D*T(t,n):0,a=n.centroid(t),i=Ct.centroid(t),o=[i[0]+r,i[1]];return a+" "+i+" "+o}).style("stroke","#AAA").style("fill","none").style("stroke-opacity",p):lt.select(".sc-label").each(function(t){if(p(t)){var n=e.select(this),r=n.select("text").node().getBoundingClientRect();n.select("rect").attr("rx",3).attr("ry",3).attr("width",r.width+10).attr("height",r.height+10).attr("transform",function(){return"translate("+[r.x-5,r.y-5]+")"}).style("fill","#FFF").style("fill-opacity",p)}})):(lt.select(".sc-label-leader").style("stroke-opacity",0),lt.select(".sc-label rect").style("fill-opacity",0),lt.select(".sc-label text").style("fill-opacity",0))}),t}var n={top:0,right:0,bottom:0,left:0},r=500,a=500,i=Math.floor(1e4*Math.random()),o=function(t){return(t.series||t).key},s=function(t,e){return(t.series||t).value},l=function(t,e){return(t.series||t).count},c=function(t){return o(t)},u=function(t){return s(t)},d=function(t){return isNaN(l(t))?"":" ("+l(t)+")"},f=B.buildLocality(),h="ltr",g=0,p=0,m=function(t,e){return B.defaultColor()(t.series,t.seriesIndex)},v=B.colorRadialGradient,y=m,b=!1,x=function(t,e){return"sc-series sc-series-"+t.seriesIndex},w=!0,k=!0,M=!0,I=!0,A=.01,C=!1,S=!1,F=!1,D=20,L=5,T=360,E=0,P=.447,z=75,N=250,H=e.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove"),_=function(t,e){var n=t.selectAll(".sc-hole-container").data(e),r=n.enter().append("g").attr("class","sc-hole-container");r.append("text").text(e).attr("class","sc-pie-hole-value").attr("dy",".35em").attr("text-anchor","middle").style("font-size","50px"),n.exit().remove()},R=function(t){return t.startAngle*T/360+B.angleToRadians(E)},O=function(t){return t.endAngle*(T/360)+B.angleToRadians(E)},V=function(t){return null},W=e.pie().sort(null).value(s);return t.dispatch=H,t.id=function(e){return arguments.length?(i=e,t):i},t.color=function(e){return arguments.length?(m=e,t):m},t.fill=function(e){return arguments.length?(y=e,t):y},t.classes=function(e){return arguments.length?(x=e,t):x},t.gradient=function(e){return arguments.length?(v=e,t):v},t.margin=function(e){return arguments.length?(n.top="undefined"!=typeof e.top?e.top:n.top,n.right="undefined"!=typeof e.right?e.right:n.right,n.bottom="undefined"!=typeof e.bottom?e.bottom:n.bottom,n.left="undefined"!=typeof e.left?e.left:n.left,t):n},t.width=function(e){return arguments.length?(r=e,t):r},t.height=function(e){return arguments.length?(a=e,t):a},t.getKey=function(e){return arguments.length?(o=e,t):o},t.getValue=function(e){return arguments.length?(s=e,t):s},t.getCount=function(e){return arguments.length?(l=e,t):l},t.fmtKey=function(e){return arguments.length?(c=e,t):c},t.fmtValue=function(e){return arguments.length?(u=e,t):u},t.fmtCount=function(e){return arguments.length?(d=e,t):d},t.direction=function(e){return arguments.length?(h=e,t):h},t.delay=function(e){return arguments.length?(g=e,t):g},t.duration=function(e){return arguments.length?(p=e,t):p},t.locality=function(e){return arguments.length?(f=B.buildLocality(e),t):f},t.textureFill=function(e){return arguments.length?(b=e,t):b},t.showLabels=function(e){return arguments.length?(w=e,t):w},t.labelSunbeamLayout=function(e){return arguments.length?(F=e,t):F},t.donutLabelsOutside=function(e){return arguments.length?(I=e,t):I},t.pieLabelsOutside=function(e){return arguments.length?(M=e,t):M},t.showLeaders=function(e){return arguments.length?(k=e,t):k},t.donut=function(e){return arguments.length?(C=e,t):C},t.hole=function(e){return arguments.length?(S=e,t):S},t.holeFormat=function(e){return arguments.length?(_=B.functor(e),t):_},t.donutRatio=function(e){return arguments.length?(P=e,t):P},t.startAngle=function(e){return arguments.length?(R=e,t):R},t.endAngle=function(e){return arguments.length?(O=e,t):O},t.labelThreshold=function(e){return arguments.length?(A=e,t):A},t.arcDegrees=function(e){return arguments.length?(T=Math.max(Math.min(e,360),1),t):T},t.rotateDegrees=function(e){return arguments.length?(E=e%360,t):E},t.minRadius=function(e){return arguments.length?(z=e,t):z},t.maxRadius=function(e){return arguments.length?(N=e,t):N},t.fixedRadius=function(e){return arguments.length?(V=B.functor(e),t):V},t}function f(){function t(d,f,h,g){function p(){if(u){var t=e.zoom().on("zoom",l);h.call(t),z.call(t)}else h.on("zoom",null),z.on("zoom",null)}function m(){L.append("linearGradient").attr("class","sc-scroll-gradient").attr("id","sc-back-gradient-prev-"+n);var t=L.select("#sc-back-gradient-prev-"+n);L.append("linearGradient").attr("class","sc-scroll-gradient").attr("id","sc-back-gradient-more-"+n);var e=L.select("#sc-back-gradient-more-"+n);t.append("stop").attr("stop-color","#000").attr("stop-opacity","0.3").attr("offset",0),t.append("stop").attr("stop-color","#FFF").attr("stop-opacity","0").attr("offset",1),e.append("stop").attr("stop-color","#FFF").attr("stop-opacity","0").attr("offset",0),e.append("stop").attr("stop-color","#000").attr("stop-opacity","0.3").attr("offset",1),L.append("linearGradient").attr("class","sc-scroll-gradient").attr("id","sc-fore-gradient-prev-"+n);var r=L.select("#sc-fore-gradient-prev-"+n);L.append("linearGradient").attr("class","sc-scroll-gradient").attr("gradientUnits","objectBoundingBox").attr("x1",0).attr("y1",0).attr("id","sc-fore-gradient-more-"+n);var a=L.select("#sc-fore-gradient-more-"+n);r.append("stop").attr("stop-color","#FFF").attr("stop-opacity","1").attr("offset",0),r.append("stop").attr("stop-color","#FFF").attr("stop-opacity","0").attr("offset",1),a.append("stop").attr("stop-color","#FFF").attr("stop-opacity","0").attr("offset",0),a.append("stop").attr("stop-color","#FFF").attr("stop-opacity","1").attr("offset",1),D.selectAll(".sc-scroll-gradient").attr("gradientUnits","objectBoundingBox").attr("x1",0).attr("y1",0)}function v(){D.selectAll(".sc-scroll-gradient").attr("x2",a?1:0).attr("y2",a?0:1)}function y(){L.append("clipPath").attr("class","sc-scroll-mask").attr("id","sc-edge-clip-"+n).append("rect"),P=D.select(".sc-scroll-mask rect")}function b(){h.attr("clip-path",u?"url(#sc-edge-clip-"+n+")":"")}function x(t,e){P.attr("x",a?2:-r.left).attr("y",a?0:2).attr("width",t+(a?-2:r.left)).attr("height",e+(a?r.bottom:-2))}function w(){f.select(".sc-background-wrap").append("rect").attr("class","sc-scroll-target").attr("fill","transparent"),z=d.select(".sc-scroll-target")}function k(t,e,n,r){z.attr("x",t).attr("y",e).attr("width",n).attr("height",r)}function M(){var t=f.select(".sc-background-wrap").append("g").attr("class","sc-back-shadow-wrap");t.append("rect").attr("class","sc-back-shadow-prev"),t.append("rect").attr("class","sc-back-shadow-more"),N=d.select(".sc-back-shadow-wrap")}function I(){var t=a?"width":"height";N.select("rect.sc-back-shadow-prev").attr("fill",u?"url(#sc-back-gradient-prev-"+n+")":"transparent").attr(t,7),N.select("rect.sc-back-shadow-more").attr("fill",u?"url(#sc-back-gradient-more-"+n+")":"transparent").attr(t,7)}function A(t,e,n,r,i,o){N.select(".sc-back-shadow-prev").attr("x",t).attr("y",e).attr(i,o),N.select(".sc-back-shadow-more").attr("x",t+(a?n-5:1)).attr("y",e+(a?0:r-6)).attr(i,o)}function C(){var t=f.select(".sc-background-wrap").insert("g").attr("class","sc-fore-shadow-wrap");t.append("rect").attr("class","sc-fore-shadow-prev"),t.append("rect").attr("class","sc-fore-shadow-more"),H=d.select(".sc-fore-shadow-wrap")}function S(){var t=a?"width":"height";H.select(".sc-fore-shadow-prev").attr("fill",u?"url(#sc-fore-gradient-prev-"+n+")":"transparent").attr(t,20),H.select(".sc-fore-shadow-more").attr("fill",u?"url(#sc-fore-gradient-more-"+n+")":"transparent").attr(t,20)}function F(t,e,n,r){H.select(".sc-fore-shadow-prev").attr("x",t+(a?1:0)).attr("y",e+(a?0:1)).attr(n,r),H.select(".sc-fore-shadow-more").attr("x",t+(a?s-17:0)).attr("y",e+(a?0:s-19)).attr(n,r)}var D=d.select("defs"),L=f.select("defs"),T=h.select(".sc-axis-wrap.sc-axis-x"),E=h.select(".sc-bars-wrap"),P,z,N,H,_=0;return m(),y(),w(),M(),C(),t.render=function(){p(),v(),b(),I(),S()},t.resize=function(e,n){var s,l,d,f,h,p,m;_=e,c=n,t.render(),u&&(s=g.labelThickness()+g.tickPadding()/2,l=a?r.left:s,d=r.top,f=i+(a?0:r[g.orient()]-s),h=o+(a?r[g.orient()]-s:0),p=a?"height":"width",m=a?h:f,x(i,o),k(l,d,f,h),A(l,d,i,o,p,m),F(l,d,p,m))},t.pan=function(t){var n=e.event,r,i=0,o=0,s=0,l="";return!n||"click"!==n.type&&"zoom"!==n.type?0:(r=n.sourceEvent,"zoom"===n.type&&r&&("wheel"===r.type?(i=-r.deltaX,o=-r.deltaY,s=_+(Math.abs(i)>Math.abs(o)?i:o)):"mousemove"===r.type?(i=r.movementX,o=r.movementY,s=_+(Math.abs(i)>Math.abs(o)?i:o)):"touchmove"===r.type&&(i=n.transform.x,o=n.transform.y,s=Math.abs(i)>Math.abs(o)?i:o)),_=Math.min(Math.max(s,t),-1),l="translate("+(a?_+",0":"0,"+_)+")",(s>0||t>s)&&c(Math.abs(o)>Math.abs(i)?o:0),H.attr("transform",l),E.attr("transform",l),T.select(".sc-wrap.sc-axis").attr("transform",l),_)},t}var n,r={},a,i,o,s,l,c,u;return t.id=function(e){return arguments.length?(n=e,t):n},t.margin=function(e){return arguments.length?(r.top="undefined"!=typeof e.top?e.top:r.top,r.right="undefined"!=typeof e.right?e.right:r.right,r.bottom="undefined"!=typeof e.bottom?e.bottom:r.bottom,r.left="undefined"!=typeof e.left?e.left:r.left,t):r},t.width=function(e){return arguments.length?(i=e,t):i},t.height=function(e){return arguments.length?(o=e,t):o},t.vertical=function(e){return arguments.length?(a=e,t):a},t.minDimension=function(e){return arguments.length?(s=e,t):s},t.panHandler=function(e){return arguments.length?(l=B.functor(e),t):l},t.enable=function(e){return arguments.length?(u=e,t):u},t}function h(){function t(r){return r.each(function(r){function o(t){var e=t&&t.length,r=(z-n.left-n.right)/2+n.left,a=(N-n.top-n.bottom)/2+n.top;return B.displayNoData(e,L,h.noData,r,a)}function s(t){var n=e.extent(e.merge(t.map(function(t){return t.values.map(function(t,n){return e.timeParse("%Y-%m-%d")(p(t))})}))),r=[e.timeMonth.floor(n[0]),e.timeDay.offset(e.timeMonth.ceil(n[1]),-1)];return r}function l(t){function n(t){return 32-new Date(t.getFullYear(),t.getMonth(),32).getDate()}var r=e.timeMonth.range(t[0],t[1]),a=r.map(function(t){return e.timeDay.offset(e.timeMonth.floor(t),n(t)/2-1)});return a}function c(t){var n=e.nest().key(y).entries(t),r=1e3/n.length,a=X,i=[0,1],o=[0,1],s=e.scaleLinear().domain(i).range(o),l=[],c=0;return n.map(function(t,e){return t.total=0,t.values=t.values.sort(function(t,e){return e.y<t.y?-1:e.y>t.y?1:0}).map(function(e){return t.total+=e.y,e}),t.group=e,t}).sort(function(t,e){return t.total<e.total?-1:t.total>e.total?1:0}).map(function(t,n){return c+=t.total,i=e.extent(t.values.map(function(t){return t.y})),o=[r*n+a,r*(n+1)-a],s.domain(i).range(o),t.values=t.values.map(function(e){return e.group=t.group,e.opportunity=e.y,e.y=s(e.opportunity),e}),l.push({key:t.key,y:e.min(t.values.map(function(t){return t.y}))}),t}),l}var k=this,L=e.select(this),T="bubble",E=r?r.properties||{}:{},P=r?r.data||[]:[],z=parseInt(L.style("width"),10),N=parseInt(L.style("height"),10),H=a,_=i,O="datetime"===E.xDataType||!1,V="currency"===E.yDataType||!1,W,G,j,Y,q,X,Z=function(t,e,n,r){return x(t,e,t,O,"%B")},K=function(t,e,n,r){var a=q&&Array.isArray(q)?q[e].key||t:t,i=Math.max(.2*H,75);return isNaN(a)?B.stringEllipsify(a,L,i):w(t,e,a,V)},U=[];if(t.update=function(){L.transition().duration(u).call(t)},t.container=this,o(P))return t;f.disabled=P.map(function(t){return!!t.disabled}),G=e.nest().key(b).entries(P),W=G.sort(function(t,e){return parseInt(t.key,10)<parseInt(e.key,10)?-1:parseInt(t.key,10)>parseInt(e.key,10)?1:0}).map(function(t,e){return t.seriesIndex=e,t.classes=t.values[0].classes,t.color=t.values[0].color,t}),X=Math.sqrt(I.sizeRange()[1]/Math.PI),A.chart(t).title(E.title).controlsData(U).legendData(W),A.legend.key(function(t){return t.key+"%"}),j=s(W),q=c(P),Y=e.extent(e.merge(W.map(function(t){return t.values.map(function(t,e){return m(t,e)})})).concat(v)),C.orient("bottom").scale(I.xScale()).valueFormat(Z).ticks(e.timeMonths,1).tickValues(l(j)).tickSize(0).tickPadding(4).highlightZero(!1).showMaxMin(!1),S.orient("left").scale(I.yScale()).valueFormat(K).ticks(q.length).tickValues(q.map(function(t,e){return q[e].y})).tickPadding(7).highlightZero(!1).showMaxMin(!1);var $=L.selectAll("g.sc-chart-wrap").data([W]),J=$.enter().append("g").attr("class","sc-chart-wrap sc-chart-"+T),Q=L.select(".sc-chart-wrap").merge(J);J.append("defs"),J.append("g").attr("class","sc-background-wrap");var tt=Q.select(".sc-background-wrap");J.append("g").attr("class","sc-title-wrap"),J.append("g").attr("class","sc-axis-wrap sc-axis-x");var et=Q.select(".sc-axis-wrap.sc-axis-x");J.append("g").attr("class","sc-axis-wrap sc-axis-y");var nt=Q.select(".sc-axis-wrap.sc-axis-y");J.append("g").attr("class","sc-"+T+"-wrap");var rt=Q.select(".sc-"+T+"-wrap");J.append("g").attr("class","sc-controls-wrap"),J.append("g").attr("class","sc-legend-wrap"),Q.attr("transform",B.translation(n.left,n.top)),J.select(".sc-background-wrap").append("rect").attr("class","sc-background").attr("x",-n.left).attr("y",-n.top).attr("fill","#FFF"),t.render=function(){function e(){l.left=Math.max(m.left,p.left),l.right=Math.max(m.right,p.right),l.top=Math.max(m.top,p.top)+f,l.bottom=Math.max(m.bottom,p.bottom)}function r(){c=H-l.left-l.right,d=_-l.top-l.bottom,I.resetDimensions(c,d)}var o,s,l,c,d,f,h=0,g=0;z=parseInt(L.style("width"),10),N=parseInt(L.style("height"),10),o=a||z||960,s=i||N||400,H=o-n.left-n.right,_=s-n.top-n.bottom,l={top:0,right:0,bottom:0,left:0},c=H-l.left-l.right,d=_-l.top-l.bottom,tt.select(".sc-background").attr("width",o).attr("height",s),A.width(H).height(_),L.call(A),f=A.getHeight(),l.top+=f,l.top+=X,d=_-l.top-l.bottom,I.width(c).height(d).id(t.id()).xDomain(j).yDomain(Y),rt.datum(W.filter(function(t){return!t.disabled})).transition().duration(u).call(I);var p={top:0,right:0,bottom:0,left:0},m={top:0,right:0,bottom:0,left:0};S.margin(l),nt.call(S),p=S.margin(),e(),r(),C.tickSize(0).margin(l),et.call(C),m=C.margin(),e(),r(),S.tickSize(-c,0).margin(l),nt.call(S),nt.select("path.domain").attr("d","M0,0V0.5H0V"+d),rt.transition().duration(t.delay()).call(I),h=l.left,g=l.top+("bottom"===C.orient()?d:0),et.attr("transform",B.translation(h,g)),h=l.left+("left"===S.orient()?0:c),g=l.top,nt.attr("transform",B.translation(h,g)),rt.attr("transform",B.translation(l.left,l.top))},t.render(),A.legend.dispatch.on("legendClick",function(e,n){e.disabled=!e.disabled,W.filter(function(t){return!t.disabled}).length||W.forEach(function(t){t.disabled=!1,L.selectAll(".sc-series").classed("disabled",!1)}),f.disabled=W.map(function(t){return!!t.disabled}),g.call("stateChange",this,f),t.update()}),g.on("tooltipShow",function(t){d&&(F=D(t,k.parentNode,E))}),g.on("tooltipMove",function(t){F&&R.position(k.parentNode,F,t,"s")}),g.on("tooltipHide",function(){d&&R.cleanup()}),g.on("changeState",function(e){"undefined"!=typeof e.disabled&&(P.forEach(function(t,n){t.disabled=e.disabled[n]}),f.disabled=e.disabled),t.update()}),g.on("chartClick",function(){g.call("tooltipHide",this),A.controls.enabled()&&A.controls.dispatch.call("closeMenu",this),A.legend.enabled()&&A.legend.dispatch.call("closeMenu",this)}),I.dispatch.on("elementClick",function(e){g.call("chartClick",this),M(P,e,t)}),L.on("click",function(){e.event.stopPropagation(),g.call("chartClick",this)})}),t}var n={top:10,right:10,bottom:10,left:10},a=null,i=null,o="ltr",c=0,u=0,d=!0,f={},h={legend:{close:"Hide legend",open:"Show legend"},controls:{close:"Hide controls",open:"Show controls"},noData:"No Data Available.",noLabel:"undefined"},g=e.dispatch("chartClick","elementClick","tooltipShow","tooltipHide","tooltipMove","stateChange","changeState"),p=function(t){return t.x},m=function(t){return t.y},v=[0],y=function(t){return t.y},b=function(t){return t.y},x=function(e,n,r,a,i){var o=r||e;return a?(i=i&&0===i.indexOf("%")?i:"MM",B.dateFormat(o,i,t.locality())):o},w=function(e,n,r,a,i){return i=isNaN(i)?2:i,B.numberFormatSI(r,i,a,t.locality())},k=function(t,e){var n=t.series.key,r=t.point.x,a=t.point.y;return"<h3>"+n+"</h3><p>"+a+" on "+r+"</p>"},M=function(t,e,n,r){},I=l(),A=s(),C=r(),S=r(),F=null,D=function(t,e,n){var r=k(t,n),a=t.value<0?"n":"s";return R.show(t.e,r,a,null,e)};return I.padData(!0).padDataOuter(-1).size(function(t){return t.y}).sizeRange([256,1024]).singlePoint(!0),A.showTitle(!0).showControls(!1).showLegend(!0).alignLegend("center"),I.dispatch.on("elementMouseover.tooltip",function(t){g.call("tooltipShow",this,t)}),I.dispatch.on("elementMousemove.tooltip",function(t){g.call("tooltipMove",this,t)}),I.dispatch.on("elementMouseout.tooltip",function(){g.call("tooltipHide",this)}),t.dispatch=g,t.scatter=I,t.legend=A.legend,t.controls=A.controls,t.xAxis=C,t.xAxisLabel=C.axisLabel,t.yAxis=S,t.yAxisLabel=S.axisLabel,t.options=B.optionsFunc.bind(t),B.rebind(t,I,"id","x","y","xScale","yScale","xDomain","yDomain","forceX","forceY","clipEdge","color","fill","classes","gradient","locality"),B.rebind(t,I,"size","zScale","sizeDomain","forceSize","interactive","clipVoronoi","clipRadius"),B.rebind(t,A,"showTitle","showControls","showLegend"),B.rebind(t,C,"rotateTicks","reduceXTicks","staggerTicks","wrapTicks"),t.colorData=function(n){var r=arguments[0],a=arguments[1]||{},i=function(t){return B.defaultColor()(t,t.seriesIndex)},o=function(t){return"sc-series sc-series-"+t.seriesIndex};switch(r){case"graduated":i=function(t){return e.interpolateHsl(e.rgb(a.c1),e.rgb(a.c2))(t.seriesIndex/a.l)};break;case"class":i=function(){return"inherit"},o=function(t){var e=t.seriesIndex,n=e*(a.step||1)%14;return n=(n>9?"":"0")+n,"sc-series sc-series-"+e+" sc-fill"+n+" sc-stroke"+n};break;case"data":i=function(t){return t.classes?"inherit":t.color||B.defaultColor()(t,t.seriesIndex)},o=function(t){var e=t.seriesIndex;return"sc-series sc-series-"+e+(t.classes?" "+t.classes:"")}}var s=a.gradient?function(t,e){return I.gradientFill(t,t.seriesIndex)}:i;return I.color(i),I.fill(s),I.classes(o),A.legend.color(i),A.legend.classes(o),t},t.margin=function(e){if(!arguments.length)return n;for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);return t},t.width=function(e){return arguments.length?(a=e,t):a},t.height=function(e){return arguments.length?(i=e,t):i},t.tooltips=function(e){return arguments.length?(d=e,t):d},t.tooltipContent=function(e){return arguments.length?(k=e,t):k},t.state=function(e){return arguments.length?(f=e,g.call("stateChange",this,f),t):f},t.strings=function(e){if(!arguments.length)return h;for(var n in e)e.hasOwnProperty(n)&&(h[n]=e[n]);return A.strings(h),t},t.direction=function(e){return arguments.length?(o=e,I.direction(e),C.direction(e),S.direction(e),A.direction(e),t):o},t.duration=function(e){return arguments.length?(u=e,I.duration(e),t):u},t.delay=function(e){return arguments.length?(c=e,I.delay(e),t):c},t.xValueFormat=function(e){return arguments.length?(x=e,t):x},t.yValueFormat=function(e){return arguments.length?(w=e,t):w},t.seriesClick=function(e){return arguments.length?(M=e,t):M},t.groupBy=function(e){return arguments.length?(y=e,t):y},t.filterBy=function(e){return arguments.length?(b=e,t):b},t}function g(){function t(a){return a.each(function(a){function o(t){var e=t&&t.length,r=(I-n.left-n.right)/2+n.left,a=(A-n.top-n.bottom)/2+n.top;return B.displayNoData(e,l,h.noData,r,a)}var s=this,l=e.select(this),b="funnel",k=a?a.properties||{}:{},M=a?a.data||null:null,I=parseInt(l.style("width"),10),A=parseInt(l.style("height"),10),C="datetime"===k.xDataType||!1,S="currency"===k.yDataType||!1;if(t.update=function(){l.transition().duration(c).call(t)},t.container=this,o(M))return t;t.setActiveState=function(t,e){t.active=e},t.clearActive=function(e){M.forEach(function(n){t.setActiveState(n,e||"")}),delete d.active},t.seriesActivate=function(e){var n=e.series||M[e.seriesIndex],r;n&&(f?(r="undefined"==typeof n.active||"inactive"===n.active||""===n.active?"active":"",t.clearActive("active"===r?"inactive":""),t.setActiveState(n,r),d.active=M.map(function(t){return"active"===t.active})):t.dataSeriesActivate({series:n}))},t.dataSeriesActivate=function(e){var n=e.series;n.active=n.active&&"inactive"!==n.active?"inactive":"active","active"===n.active&&M.filter(function(t){return"active"!==t.active}).forEach(function(t){return t.active="inactive",t}),M.filter(function(t){return"active"===t.active}).length||t.clearActive()},M.forEach(function(t,n){t.seriesIndex=n,t.values||(t.value?isNaN(t.value)||(t.values=[{x:0,y:parseInt(t.value,10)}]):t.values=[]),t.values.forEach(function(e,n){e.index=n,e.series=t,"undefined"==typeof e.value&&(e.value=e.y)}),t.key=t.key||h.noLabel,t.value=t.value||e.sum(t.values,function(t){return t.value}),t.count=t.count||t.values.length,t.disabled=t.disabled||0===t.value});var F=M.filter(function(t){return!t.disabled});if(F.length||(F=[{values:[]}]),k.count=e.sum(F,function(t){return t.count}),k.total=e.sum(F,function(t){return t.value}),d.disabled=M.map(function(t){return!!t.disabled}),!k.total)return o(),t;m.chart(t).title(k.title).controlsData(v).legendData(M);var D=l.selectAll("g.sc-chart-wrap").data([F]),L=D.enter().append("g").attr("class","sc-chart-wrap sc-chart-"+b),T=l.select(".sc-chart-wrap").merge(L);L.append("defs");var E=T.select("defs");L.append("g").attr("class","sc-background-wrap");var P=T.select(".sc-background-wrap");L.append("g").attr("class","sc-title-wrap"),L.append("g").attr("class","sc-"+b+"-wrap");var z=T.select(".sc-"+b+"-wrap");L.append("g").attr("class","sc-controls-wrap"),L.append("g").attr("class","sc-legend-wrap"),T.attr("transform",B.translation(n.left,n.top)),L.select(".sc-background-wrap").append("rect").attr("class","sc-background").attr("x",-n.left).attr("y",-n.top).attr("fill","#FFF"),t.render=function(){var t,e,a,o,s,u,d,f;I=parseInt(l.style("width"),10),A=parseInt(l.style("height"),10),t=r||I||960,e=i||A||400,a=t-n.left-n.right,o=e-n.top-n.bottom,s={top:0,right:0,bottom:0,left:0},u=a-s.left-s.right,d=o-s.top-s.bottom,P.select(".sc-background").attr("width",t).attr("height",e),m.width(a).height(o),l.call(m),f=m.getHeight(),s.top+=f,d=o-s.top-s.bottom,p.width(u).height(d),z.datum(F).attr("transform",B.translation(s.left,s.top)).transition().duration(c).call(p)},t.render(),m.legend.dispatch.on("legendClick",function(e,n){e.disabled=!e.disabled,e.active=!1,M.filter(function(t){return!t.disabled}).length||M.forEach(function(t){t.disabled=!1}),M.filter(function(t){return"active"===t.active}).length||M.forEach(function(t){t.active=""}),d.disabled=M.map(function(t){return!!t.disabled}),g.call("stateChange",this,d),t.update()}),g.on("tooltipShow",function(t){u&&(y=x(t,s.parentNode,k))}),g.on("tooltipMove",function(t){y&&R.position(s.parentNode,y,t)}),g.on("tooltipHide",function(){u&&R.cleanup()}),g.on("changeState",function(e){"undefined"!=typeof e.disabled&&(F.forEach(function(t,n){t.disabled=e.disabled[n]}),d.disabled=e.disabled),t.update()}),g.on("chartClick",function(){m.controls.enabled()&&m.controls.dispatch.call("closeMenu",this),m.legend.enabled()&&m.legend.dispatch.call("closeMenu",this)}),p.dispatch.on("elementClick",function(e){g.call("chartClick",this),w(M,e,t)})}),t}var n={top:10,right:10,bottom:10,left:10},r=null,i=null,o="ltr",l=0,c=0,u=!0,d={},f=!0,h={legend:{close:"Hide legend",open:"Show legend"},controls:{close:"Hide controls",open:"Show controls"},noData:"No Data Available.",noLabel:"undefined"},g=e.dispatch("chartClick","elementClick","tooltipShow","tooltipHide","tooltipMove","stateChange","changeState"),p=a(),m=s(),v=[],y=null,b=function(e,n){var r=p.fmtKey()(e),a=n.seriesLabel||"Key",i=p.getValue()(e),o=n.total?(100*i/n.total).toFixed(1):100,s="currency"===n.yDataType,l=B.numberFormat(i,2,s,t.locality()),c=B.numberFormat(o,2,!1,t.locality());return"<p>"+a+": <b>"+r+"</b></p><p>"+(s?"Amount":"Count")+": <b>"+l+"</b></p><p>Percent: <b>"+c+"%</b></p>"},x=function(t,e,n){var r=b(t,n);return R.show(t.e,r,null,null,e)},w=function(t,e,n){};return m.showTitle(!0).showControls(!1).showLegend(!0).alignLegend("center"),p.dispatch.on("elementMouseover.tooltip",function(t){g.call("tooltipShow",this,t)}),p.dispatch.on("elementMousemove.tooltip",function(t){g.call("tooltipMove",this,t)}),p.dispatch.on("elementMouseout.tooltip",function(){g.call("tooltipHide",this)}),t.dispatch=g,t.funnel=p,t.legend=m.legend,t.controls=m.controls,t.options=B.optionsFunc.bind(t),B.rebind(t,p,"id","color","fill","classes","gradient","locality","textureFill"),B.rebind(t,p,"getKey","getValue","getCount","fmtKey","fmtValue","fmtCount"),B.rebind(t,p,"yScale","yDomain","forceY","wrapLabels","minLabelWidth"),B.rebind(t,m,"showTitle","showControls","showLegend"),t.colorData=function(n){var r=arguments[0],a=arguments[1]||{},i=function(t,e){return B.defaultColor()(t,t.seriesIndex)},o=function(t,e){return"sc-series sc-series-"+t.seriesIndex};switch(r){case"graduated":i=function(t,n){return e.interpolateHsl(e.rgb(a.c1),e.rgb(a.c2))(t.seriesIndex/a.l)};break;case"class":i=function(){return"inherit"},o=function(t,e){var n=t.seriesIndex*(a.step||1)%14;return n=(n>9?"":"0")+n,"sc-series sc-series-"+t.seriesIndex+" sc-fill"+n+" sc-stroke"+n;
};break;case"data":i=function(t,e){return B.defaultColor()(t,t.seriesIndex)},o=function(t,e){return"sc-series sc-series-"+t.seriesIndex+(t.classes?" "+t.classes:"")}}var s=a.gradient?function(t,e){var n={orientation:a.orientation||"vertical",position:a.position||"middle"};return p.gradientFill(t,t.seriesIndex,n)}:i;return p.color(i),p.fill(s),p.classes(o),m.legend.color(i),m.legend.classes(o),t},t.margin=function(e){if(!arguments.length)return n;for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);return t},t.width=function(e){return arguments.length?(r=e,t):r},t.height=function(e){return arguments.length?(i=e,t):i},t.tooltips=function(e){return arguments.length?(u=e,t):u},t.tooltipContent=function(e){return arguments.length?(b=e,t):b},t.state=function(e){return arguments.length?(d=e,g.call("stateChange",this,d),t):d},t.strings=function(e){if(!arguments.length)return h;for(var n in e)e.hasOwnProperty(n)&&(h[n]=e[n]);return m.strings(h),t},t.direction=function(e){return arguments.length?(o=e,p.direction(e),m.direction(e),t):o},t.duration=function(e){return arguments.length?(c=e,p.duration(e),t):c},t.delay=function(e){return arguments.length?(l=e,p.delay(e),t):l},t.seriesClick=function(e){return arguments.length?(w=e,t):w},t}function p(){function t(i){return i.each(function(i){function o(t){var e=t&&t.length,r=(k-n.left-n.right)/2+n.left,a=(M-n.top-n.bottom)/2+n.top;return B.displayNoData(e,l,f.noData,r,a)}var s=this,l=e.select(this),y="gauge",x=i?i.properties||{}:{},w=i?i.data||null:null,k=parseInt(l.style("width"),10),M=parseInt(l.style("height"),10),I="datetime"===x.xDataType||!1,A="currency"===x.yDataType||!1;if(t.update=function(){l.transition().duration(c).call(t)},t.container=this,o(w))return t;w.forEach(function(t,n){var r=g.y();t.seriesIndex=n,t.value=r(t),t.value||t.values?isNaN(t.value)||(t.values=[{x:0,y:parseInt(t.value,10)}]):t.values=[],t.values.forEach(function(e,n){e.index=n,e.series=t,"undefined"==typeof e.value&&(e.value=r(e))}),t.value=t.value||e.sum(t.values,function(t){return t.value}),t.count=t.count||t.values.length,t.disabled=t.disabled||0===t.value});var C=w.filter(function(t,e){return!t.disabled});if(C.length||(C=[{values:[]}]),x.count=e.sum(C,function(t){return t.count}),x.total=e.sum(C,function(t){return t.value}),d.disabled=w.map(function(t){return!!t.disabled}),!x.total)return o(),t;p.chart(t).title(x.title).controlsData(m).legendData(w);var S=l.selectAll("g.sc-chart-wrap").data([C]),F=S.enter().append("g").attr("class","sc-chart-wrap sc-chart-"+y),D=l.select(".sc-chart-wrap").merge(F);F.append("defs"),F.append("g").attr("class","sc-background-wrap");var L=D.select(".sc-background-wrap");F.append("g").attr("class","sc-title-wrap"),F.append("g").attr("class","sc-"+y+"-wrap");var T=D.select(".sc-"+y+"-wrap");F.append("g").attr("class","sc-controls-wrap"),F.append("g").attr("class","sc-legend-wrap"),D.attr("transform",B.translation(n.left,n.top)),F.select(".sc-background-wrap").append("rect").attr("class","sc-background").attr("x",-n.left).attr("y",-n.top).attr("fill","#FFF"),t.render=function(){var t,e,i,o,s,u,d,f;k=parseInt(l.style("width"),10),M=parseInt(l.style("height"),10),t=r||k||960,e=a||M||400,i=t-n.left-n.right,o=e-n.top-n.bottom,s={top:0,right:0,bottom:0,left:0},u=i-s.left-s.right,d=o-s.top-s.bottom,L.select(".sc-background").attr("width",t).attr("height",e),p.width(i).height(o),l.call(p),f=p.getHeight(),s.top+=f,d=o-s.top-s.bottom,g.width(u).height(d),T.datum(C).attr("transform",B.translation(s.left,s.top)).transition().duration(c).call(g),g.setPointer(x.total)},t.render(),h.on("tooltipShow",function(t){u&&(v=b(t,s.parentNode,x))}),h.on("tooltipMove",function(t){v&&R.position(s.parentNode,v,t)}),h.on("tooltipHide",function(){u&&R.cleanup()}),h.on("changeState",function(e){"undefined"!=typeof e.disabled&&(C.forEach(function(t,n){t.disabled=e.disabled[n]}),d.disabled=e.disabled),t.update()}),h.on("chartClick",function(){p.controls.enabled()&&p.controls.dispatch.call("closeMenu",this),p.legend.enabled()&&p.legend.dispatch.call("closeMenu",this)})}),t}var n={top:10,right:10,bottom:10,left:10},r=null,a=null,o="ltr",l=0,c=0,u=!0,d={},f={legend:{close:"Hide legend",open:"Show legend"},controls:{close:"Hide controls",open:"Show controls"},noData:"No Data Available.",noLabel:"undefined"},h=e.dispatch("chartClick","tooltipShow","tooltipHide","tooltipMove","stateChange","changeState"),g=i(),p=s(),m=[],v=null,y=function(t,e){var n=g.fmtKey()(t.point.series),r=g.getCount()(t.point.series),a=g.getValue()(t.point.y1-t.point.y0);return"<h3>"+n+"</h3><p>"+a+" on "+r+"</p>"},b=function(t,e,n){var r=y(t,n);return R.show(t.e,r,null,null,e)};return p.showTitle(!0).showControls(!1).showLegend(!0).alignLegend("center"),g.dispatch.on("elementMouseover.tooltip",function(t){h.call("tooltipShow",this,t)}),g.dispatch.on("elementMousemove.tooltip",function(t){h.call("tooltipMove",this,t)}),g.dispatch.on("elementMouseout.tooltip",function(){h.call("tooltipHide",this)}),t.dispatch=h,t.gauge=g,t.legend=p.legend,t.controls=p.controls,t.options=B.optionsFunc.bind(t),B.rebind(t,g,"id","x","y","color","fill","classes","gradient","locality"),B.rebind(t,g,"getKey","getValue","getCount","fmtKey","fmtValue","fmtCount"),B.rebind(t,g,"showLabels","showPointer","setPointer","ringWidth","labelThreshold","maxValue","minValue"),B.rebind(t,p,"showTitle","showControls","showLegend"),t.colorData=function(n){var r=arguments[0],a=arguments[1]||{},i=function(t,e){return B.defaultColor()(t,t.seriesIndex)},o=function(t,e){return"sc-series sc-series-"+t.seriesIndex};switch(r){case"graduated":i=function(t,n){return e.interpolateHsl(e.rgb(a.c1),e.rgb(a.c2))(t.seriesIndex/a.l)};break;case"class":i=function(){return"inherit"},o=function(t,e){var n=t.seriesIndex*(a.step||1)%14;return n=(n>9?"":"0")+n,"sc-series sc-series-"+t.seriesIndex+" sc-fill"+n+" sc-stroke"+n};break;case"data":i=function(t,e){return B.defaultColor()(t,t.seriesIndex)},o=function(t,e){return"sc-series sc-series-"+t.seriesIndex+(t.classes?" "+t.classes:"")}}var s=a.gradient?function(t,e){return g.gradientFill(t,t.seriesIndex)}:i;return g.color(i),g.fill(s),g.classes(o),p.legend.color(i),p.legend.classes(o),t},t.margin=function(e){if(!arguments.length)return n;for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);return t},t.width=function(e){return arguments.length?(r=e,t):r},t.height=function(e){return arguments.length?(a=e,t):a},t.tooltips=function(e){return arguments.length?(u=e,t):u},t.tooltipContent=function(e){return arguments.length?(y=e,t):y},t.state=function(e){return arguments.length?(d=e,t):d},t.strings=function(e){if(!arguments.length)return f;for(var n in e)e.hasOwnProperty(n)&&(f[n]=e[n]);return p.strings(f),t},t.direction=function(e){return arguments.length?(o=e,g.direction(e),p.direction(e),t):o},t.duration=function(e){return arguments.length?(c=e,g.duration(e),t):c},t.delay=function(e){return arguments.length?(l=e,g.delay(e),t):l},t}function m(){function t(r){return r.each(function(r){function o(t){var e=t&&t.length&&t.filter(function(t){return!t.disabled&&Array.isArray(t.values)&&t.values.length}).length,r=(D-n.left-n.right)/2+n.left,a=(L-n.top-n.bottom)/2+n.top;return B.displayNoData(e,y,h.noData,r,a)}function s(t){_=t.map(function(t){return t.label}),O=_.length,V=O>0}function l(t,n){var r=n.map(function(t){return e.select(t).datum()}),a=e.max(e.extent(r),function(t){return B.siDecimal(Math.abs(t))}),i=e.max(r,function(t){return B.countSigFigsAfter(e.formatPrefix(".2s",a)(t))});return"maxmin"===t&&J.axis&&(i=Math.max(J.axis.precision,i)),J[t]={decimal:a,precision:i},J[t]}var c=this,y=e.select(this),C="line",S=r?r.properties||{}:{},F=r?r.data||null:null,D=parseInt(y.style("width"),10),L=parseInt(y.style("height"),10),T=a,E=i,P="datetime"===S.xDataType||!1,z="currency"===S.yDataType||!1,N=S.groups||S.labels,H=Array.isArray(N)&&N.length>0,_=[],O=0,V=!1,W=[],G=0,j=0,Y=x.padData()?p:0,q=!1,X=[{key:"Linear",disabled:"linear"!==x.interpolate()},{key:"Basis",disabled:"basis"!==x.interpolate()},{key:"Monotone",disabled:"monotone"!==x.interpolate()},{key:"Cardinal",disabled:"cardinal"!==x.interpolate()},{key:"Line",disabled:x.isArea()()===!0},{key:"Area",disabled:x.isArea()()===!1}];if(t.update=function(){y.transition().duration(u).call(t)},t.setActiveState=function(t,e){t.active=e,t.values.forEach(function(t){t.active=e})},t.clearActive=function(e){F.forEach(function(n){t.setActiveState(n,e||"")}),delete f.active},t.cellActivate=function(e){var n=F[e.seriesIndex].values[e.pointIndex],r;n&&(r="undefined"==typeof n.active||"inactive"===n.active||""===n.active?"active":"",t.clearActive(),n.active=r)},t.seriesActivate=function(e){var n=e.series||F[e.seriesIndex],r;n&&(r="undefined"==typeof n.active||"inactive"===n.active||""===n.active?"active":"",t.clearActive("active"===r?"inactive":""),t.setActiveState(n,r),f.active=F.map(function(t){return"active"===t.active}))},t.dataSeriesActivate=function(e){var n=e.series||F[e.seriesIndex],r;n&&(r="undefined"==typeof n.active||"inactive"===n.active||""===n.active?"active":"inactive","active"===r?t.seriesActivate(e):t.clearActive())},t.container=this,o(F))return t;if(F.forEach(function(t,n){t.seriesIndex=n,t.key=t.key||h.noLabel,t.total=e.sum(t.values,function(t,e){return t.group=H?t.x-1:e,t.y}),t.disabled=t.disabled||0===t.total}),W=F.filter(function(t){return!t.disabled}).map(function(t,e){return t.seri=e,t}),G=W.length,o(W))return t;H?(N.forEach(function(t,e){var n="undefined"==typeof t.label||""===t.label?h.noLabel:P?B.isNumeric(t.label)||-1!==t.label.indexOf("GMT")?new Date(t.label):new Date(t.label+" GMT"):t.label;t.group=e,t.label=n,t.total=0,W.forEach(function(n,r){n.values.filter(function(t,n){return t.group===e}).forEach(function(e,n){t.total+=e.y})})}),s(N),j=e.sum(N,function(t){return t.total})):(_=e.merge(W.map(function(t){return t.values})).reduce(function(t,e){return-1===t.indexOf(e.x)&&t.push(e.x),t},[]).map(function(t,e){return P?new Date(t):t}),O=Math.min(Math.ceil(innerWidth/100),_.length),j=e.sum(W,function(t){return t.total}));var Z=75,K=null,U=null,$=null,J={axis:null,maxmin:null};P&&(K=B.getDateFormatUTC(_)),U=function(t,e,n,r){var a=V?_[e]:t,i=m(t,e,a,P,K);return"no-ellipsis"===r?i:B.stringEllipsify(i,y,Z)},$=function(t,e,n,r){var a=J[r]||l(r,n);return v(t,e,null,z,a.precision,a.decimal)},f.disabled=W.map(function(t){return!!t.disabled}),f.interpolate=x.interpolate(),f.isArea=x.isArea()(),w.chart(t).title(S.title).controlsData(X).legendData(F),q=1===e.max(W,function(t){return t.values.length});var Q=Math.pow(p,2)*Math.PI*(q?3:1);if(x.xScale(P?e.scaleTime():e.scaleLinear()).singlePoint(q).size(Q).sizeRange([Q,Q]).sizeDomain([Q,Q]),q){var tt=e.merge(W.map(function(t){return t.values.map(function(t,e){return x.x()(t,e)})})).reduce(function(t,e){return t.indexOf(e)<0&&t.push(e),t},[]).sort(function(t,e){return t-e}),et=e.extent(tt),nt=1*(P&&!_.length?864e5:1),rt=e.merge(W.map(function(t){return t.values.map(function(t,e){return x.y()(t,e)})})),at=e.extent(rt),it=1===W.length?2:Math.min((at[1]-at[0])/W.length,at[0]);x.xDomain([et[0]-nt,et[1]+nt]).yDomain([at[0]-it,at[1]+it]),k.orient("bottom").ticks(tt.length).tickValues(tt).highlightZero(!1).showMaxMin(!1),M.orient("left").ticks(q?5:null).highlightZero(!1).showMaxMin(!1)}else x.xDomain(null).yDomain(null),k.orient("bottom").tickValues(V?e.range(1,O+1):null).ticks(V?O:null).highlightZero(!1).showMaxMin(P),M.orient("left").ticks(null).highlightZero(!0).showMaxMin(!0);k.scale(x.xScale()).tickPadding(6).valueFormat(U),M.scale(x.yScale()).tickPadding(6).valueFormat($);var ot=y.selectAll("g.sc-chart-wrap").data([W]),st=ot.enter().append("g").attr("class","sc-chart-wrap sc-chart-"+C),lt=y.select(".sc-chart-wrap").merge(st);st.append("defs"),st.append("g").attr("class","sc-background-wrap");var ct=lt.select(".sc-background-wrap");st.append("g").attr("class","sc-title-wrap"),st.append("g").attr("class","sc-axis-wrap sc-axis-x");var ut=lt.select(".sc-axis-wrap.sc-axis-x");st.append("g").attr("class","sc-axis-wrap sc-axis-y");var dt=lt.select(".sc-axis-wrap.sc-axis-y");st.append("g").attr("class","sc-"+C+"-wrap");var ft=lt.select(".sc-"+C+"-wrap");st.append("g").attr("class","sc-controls-wrap"),st.append("g").attr("class","sc-legend-wrap"),lt.attr("transform",B.translation(n.left,n.top)),st.select(".sc-background-wrap").append("rect").attr("class","sc-background").attr("x",-n.left).attr("y",-n.top).attr("fill","#FFF"),t.render=function(){function t(t){return"width"===t?f:"height"===t?h:0}function e(){b=k.margin(),v=M.margin(),d.left=Math.max(b.left,v.left),d.right=Math.max(b.right,v.right),d.top=Math.max(b.top,v.top),d.bottom=Math.max(b.bottom,v.bottom),r()}function r(){f=T-d.left-d.right,h=E-g-d.top-d.bottom,x.resetDimensions(t("width"),t("height"))}function o(){M.tickSize(Y-f,0).margin(d),dt.call(M),e()}function s(){k.tickSize(Y-h,0).margin(d),ut.call(k),e()}var l,c,d,f,h,g,p=0,m=0;D=parseInt(y.style("width"),10),L=parseInt(y.style("height"),10),l=a||D||960,c=i||L||400,T=l-n.left-n.right,E=c-n.top-n.bottom,d={top:0,right:0,bottom:0,left:0},f=T-d.left-d.right,h=E-d.top-d.bottom,ct.select(".sc-background").attr("width",l).attr("height",c),Z=Math.max(.2*T,75),w.width(T).height(E),y.call(w),g=w.getHeight(),d.top+=g,h=E-d.top-d.bottom,x.width(t("width")).height(t("height")),ft.datum(W).call(x);var v={top:0,right:0,bottom:0,left:0},b={top:0,right:0,bottom:0,left:0};o(),s(),o(),s(),o(),ft.transition().duration(u).call(x),d.top+=g,p=d.left,m=d.top+("bottom"===k.orient()?h:0),ut.attr("transform",B.translation(p,m)),p=d.left+("left"===M.orient()?0:f),m=d.top,dt.attr("transform",B.translation(p,m)),ft.attr("transform",B.translation(d.left,d.top))},t.render(),w.legend.dispatch.on("legendClick",function(e,n){e.disabled=!e.disabled,F.filter(function(t){return!t.disabled}).length||F.forEach(function(t){t.disabled=!1}),f.disabled=F.map(function(t){return!!t.disabled}),e.active="inactive",e.values.forEach(function(t){t.active="inactive"}),F.filter(function(t){return"active"===t.active}).length||t.clearActive(),f.active=F.map(function(t){return!!t.active}),t.update(),g.call("stateChange",this,f)}),w.controls.dispatch.on("legendClick",function(e,n){if(e.disabled){switch(X.forEach(function(t){t.disabled=!0}),e.disabled=!1,e.key){case"Basis":x.interpolate("basis");break;case"Linear":x.interpolate("linear");break;case"Monotone":x.interpolate("monotone");break;case"Cardinal":x.interpolate("cardinal");break;case"Line":x.isArea(!1);break;case"Area":x.isArea(!0)}f.interpolate=x.interpolate(),f.isArea=x.isArea(),t.update(),g.call("stateChange",this,f)}}),g.on("tooltipShow",function(t){d&&(V&&(t.group=N[t.groupIndex]),I=A(t,c.parentNode,S))}),g.on("tooltipMove",function(t){I&&R.position(c.parentNode,I,t,"s")}),g.on("tooltipHide",function(){d&&R.cleanup()}),g.on("changeState",function(e){"undefined"!=typeof e.disabled&&(F.forEach(function(t,n){t.disabled=e.disabled[n]}),f.disabled=e.disabled),"undefined"!=typeof e.interpolate&&(x.interpolate(e.interpolate),f.interpolate=e.interpolate),"undefined"!=typeof e.isArea&&(x.isArea(e.isArea),f.isArea=e.isArea),t.update()}),g.on("chartClick",function(){w.controls.enabled()&&w.controls.dispatch.call("closeMenu",this),w.legend.enabled()&&w.legend.dispatch.call("closeMenu",this)}),x.dispatch.on("elementClick",function(e){V&&e.groupIndex&&(e.group=N[e.groupIndex]),g.call("chartClick",this),x.dispatch.call("elementMouseout",this,e),b(F,e,t,_)}),y.on("click",function(){e.event.stopPropagation(),g.call("chartClick",this)})}),t}var n={top:10,right:10,bottom:10,left:10},a=null,i=null,o="ltr",l=0,u=0,d=!0,f={},h={legend:{close:"Hide legend",open:"Show legend"},controls:{close:"Hide controls",open:"Show controls"},noData:"No Data Available.",noLabel:"undefined"},g=e.dispatch("chartClick","elementClick","tooltipShow","tooltipHide","tooltipMove","stateChange","changeState"),p=3,m=function(e,n,r,a,i){var o=r||e;return a?(i=i&&0===i.indexOf("%")?i:"%x",B.dateFormat(o,i,t.locality())):o},v=function(e,n,r,a,i,o){return B.numberFormatSIFixed(e,i,a,t.locality(),o)},y=function(e,n){var r=n.seriesLabel||"Key",a=e.series.key,i="datetime"===n.xDataType,o=n.groupName||(i?"Date":"Group"),s=e.group||{},l=e.point.x,c=m(l,e.pointIndex,s.label,i,"%x"),u="currency"===n.yDataType,d=u?"Amount":"Count",f=e.point.y,h=B.numberFormat(f,null,u,t.locality()),g,p="";return p+="<p>"+r+": <b>"+a+"</b></p>",p+="<p>"+o+": <b>"+c+"</b></p>",p+="<p>"+d+": <b>"+h+"</b></p>",e.group&&B.isNumeric(e.group._height)&&(g=Math.abs(100*f/e.group._height).toFixed(1),g=B.numberFormat(g,2,!1,t.locality()),p+="<p>Percentage: <b>"+g+"%</b></p>"),p},b=function(t,e,n,r){},x=c(),w=s(),k=r(),M=r(),I=null,A=function(t,e,n){var r=y(t,n),a=t.value<0?"n":"s";return R.show(t.e,r,a,null,e)};return x.clipEdge(!0),w.showTitle(!0).showControls(!0).showLegend(!0),x.dispatch.on("elementMouseover.tooltip",function(t){g.call("tooltipShow",this,t)}),x.dispatch.on("elementMousemove.tooltip",function(t){g.call("tooltipMove",this,t)}),x.dispatch.on("elementMouseout.tooltip",function(t){g.call("tooltipHide",this,t)}),t.dispatch=g,t.lines=x,t.legend=w.legend,t.controls=w.controls,t.xAxis=k,t.xAxisLabel=k.axisLabel,t.yAxis=M,t.yAxisLabel=M.axisLabel,t.options=B.optionsFunc.bind(t),B.rebind(t,x,"id","x","y","xScale","yScale","xDomain","yDomain","forceX","forceY","clipEdge","color","fill","classes","gradient","locality"),B.rebind(t,x,"defined","isArea","interpolate","size","clipVoronoi","useVoronoi","interactive","nice"),B.rebind(t,w,"showTitle","showControls","showLegend"),B.rebind(t,k,"rotateTicks","reduceXTicks","staggerTicks","wrapTicks"),t.colorData=function(n){var r=arguments[0],a=arguments[1]||{},i=function(t){return B.defaultColor()(t,t.seriesIndex)},o=function(t){return"sc-series sc-series-"+t.seriesIndex};switch(r){case"graduated":i=function(t){return e.interpolateHsl(e.rgb(a.c1),e.rgb(a.c2))(t.seriesIndex/a.l)};break;case"class":i=function(){return"inherit"},o=function(t){var e=t.seriesIndex,n=e*(a.step||1)%14;return n=(n>9?"":"0")+n,"sc-series sc-series-"+e+" sc-fill"+n+" sc-stroke"+n};break;case"data":i=function(t){return B.defaultColor()(t,t.seriesIndex)},o=function(t){var e=t.seriesIndex;return"sc-series sc-series-"+e+(t.classes?" "+t.classes:"")}}return x.color(i),x.fill(i),x.classes(o),w.legend.color(i),w.legend.classes(o),t},t.margin=function(e){if(!arguments.length)return n;for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);return t},t.width=function(e){return arguments.length?(a=e,t):a},t.height=function(e){return arguments.length?(i=e,t):i},t.tooltips=function(e){return arguments.length?(d=e,t):d},t.tooltipContent=function(e){return arguments.length?(y=e,t):y},t.state=function(e){return arguments.length?(f=e,g.call("stateChange",this,f),t):f},t.strings=function(e){if(!arguments.length)return h;for(var n in e)e.hasOwnProperty(n)&&(h[n]=e[n]);return w.strings(h),t},t.direction=function(e){return arguments.length?(o=e,x.direction(e),k.direction(e),M.direction(e),w.direction(e),t):o},t.duration=function(e){return arguments.length?(u=e,x.duration(e),t):u},t.delay=function(e){return arguments.length?(l=e,x.delay(e),t):l},t.xValueFormat=function(e){return arguments.length?(m=e,t):m},t.yValueFormat=function(e){return arguments.length?(v=e,t):v},t.seriesClick=function(e){return arguments.length?(b=e,t):b},t.pointRadius=function(e){return arguments.length?(p=e,t):p},t}function v(){function t(r){return r.each(function(r){function o(t){var e=t&&t.length&&t.filter(function(t){return!t.disabled&&Array.isArray(t.values)&&t.values.length}).length,r=(H-n.left-n.right)/2+n.left,a=(_-n.top-n.bottom)/2+n.top;return B.displayNoData(e,f,g.noData,r,a)}function s(t){q=t.map(function(t){return t.label}),X=q.length,Z=X>0}function l(t,n){var r=n.map(function(t){return e.select(t).datum()}),a=e.max(e.extent(r),function(t){return B.siDecimal(Math.abs(t))}),i=e.max(r,function(t){return B.countSigFigsAfter(e.formatPrefix(".2s",a)(t))});return"maxmin"===t&&at.axis&&(i=Math.max(at.axis.precision,i)),at[t]={decimal:a,precision:i},at[t]}var u=this,f=e.select(this),M=m?"multibar":"multibar-horizontal",z=r?r.properties||{}:{},N=r?r.data||null:null,H=parseInt(f.style("width"),10),_=parseInt(f.style("height"),10),O=a,V=i,W="datetime"===z.xDataType||!1,G="currency"===z.yDataType||!1,j=z.groups,Y=Array.isArray(j)&&j.length>0,q=[],X=0,Z=!1,K=[],U=0,$=0,J=A.stacked()&&m?72:32,Q=[{key:"Grouped",disabled:A.stacked()},{key:"Stacked",disabled:!A.stacked()}];if(t.update=function(){f.transition().duration(c).call(t)},t.setActiveState=function(t,e){t.active=e,t.values.forEach(function(t){t.active=e})},t.clearActive=function(e){N.forEach(function(n){t.setActiveState(n,e||"")}),delete h.active},t.cellActivate=function(e){var n=N[e.seriesIndex].values[e.pointIndex],r;n&&(r="undefined"==typeof n.active||"inactive"===n.active||""===n.active?"active":"",t.clearActive(),n.active=r)},t.seriesActivate=function(e){var n=e.series||N[e.seriesIndex],r;n&&(r="undefined"==typeof n.active||"inactive"===n.active||""===n.active?"active":"",t.clearActive("active"===r?"inactive":""),t.setActiveState(n,r),h.active=N.map(function(t){return"active"===t.active}))},t.dataSeriesActivate=function(e){var n=e.series||N[e.seriesIndex],r;n&&(r="undefined"==typeof n.active||"inactive"===n.active||""===n.active?"active":"inactive","active"===r?t.seriesActivate(e):t.clearActive())},t.container=this,o(N))return t;if(N.forEach(function(t,n){t._values||(t._values=t.values.map(function(t,e){var n={x:t.x,y:t.y};return t.label&&(n.label=t.label),t.active&&(n.active=t.active),n})),t.seriesIndex=n,t.key=t.key||g.noLabel,t.total=e.sum(t._values,function(t,e){return t.y}),t.disabled=t.disabled||0===t.total}),K=N.filter(function(t){return!t.disabled}).map(function(t,e){return t.seri=e,t.values=t._values.map(function(n,r){var a={x:n.x,y:n.y,active:n.active||""};return"undefined"!=typeof n.label&&(a.label=n.label),a.groupIndex=r,a.seriesIndex=t.seriesIndex,a.seri=t.seri,a.color=t.color||"",a.y0=n.y+(e>0?N[t.seriesIndex-1]._values[r].y0:0),a}),t}),U=K.length,o(K))return t;if(Y?j.forEach(function(t,e){var n="undefined"==typeof t.label||""===t.label?g.noLabel:W?B.isNumeric(t.label)||-1!==t.label.indexOf("GMT")?new Date(t.label):new Date(t.label+" GMT"):t.label;t.group=e,t.label=n,t.total=0,t._height=0}):j=K[0].values.map(function(t,e){return{group:e,label:W?new Date(t.x):t.x,total:0,_height:0}}),j.forEach(function(t,e){K.forEach(function(n,r){n.values.filter(function(t,n){return t.groupIndex===e}).forEach(function(e,n){t.total+=e.y,t._height+=Math.abs(e.y)})})}),s(j),y&&(s(j.filter(function(t,e){return 0!==t._height})),K.forEach(function(t,e){return t.values=t.values.filter(function(t,e){return 0!==j[e]._height}).map(function(t,e){return t}),t}),o(K)))return t;$=e.sum(j,function(t){return t.total});var tt=75,et=null,nt=null,rt=null,at={axis:null,maxmin:null};W&&(et=B.getDateFormatUTC(q)),A.valueFormat(function(t,e){return x(t,e,null,G,0)}),nt=function(t,e,n,r){var a=q[e],i=w(t,e,a,W,et);return"no-ellipsis"===r?i:B.stringEllipsify(i,f,tt)},rt=function(t,e,n,r){var a=at[r]||l(r,n);return k(t,e,null,G,a.precision,a.decimal)},h.disabled=K.map(function(t){return!!t.disabled}),h.active=K.map(function(t){return"active"===t.active}),h.stacked=A.stacked(),C.chart(t).title(z.title).controlsData(Q).legendData(N),S.orient(m?"bottom":"left").scale(A.xScale()).valueFormat(nt).tickSize(0).tickPadding(4).highlightZero(!1).showMaxMin(!1),F.orient(m?"left":"bottom").scale(A.yScale()).valueFormat(rt).tickPadding(4).showMaxMin(!0);var it=f.selectAll("g.sc-chart-wrap").data([K]),ot=it.enter().append("g").attr("class","sc-chart-wrap sc-chart-"+M),st=f.select(".sc-chart-wrap").merge(ot);ot.append("defs");var lt=st.select("defs");ot.append("g").attr("class","sc-background-wrap");var ct=st.select(".sc-background-wrap");ot.append("g").attr("class","sc-title-wrap"),ot.append("g").attr("class","sc-axis-wrap sc-axis-y");var ut=st.select(".sc-axis-wrap.sc-axis-y");ot.append("g").attr("class","sc-scroll-wrap");var dt=st.select(".sc-scroll-wrap");ot.select(".sc-scroll-wrap").append("g").attr("class","sc-axis-wrap sc-axis-x");var ft=st.select(".sc-axis-wrap.sc-axis-x");ot.select(".sc-scroll-wrap").append("g").attr("class","sc-bars-wrap");var ht=st.select(".sc-bars-wrap");ot.append("g").attr("class","sc-controls-wrap"),ot.append("g").attr("class","sc-legend-wrap"),st.attr("transform",B.translation(n.left,n.top)),v?T(st,ot,dt,S):ot.select(".sc-background-wrap").append("rect").attr("class","sc-background").attr("x",-n.left).attr("y",-n.top).attr("fill","#FFF"),t.render=function(){function t(t){return"width"===t?m&&v?Math.max(g,E):g:"height"===t?!m&&v?Math.max(y,E):y:0}function e(){z=S.margin(),P=F.margin(),d.left=Math.max(z.left,P.left),d.right=Math.max(z.right,P.right),d.top=Math.max(z.top,P.top),d.bottom=Math.max(z.bottom,P.bottom),r()}function r(){g=O-d.left-d.right,y=V-x-d.top-d.bottom,A.resetDimensions(t("width"),t("height"))}function o(){F.ticks(y/48).tickSize(m?-g:-y,0).margin(d),ut.call(F),e()}function s(){S.tickSize(0).margin(d),ft.call(S),e()}var l,u,d,g,y,x,w=0,k=0;H=parseInt(f.style("width"),10),_=parseInt(f.style("height"),10),l=a||H||960,u=i||_||400,O=l-n.left-n.right,V=u-n.top-n.bottom,d={top:0,right:0,bottom:0,left:0},g=O-d.left-d.right,y=V-d.top-d.bottom,ct.select(".sc-background").attr("width",l).attr("height",u);var M=h.stacked?J:J*U+J,I=J*(h.stacked?.25:1),E=X*M+I;tt=Math.max(m?2*J:.2*O,75),C.width(O).height(V),f.call(C),x=C.getHeight(),d.top+=x,y=V-d.top-d.bottom,A.vertical(m).baseDimension(J).disabled(N.map(function(t){return t.disabled})).width(t("width")).height(t("height")),ht.datum(K).call(A);var P={top:0,right:0,bottom:0,left:0},z={top:0,right:0,bottom:0,left:0};if(o(),s(),o(),s(),o(),ht.transition().duration(c).call(A),d.top+=x,w=m||"left"===S.orient()?0:g,k=m&&"bottom"===S.orient()?y+2:-2,ft.attr("transform",B.translation(w,k)),w=d.left+(m||"bottom"===F.orient()?0:g),k=d.top+(m||"left"===F.orient()?0:y),ut.attr("transform",B.translation(w,k)),dt.attr("transform",B.translation(d.left,d.top)),v){D=E>(m?g:y),ft.select(".sc-axislabel").attr("x",(m?g:-y)/2);var R=(m?g:y)-E,W=function(){var t;p.call("tooltipHide",this),L=T.pan(R),t=m?g-2*L:2*L-y,t/=2,ft.select(".sc-axislabel").attr("x",t)};T.enable(D).width(g).height(y).margin(d).minDimension(E).vertical(m).panHandler(W).resize(L,b),T.panHandler()()}},t.render(),C.legend.dispatch.on("legendClick",function(e,n){e.disabled=!e.disabled,N.filter(function(t){return!t.disabled}).length||N.forEach(function(t){t.disabled=!1}),h.disabled=N.map(function(t){return!!t.disabled}),e.active="inactive",e.values.forEach(function(t){t.active="inactive"}),N.filter(function(t){return"active"===t.active}).length||t.clearActive(),h.active=N.map(function(t){return!!t.active}),t.update(),p.call("stateChange",this,h)}),C.controls.dispatch.on("legendClick",function(e,n){e.disabled&&(Q.forEach(function(t){t.disabled=!0}),e.disabled=!1,A.stacked("Grouped"===e.key?!1:!0),h.stacked=A.stacked(),t.update(),p.call("stateChange",this,h))}),p.on("tooltipShow",function(t){d&&(Z&&(t.group=j[t.groupIndex]),E=P(t,u.parentNode,z))}),p.on("tooltipMove",function(t){E&&R.position(u.parentNode,E,t,m?"s":"w")}),p.on("tooltipHide",function(){d&&R.cleanup()}),p.on("changeState",function(e){"undefined"!=typeof e.disabled&&(N.forEach(function(t,n){t.disabled=e.disabled[n]}),h.disabled=e.disabled),"undefined"!=typeof e.active&&(N.forEach(function(t,n){t.active=e.active[n]?"active":"inactive",t.values.forEach(function(e){e.active=t.active})}),h.active=e.active,N.filter(function(t){return"active"===t.active}).length||t.clearActive()),"undefined"!=typeof e.stacked&&(A.stacked(e.stacked),h.stacked=e.stacked),t.update()}),p.on("chartClick",function(){C.controls.enabled()&&C.controls.dispatch.call("closeMenu",this),C.legend.enabled()&&C.legend.dispatch.call("closeMenu",this)}),A.dispatch.on("elementClick",function(e){Z&&e.groupIndex&&(e.group=j[e.groupIndex]),p.call("chartClick",this),I(N,e,t,q)}),f.on("click",function(){e.event.stopPropagation(),p.call("chartClick",this)})}),t}var n={top:10,right:10,bottom:10,left:10},a=null,i=null,o="ltr",l=0,c=0,d=!0,h={},g={legend:{close:"Hide legend",open:"Show legend"},controls:{close:"Hide controls",open:"Show controls"},noData:"No Data Available.",noLabel:"undefined"},p=e.dispatch("chartClick","elementClick","tooltipShow","tooltipHide","tooltipMove","stateChange","changeState"),m=!0,v=!0,y=!0,b=function(t){},x=function(e,n,r,a,i){return B.numberFormatSI(e,i,a,t.locality())},w=function(e,n,r,a,i){var o=r||e;return a?(i=i&&0===i.indexOf("%")?i:"%x",B.dateFormat(o,i,t.locality())):o},k=function(e,n,r,a,i,o){return B.numberFormatSIFixed(e,i,a,t.locality(),o)},M=function(e,n){var r=n.seriesLabel||"Key",a=e.series.key,i="datetime"===n.xDataType,o=n.groupName||(i?"Date":"Group"),s=e.group||{},l=e.point.x,c=w(l,e.pointIndex,s.label,i,"%x"),u="currency"===n.yDataType,d=u?"Amount":"Count",f=e.point.y,h=B.numberFormat(f,null,u,t.locality()),g,p="";return p+="<p>"+r+": <b>"+a+"</b></p>",p+="<p>"+o+": <b>"+c+"</b></p>",p+="<p>"+d+": <b>"+h+"</b></p>",e.group&&B.isNumeric(e.group._height)&&(g=Math.abs(100*f/e.group._height).toFixed(1),g=B.numberFormat(g,2,!1,t.locality()),p+="<p>Percentage: <b>"+g+"%</b></p>"),p},I=function(t,e,n,r){},A=u(),C=s(),S=r(),F=r(),D=!1,L=0,T=f().id(A.id()),E=null,P=function(t,e,n){var r=M(t,n),a=t.value<0?m?"n":"e":m?"s":"w";return R.show(t.e,r,a,null,e)};return C.showTitle(!0).showControls(!0).showLegend(!0),A.dispatch.on("elementMouseover.tooltip",function(t){p.call("tooltipShow",this,t)}),A.dispatch.on("elementMousemove.tooltip",function(t){p.call("tooltipMove",this,t)}),A.dispatch.on("elementMouseout.tooltip",function(t){p.call("tooltipHide",this,t)}),t.dispatch=p,t.multibar=A,t.legend=C.legend,t.controls=C.controls,t.xAxis=S,t.xAxisLabel=S.axisLabel,t.yAxis=F,t.yAxisLabel=F.axisLabel,t.options=B.optionsFunc.bind(t),B.rebind(t,A,"id","x","y","xScale","yScale","xDomain","yDomain","forceX","forceY","clipEdge","color","fill","classes","gradient","locality"),B.rebind(t,A,"stacked","showValues","valueFormat","nice","textureFill"),B.rebind(t,C,"showTitle","showControls","showLegend"),B.rebind(t,S,"rotateTicks","reduceXTicks","staggerTicks","wrapTicks"),t.colorData=function(n){var r=arguments[0],a=arguments[1]||{},i=function(t){return B.defaultColor()(t,t.seriesIndex)},o=function(t){return"sc-series sc-series-"+t.seriesIndex};switch(r){case"graduated":i=function(t){return e.interpolateHsl(e.rgb(a.c1),e.rgb(a.c2))(t.seriesIndex/a.l)};break;case"class":i=function(){return"inherit"},o=function(t){var e=t.seriesIndex,n=e*(a.step||1)%14;return n=(n>9?"":"0")+n,"sc-series sc-series-"+e+" sc-fill"+n+" sc-stroke"+n};break;case"data":i=function(t){return B.defaultColor()(t,t.seriesIndex)},o=function(t){return"sc-series sc-series-"+t.seriesIndex+(t.classes?" "+t.classes:"")}}var s=a.gradient?function(t){var e={orientation:a.orientation||(m?"vertical":"horizontal"),position:a.position||"middle"};return A.gradientFill(t,t.seriesIndex,e)}:i;return A.color(i),A.fill(s),A.classes(o),C.legend.color(i),C.legend.classes(o),t},t.margin=function(e){if(!arguments.length)return n;for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);return t},t.width=function(e){return arguments.length?(a=e,t):a},t.height=function(e){return arguments.length?(i=e,t):i},t.tooltips=function(e){return arguments.length?(d=e,t):d},t.tooltipContent=function(e){return arguments.length?(M=e,t):M},t.state=function(e){return arguments.length?(h=e,p.call("stateChange",this,h),t):h},t.strings=function(e){if(!arguments.length)return g;for(var n in e)e.hasOwnProperty(n)&&(g[n]=e[n]);return C.strings(g),t},t.direction=function(e){return arguments.length?(o=e,A.direction(e),S.direction(e),F.direction(e),C.direction(e),t):o},t.duration=function(e){return arguments.length?(c=e,A.duration(e),t):c},t.delay=function(e){return arguments.length?(l=e,A.delay(e),t):l},t.xValueFormat=function(e){return arguments.length?(w=e,t):w},t.yValueFormat=function(e){return arguments.length?(k=e,t):k},t.seriesClick=function(e){return arguments.length?(I=e,
t):I},t.vertical=function(e){return arguments.length?(m=e,t):m},t.allowScroll=function(e){return arguments.length?(v=e,t):v},t.hideEmptyGroups=function(e){return arguments.length?(y=e,t):y},t.overflowHandler=function(e){return arguments.length?(b=B.functor(e),t):b},t}function y(){function t(r){return r.each(function(r){function o(t){var e=t&&t.length&&t.filter(function(t){return t.values&&t.values.length}).length,r=(x-n.left-n.right)/2+n.left,a=(P-n.top-n.bottom)/2+n.top;return B.displayNoData(e,u,v.noData,r,a)}var c=this,u=e.select(this),h="pareto",g=r?r.properties||{}:{},p=r?r.data||null:null,x=parseInt(u.style("width"),10),P=parseInt(u.style("height"),10),z=Math.pow(6,2)*Math.PI,N="datetime"===g.xDataType||!1,V="currency"===g.yDataType||!1,W=A.stacked()?72:32,G=function(t,e,n,r){var a=U&&Array.isArray(U)?U[e]||t:t,i=k(t,e,a,N),o=Math.max(2*W,75);return r?i:B.stringEllipsify(i,u,o)},j=function(t,e,n,r){return M(t,e,null,V)},Y,q;if(t.update=function(){u.transition().call(t)},t.container=this,o(p))return t;t.dataSeriesActivate=function(e){var n=e.series;n.active=n.active&&"inactive"!==n.active?"inactive":"active",n.values.map(function(t){t.active=n.active}),"active"===n.active&&p.filter(function(t){return"active"!==t.active}).map(function(t){return t.active="inactive",t.values.map(function(t){t.active="inactive"}),t}),p.filter(function(t){return"active"===t.active}).length||p.map(function(t){return t.active="",t.values.map(function(t){t.active=""}),u.selectAll(".sc-series").classed("sc-inactive",!1),t}),u.call(t)},p.forEach(function(t,e){t._values||(t._values=t.values.map(function(t,e){return{x:Array.isArray(t)?t[0]:t.x,y:Array.isArray(t)?t[1]:t.y}}))});var X=p.filter(function(t){return!t.type||"bar"===t.type}).map(function(t,e){return t.seriesIndex=e,t.values=t._values.map(function(n,r){return{group:r,seriesIndex:t.seriesIndex,color:"undefined"!=typeof t.color?t.color:"",x:A.x()(n,r),y:A.y()(n,r),y0:n.y+(e>0?p[t.seriesIndex-1].values[r].y0:0),active:"undefined"!=typeof t.active?t.active:""}}),t}).filter(function(t){return!t.disabled}).map(function(t,e){return t.seri=e,t.values.forEach(function(e,n){e.seri=t.seri}),t});X=X.length?X:[{values:[]}];var Z=p.filter(function(t){return"line"===t.type}).map(function(t,e){return t.seriesIndex=e,A.stacked()?(t.values.forEach(function(t){t.y=0}),X.map(function(e){e.values.map(function(e,n){t.values[n].y+=A.y()(e,n)})}),t.values.forEach(function(e,n){n>0&&(e.y+=t.values[n-1].y)})):t.values=t._values.map(function(e,n){return{seriesIndex:t.seriesIndex,color:"undefined"!=typeof t.color?t.color:"",x:S.x()(e,n)+.25*(t.seriesIndex-n),y:S.y()(e,n)}}),t}).filter(function(t){return!t.disabled}).map(function(t,e){return t.seri=e,t.values.forEach(function(e,n){e.seri=t.seri}),t});Z=Z.length?Z:[{values:[]}];var K=g.groupData,U=K.map(function(t){return[].concat(t.l)[0]||v.noLabel}),$=g.quota||0,J=g.quotaLabel||"",Q=g.targetQuota||0,tt=g.targetQuotaLabel||"",et=p.filter(function(t){return!t.type||"bar"===t.type}),nt=p.filter(function(t){return"line"===t.type});nt.push({key:J,type:"dash",color:"#444",seriesIndex:nt.length,values:{seriesIndex:nt.length,x:0,y:0}}),Q>0&&nt.push({key:tt,type:"dash",color:"#777",seriesIndex:nt.length,values:{seriesIndex:nt.length+1,x:0,y:0}});var rt=p.filter(function(t){return!t.disabled}).map(function(t){return t._values.map(function(t,e){return y(t,e)})}),at=p.map(function(t){return t._values.map(function(t,e){return b(t,e)})});s=s&&g.title&&g.title.length,Y=A.xScale(),q=A.yScale(),F.orient("bottom").scale(Y).valueFormat(G).tickSize(0).tickPadding(4).highlightZero(!1).showMaxMin(!1),D.orient("left").scale(q).valueFormat(j).tickPadding(7).showMaxMin(!0),t.render=function(){function r(){M.left=Math.max(bt,vt.left,yt.left),M.right=Math.max(vt.right,yt.right),M.top=Math.max(vt.top,yt.top)+W,M.bottom=Math.max(vt.bottom,yt.bottom),o()}function o(){N=b-M.left-M.right,H=k-M.top-M.bottom,A.resetDimensions(N,H)}x=parseInt(u.style("width"),10),P=parseInt(u.style("height"),10);var m,y,b,k,M,N,H;m=a||x||960,y=i||P||400,b=m-n.left-n.right,k=y-n.top-n.bottom,M={top:0,right:0,bottom:0,left:0},H=k-M.top-M.bottom,N=b-M.left-M.right;var R=0,O=0,V=0,W=0,G={width:0,height:0},j=u.selectAll("g.sc-chart-wrap").data([p]),K=j.enter().append("g").attr("class","sc-chart-wrap sc-chart-"+h),U=u.select(".sc-chart-wrap").merge(K);K.append("defs"),K.append("g").attr("class","sc-background-wrap");var rt=U.select(".sc-background-wrap");K.append("g").attr("class","sc-title-wrap");var it=U.select(".sc-title-wrap");K.append("g").attr("class","sc-axis-wrap sc-axis-x");var ot=U.select(".sc-axis-wrap.sc-axis-x");K.append("g").attr("class","sc-axis-wrap sc-axis-y");var st=U.select(".sc-axis-wrap.sc-axis-y");K.append("g").attr("class","sc-bars-wrap");var lt=U.select(".sc-bars-wrap");K.append("g").attr("class","sc-quota-wrap");var ct=U.select(".sc-quota-wrap");K.append("g").attr("class","sc-lines-wrap1");var ut=U.select(".sc-lines-wrap1");K.append("g").attr("class","sc-lines-wrap2");var dt=U.select(".sc-lines-wrap2");K.append("g").attr("class","sc-legend-wrap sc-bar-legend");var ft=U.select(".sc-legend-wrap.sc-bar-legend");K.append("g").attr("class","sc-legend-wrap sc-line-legend");var ht=U.select(".sc-legend-wrap.sc-line-legend");U.attr("transform",B.translation(n.left,n.top)),K.select(".sc-background-wrap").append("rect").attr("x",-n.left).attr("y",-n.top).attr("width",m).attr("height",y).attr("fill","#FFF"),it.select(".sc-title").remove(),s&&(it.append("text").attr("class","sc-title").attr("x","rtl"===d?b:0).attr("y",0).attr("dy",".75em").attr("text-anchor","start").attr("stroke","none").attr("fill","black").text(g.title),G=B.getTextBBox(it.select(".sc-title")),W+=G.height),l&&(L.id("barlegend_"+t.id()).strings(v.barlegend).align("left").height(k-M.top),ft.datum(et).call(L),R=L.calcMaxWidth(),T.id("linelegend_"+t.id()).strings(v.linelegend).align("right").height(k-M.top),ht.datum(nt).call(T),O=T.calcMaxWidth(),V=b/(R+O),L.arrange(Math.floor(V*R)),T.arrange(Math.floor(V*O)),ft.attr("transform","translate("+("rtl"===d?b-L.width():0)+","+M.top+")"),ht.attr("transform","translate("+("rtl"===d?0:b-T.width())+","+M.top+")")),W+=Math.max(L.height(),T.height())+4,H=k-W-M.top-M.bottom;var gt=Math.max(e.max(e.merge(at)),$,Q||0),pt=[0,10*Math.ceil(.1*gt)];A.width(N).height(H).forceY(pt).id(t.id()),lt.datum(X).call(A);var mt=Y(1)+Y.bandwidth()/(A.stacked()||1===Z.length?2:4);C.margin({top:0,right:mt,bottom:0,left:mt}).width(N).height(H).forceY(pt).useVoronoi(!1).id("outline_"+t.id()),S.margin({top:0,right:mt,bottom:0,left:mt}).width(N).height(H).forceY(pt).useVoronoi(!1).size(z).sizeRange([z,z]).sizeDomain([z,z]).id("foreground_"+t.id()),ut.datum(Z).call(C),dt.datum(Z).call(S),ot.call(F),st.style("opacity",X.length?1:0).call(D);var vt=F.margin(),yt=D.margin(),bt=0,xt=14;ct.selectAll("line").remove(),st.selectAll("text.sc-quota-value").remove(),st.selectAll("text.sc-target-quota-value").remove(),Q>0&&(ct.append("line").attr("class","sc-quota-target").attr("x1",0).attr("y1",0).attr("x2",N).attr("y2",0).attr("transform","translate(0,"+q(Q)+")").style("stroke-dasharray","8, 8"),ct.append("line").datum({key:tt,val:Q}).attr("class","sc-quota-target sc-quota-background").attr("x1",0).attr("y1",0).attr("x2",N).attr("y2",0).attr("transform","translate(0,"+q(Q)+")"),st.append("text").text(I(Q,2,!0)).attr("class","sc-target-quota-value").attr("dy",".36em").attr("dx","0").attr("text-anchor","rtl"===d?"start":"end").attr("transform","translate("+(0-D.tickPadding())+","+q(Q)+")"),bt=Math.round(U.select("text.sc-target-quota-value").node().getBoundingClientRect().width+D.tickPadding())),$>0&&(ct.append("line").attr("class","sc-quota-line").attr("x1",0).attr("y1",0).attr("x2",N).attr("y2",0).attr("transform","translate(0,"+q($)+")").style("stroke-dasharray","8, 8"),ct.append("line").datum({key:J,val:$}).attr("class","sc-quota-line sc-quota-background").attr("x1",0).attr("y1",0).attr("x2",N).attr("y2",0).attr("transform","translate(0,"+q($)+")"),st.append("text").text(I($,2,!0)).attr("class","sc-quota-value").attr("dy",".36em").attr("dx","0").attr("text-anchor","rtl"===d?"start":"end").attr("transform","translate("+-D.tickPadding()+","+q($)+")"),bt=Math.max(bt,Math.round(U.select("text.sc-quota-value").node().getBoundingClientRect().width+D.tickPadding()))),r(),A.width(N).height(H),lt.call(A),ot.call(F),st.call(D),mt=Y(1)+Y.bandwidth()/(A.stacked()?2:2*Z.length),vt=F.margin(),yt=D.margin(),r();var wt=B.translation(M.left,M.top);A.width(N).height(H),lt.attr("transform",wt).call(A),C.margin({top:0,right:mt,bottom:0,left:mt}).width(N).height(H),S.margin({top:0,right:mt,bottom:0,left:mt}).width(N).height(H),ut.attr("transform",wt).call(C),dt.attr("transform",wt).call(S),ct.attr("transform",wt).selectAll("line").attr("x2",N),ot.attr("transform","translate("+M.left+","+("bottom"===F.orient()?H+M.top:M.top)+")").call(F),D.ticks(Math.ceil(H/48)).tickSize(-N,0),st.attr("transform","translate("+("left"===D.orient()?M.left:M.left+N)+","+M.top+")").call(D),Q>0&&(ct.selectAll("line.sc-quota-target").attr("x2",N).attr("transform","translate(0,"+q(Q)+")"),st.select("text.sc-target-quota-value").attr("transform","translate("+(0-D.tickPadding())+","+q(Q)+")"),xt=Math.round(parseInt(U.select("text.sc-target-quota-value").node().getBoundingClientRect().height,10)/1.15),st.selectAll("g.tick, g.sc-axisMaxMin").each(function(t,n){Math.abs(q(t)-q(Q))<=xt&&e.select(this).style("opacity",0)})),$>0&&(ct.selectAll("line.sc-quota-line").attr("x2",N).attr("transform","translate(0,"+q($)+")"),st.select("text.sc-quota-value").attr("transform","translate("+(0-D.tickPadding())+","+q($)+")"),xt=Math.round(parseInt(U.select("text.sc-quota-value").node().getBoundingClientRect().height,10)/1.15),st.selectAll("g.tick, g.sc-axisMaxMin").each(function(t,n){Math.abs(q(t)-q($))<=xt&&e.select(this).style("opacity",0)}),Q>0&&Math.abs(q($)-q(Q))<=xt&&st.select(".sc-target-quota-value").style("opacity",0)),ct.selectAll("line.sc-quota-background").on("mouseover",function(t){if(f){var n={val:t.val,key:t.key,e:e.event};E=_(n,c.parentNode)}}).on("mousemove",function(){var t=e.event;w.call("tooltipMove",this,t)}).on("mouseout",function(){w.call("tooltipHide",this)})},t.render(),L.dispatch.on("legendClick",function(e,n){var r=e.seriesIndex;e.disabled=!e.disabled,t.stacked()||p.filter(function(t){return t.seriesIndex===r&&"line"===t.type}).map(function(t){return t.disabled=!t.disabled,t}),p.filter(function(t){return!t.disabled&&"bar"===t.type}).length||p.map(function(t){return t.disabled=!1,t}),u.call(t)}),w.on("tooltipShow",function(t){f&&(E=H(t,c.parentNode,K))}),w.on("tooltipMove",function(t){E&&R.position(c.parentNode,E,t,"s")}),w.on("tooltipHide",function(){f&&R.cleanup()}),w.on("changeState",function(e){"undefined"!=typeof e.disabled&&(p.forEach(function(t,n){t.disabled=e.disabled[n]}),m.disabled=e.disabled),"undefined"!=typeof e.stacked&&(A.stacked(e.stacked),m.stacked=e.stacked),u.transition().call(t)}),w.on("chartClick",function(){L.enabled()&&L.dispatch.call("closeMenu",this),T.enabled()&&T.dispatch.call("closeMenu",this)}),A.dispatch.on("elementClick",function(e){w.call("chartClick",this),O(p,e,t,u)})}),t}var n={top:10,right:10,bottom:10,left:10},a=null,i=null,s=!1,l=!0,d="ltr",f=!0,h=!1,g=0,p=0,m={},v={barlegend:{close:"Hide bar legend",open:"Show bar legend"},linelegend:{close:"Hide line legend",open:"Show line legend"},controls:{close:"Hide controls",open:"Show controls"},noData:"No Data Available.",noLabel:"undefined"},y=function(t){return t.x},b=function(t){return t.y},x=B.buildLocality(),w=e.dispatch("chartClick","tooltipShow","tooltipHide","tooltipMove","stateChange","changeState"),k=function(e,n,r,a){return a?B.dateFormat(r,"%x",t.locality()):r},M=function(e,n,r,a){var i=2;return B.numberFormatSI(e,i,a,t.locality())},I=M,A=u().stacked(!0).clipEdge(!1).withLine(!0).nice(!1),C=c().color(function(t,e){return"#FFF"}).fill(function(t,e){return"#FFF"}).useVoronoi(!1).nice(!1),S=c().useVoronoi(!1).color("data").nice(!1),F=r(),D=r(),L=o().align("left").position("middle"),T=o().align("right").position("middle"),E=null,P=function(t,e,n,r,a){return"<p><b>"+t+"</b></p><p><b>"+n+"</b></p><p><b>"+e+"%</b></p>"},z=function(t,e,n,r,a){return"<p><p>"+t+": <b>"+n+"</b></p>"},N=function(t,e,n,r,a){return"<p>"+r.key+": <b>"+n+"</b></p>"},H=function(e,n,r){var a=e.series.key,i=(100*e.point.y/r[e.pointIndex].t).toFixed(1),o=S.y()(e.point,e.pointIndex),s="bar"===e.series.type?P(a,i,o,e,t):z(a,i,o,e,t);return R.show(e.e,s,"s",null,n)},_=function(e,n){var r=N(e.key,0,e.val,e,t);return R.show(e.e,r,"s",null,n)},O=function(t,e,n,r){};return S.dispatch.on("elementMouseover.tooltip",function(t){w.call("tooltipShow",this,t)}),S.dispatch.on("elementMousemove.tooltip",function(t){w.call("tooltipMove",this,t)}),S.dispatch.on("elementMouseout.tooltip",function(){w.call("tooltipHide",this)}),A.dispatch.on("elementMouseover.tooltip",function(t){w.call("tooltipShow",this,t)}),A.dispatch.on("elementMousemove.tooltip",function(t){w.call("tooltipMove",this,t)}),A.dispatch.on("elementMouseout.tooltip",function(){w.call("tooltipHide",this)}),t.dispatch=w,t.linesBackground=C,t.lines=S,t.multibar=A,t.barLegend=L,t.lineLegend=T,t.xAxis=F,t.xAxisLabel=F.axisLabel,t.yAxis=D,t.yAxisLabel=D.axisLabel,t.options=B.optionsFunc.bind(t),B.rebind(t,A,"id","xScale","yScale","xDomain","yDomain","forceY","color","fill","classes","gradient"),B.rebind(t,A,"stacked","showValues","valueFormat","nice","textureFill"),B.rebind(t,F,"rotateTicks","staggerTicks","wrapTicks","reduceXTicks"),t.colorData=function(n){var r=arguments[0],a=arguments[1]||{},i=function(t){return B.defaultColor()(t,t.seriesIndex)},o=function(t,e){return"sc-series sc-series-"+t.seriesIndex},s=function(t,n){var r=a.lineColor?a.lineColor:{c1:"#1A8221",c2:"#62B464",l:1};return t.color||e.interpolateHsl(e.rgb(r.c1),e.rgb(r.c2))(t.seriesIndex/2)},l=function(t,e){return"sc-series sc-series-"+t.seriesIndex};switch(r){case"graduated":i=function(t){return e.interpolateHsl(e.rgb(a.barColor.c1),e.rgb(a.barColor.c2))(t.seriesIndex/a.barColor.l)};break;case"class":i=function(){return"inherit"},o=function(t){var e=t.seriesIndex,n=e*(a.step||1)%14;return n=(n>9?"":"0")+n,"sc-series sc-series-"+e+" sc-fill"+n},l=function(t){var e=t.seriesIndex,n=e*(a.step||1)%14;return n=(n>9?"":"0")+n,"sc-series sc-series-"+e+" sc-fill"+n+" sc-stroke"+n};break;case"data":i=function(t){return t.classes?"inherit":t.color||B.defaultColor()(t,t.seriesIndex)},o=function(t){return"sc-series sc-series-"+t.seriesIndex+(t.classes?" "+t.classes:"")},l=function(t){return"sc-series sc-series-"+t.seriesIndex+(t.classes?" "+t.classes:"")}}var c=a.gradient?function(t){var e={orientation:a.orientation||"vertical",position:a.position||"middle"};return A.gradientFill(t,t.seriesIndex,e)}:i;return A.color(i),A.fill(c),A.classes(o),S.color(s),S.fill(s),S.classes(l),L.color(i),L.classes(o),T.color(s),T.classes(l),t},t.x=function(e){return arguments.length?(y=e,S.x(e),A.x(e),t):y},t.y=function(e){return arguments.length?(b=e,S.y(e),A.y(e),t):b},t.margin=function(e){if(!arguments.length)return n;for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);return t},t.width=function(e){return arguments.length?(a=e,t):a},t.height=function(e){return arguments.length?(i=e,t):i},t.showTitle=function(e){return arguments.length?(s=e,t):s},t.showLegend=function(e){return arguments.length?(l=e,t):l},t.tooltipBar=function(e){return arguments.length?(P=e,t):P},t.tooltipLine=function(e){return arguments.length?(z=e,t):z},t.tooltipQuota=function(e){return arguments.length?(N=e,t):N},t.tooltips=function(e){return arguments.length?(f=e,t):f},t.clipEdge=function(e){return arguments.length?(h=e,A.clipEdge(e),C.clipEdge(e),S.clipEdge(e),t):h},t.state=function(e){return arguments.length?(m=e,t):m},t.strings=function(e){if(!arguments.length)return v;for(var n in e)e.hasOwnProperty(n)&&(v[n]=e[n]);return L.strings(v.barlegend),T.strings(v.linelegend),t},t.direction=function(e){return arguments.length?(d=e,A.direction(e),F.direction(e),D.direction(e),L.direction(e),T.direction(e),t):d},t.duration=function(e){return arguments.length?(p=e,A.duration(e),C.duration(e),S.duration(e),t):p},t.delay=function(e){return arguments.length?(g=e,A.delay(e),C.delay(e),S.delay(e),t):g},t.seriesClick=function(e){return arguments.length?(O=e,t):O},t.colorFill=function(e){return t},t.xValueFormat=function(e){return arguments.length?(k=e,t):k},t.yValueFormat=function(e){return arguments.length?(M=e,t):M},t.quotaValueFormat=function(e){return arguments.length?(I=e,t):I},t.locality=function(e){return arguments.length?(x=B.buildLocality(e),A.locality(e),C.locality(e),t):x},t}function b(){function t(i){return i.each(function(i){function o(t){var e=t&&t.length,r=(I-n.left-n.right)/2+n.left,a=(A-n.top-n.bottom)/2+n.top;return B.displayNoData(e,d,h.noData,r,a)}var s=this,d=e.select(this),b="pie",k=i?i.properties||{}:{},M=i?i.data||null:null,I=parseInt(d.style("width"),10),A=parseInt(d.style("height"),10),C="datetime"===k.xDataType||!1,S="currency"===k.yDataType||!1;if(t.update=function(){d.transition().duration(l).call(t)},t.container=this,o(M))return t;t.setActiveState=function(t,e){t.active=e},t.clearActive=function(e){M.forEach(function(n){t.setActiveState(n,e||"")}),delete u.active},t.seriesActivate=function(e){var n=e.series||M[e.seriesIndex],r;n&&(f?(r="undefined"==typeof n.active||"inactive"===n.active||""===n.active?"active":"",t.clearActive("active"===r?"inactive":""),t.setActiveState(n,r),u.active=M.map(function(t){return"active"===t.active})):t.dataSeriesActivate({series:n}))},t.dataSeriesActivate=function(e){var n=e.series;n.active=n.active&&"inactive"!==n.active?"inactive":"active","active"===n.active&&M.filter(function(t){return"active"!==t.active}).forEach(function(t){return t.active="inactive",t}),M.filter(function(t){return"active"===t.active}).length||t.clearActive()},M.forEach(function(t,n){t.seriesIndex=n,t.values||(t.value?isNaN(t.value)||(t.values=[{x:0,y:parseInt(t.value,10)}]):t.values=[]),t.values.forEach(function(e,r){e.index=n,e.series=t,"undefined"==typeof e.value&&(e.value=e.y)}),t.key=t.key||h.noLabel,t.value=t.value||e.sum(t.values,function(t){return t.value}),t.count=t.count||t.values.length,t.disabled=t.disabled||0===t.value});var F=M.filter(function(t){return!t.disabled});if(F.length||(F=[{values:[]}]),k.count=e.sum(F,function(t){return t.count}),k.total=e.sum(F,function(t){return t.value}),u.disabled=M.map(function(t){return!!t.disabled}),!k.total)return o(),t;m.chart(t).title(k.title).controlsData(v).legendData(M);var D=d.selectAll("g.sc-chart-wrap").data([F]),L=D.enter().append("g").attr("class","sc-chart-wrap sc-chart-"+b),T=d.select(".sc-chart-wrap").merge(L);L.append("defs");var E=T.select("defs");L.append("g").attr("class","sc-background-wrap");var P=T.select(".sc-background-wrap");L.append("g").attr("class","sc-title-wrap"),L.append("g").attr("class","sc-"+b+"-wrap");var z=T.select(".sc-"+b+"-wrap");L.append("g").attr("class","sc-controls-wrap"),L.append("g").attr("class","sc-legend-wrap"),T.attr("transform",B.translation(n.left,n.top)),L.select(".sc-background-wrap").append("rect").attr("class","sc-background").attr("x",-n.left).attr("y",-n.top).attr("fill","#FFF"),t.render=function(){var t,e,i,o,s,c,u,f;I=parseInt(d.style("width"),10),A=parseInt(d.style("height"),10),t=r||I||960,e=a||A||400,i=t-n.left-n.right,o=e-n.top-n.bottom,s={top:0,right:0,bottom:0,left:0},c=i-s.left-s.right,u=o-s.top-s.bottom,P.select(".sc-background").attr("width",t).attr("height",e),m.width(i).height(o),d.call(m),f=m.getHeight(),s.top+=f,u=o-s.top-s.bottom,p.width(c).height(u),z.datum(F).attr("transform",B.translation(s.left,s.top)).transition().duration(l).call(p)},t.render(),m.legend.dispatch.on("legendClick",function(e,n){e.disabled=!e.disabled,e.active=!1,M.filter(function(t){return!t.disabled}).length||M.forEach(function(t){t.disabled=!1}),M.filter(function(t){return"active"===t.active}).length||M.forEach(function(t){t.active=""}),u.disabled=M.map(function(t){return!!t.disabled}),g.call("stateChange",this,u),t.update()}),g.on("tooltipShow",function(t){c&&(y=x(t,s.parentNode,k))}),g.on("tooltipMove",function(t){y&&R.position(s.parentNode,y,t)}),g.on("tooltipHide",function(){c&&R.cleanup()}),g.on("changeState",function(e){"undefined"!=typeof e.disabled&&(F.forEach(function(t,n){t.disabled=e.disabled[n]}),u.disabled=e.disabled),t.update()}),g.on("chartClick",function(){m.controls.enabled()&&m.controls.dispatch.call("closeMenu",this),m.legend.enabled()&&m.legend.dispatch.call("closeMenu",this)}),p.dispatch.on("elementClick",function(e){g.call("chartClick",this),w(M,e,t)})}),t}var n={top:10,right:10,bottom:10,left:10},r=null,a=null,i="ltr",o=0,l=0,c=!0,u={},f=!0,h={legend:{close:"Hide legend",open:"Show legend"},controls:{close:"Hide controls",open:"Show controls"},noData:"No Data Available.",noLabel:"undefined"},g=e.dispatch("chartClick","elementClick","tooltipShow","tooltipHide","tooltipMove","stateChange","changeState"),p=d(),m=s(),v=[],y=null,b=function(e,n){var r=p.fmtKey()(e),a=n.seriesLabel||"Key",i=p.getValue()(e),o=n.total?(100*i/n.total).toFixed(1):100,s="currency"===n.yDataType,l=B.numberFormat(i,2,s,t.locality()),c=B.numberFormat(o,2,!1,t.locality());return"<p>"+a+": <b>"+r+"</b></p><p>"+(s?"Amount":"Count")+": <b>"+l+"</b></p><p>Percent: <b>"+c+"%</b></p>"},x=function(t,e,n){var r=b(t,n);return R.show(t.e,r,null,null,e)},w=function(t,e,n){};return m.showTitle(!0).showControls(!1).showLegend(!0).alignLegend("center"),p.dispatch.on("elementMouseover.tooltip",function(t){g.call("tooltipShow",this,t)}),p.dispatch.on("elementMousemove.tooltip",function(t){g.call("tooltipMove",this,t)}),p.dispatch.on("elementMouseout.tooltip",function(){g.call("tooltipHide",this)}),t.dispatch=g,t.pie=p,t.legend=m.legend,t.controls=m.controls,t.options=B.optionsFunc.bind(t),B.rebind(t,p,"id","color","fill","classes","gradient","locality","textureFill"),B.rebind(t,p,"getKey","getValue","getCount","fmtKey","fmtValue","fmtCount"),B.rebind(t,p,"showLabels","showLeaders","donutLabelsOutside","pieLabelsOutside","labelThreshold"),B.rebind(t,p,"arcDegrees","rotateDegrees","minRadius","maxRadius","fixedRadius","startAngle","endAngle","donut","hole","holeFormat","donutRatio"),B.rebind(t,m,"showTitle","showControls","showLegend"),t.colorData=function(n){var r=arguments[0],a=arguments[1]||{},i=function(t,e){return B.defaultColor()(t,t.seriesIndex)},o=function(t,e){return"sc-series sc-series-"+t.seriesIndex};switch(r){case"graduated":i=function(t,n){return e.interpolateHsl(e.rgb(a.c1),e.rgb(a.c2))(t.seriesIndex/a.l)};break;case"class":i=function(){return"inherit"},o=function(t,e){var n=t.seriesIndex*(a.step||1)%14;return n=(n>9?"":"0")+n,"sc-series sc-series-"+t.seriesIndex+" sc-fill"+n+" sc-stroke"+n};break;case"data":i=function(t,e){return B.defaultColor()(t,t.seriesIndex)},o=function(t,e){return"sc-series sc-series-"+t.seriesIndex+(t.classes?" "+t.classes:"")}}var s=a.gradient?function(t,e){return p.gradientFill(t,t.seriesIndex)}:i;return p.color(i),p.fill(s),p.classes(o),m.legend.color(i),m.legend.classes(o),t},t.margin=function(e){if(!arguments.length)return n;for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);return t},t.width=function(e){return arguments.length?(r=e,t):r},t.height=function(e){return arguments.length?(a=e,t):a},t.tooltips=function(e){return arguments.length?(c=e,t):c},t.tooltipContent=function(e){return arguments.length?(b=e,t):b},t.state=function(e){return arguments.length?(u=e,t):u},t.strings=function(e){if(!arguments.length)return h;for(var n in e)e.hasOwnProperty(n)&&(h[n]=e[n]);return m.strings(h),t},t.direction=function(e){return arguments.length?(i=e,p.direction(e),m.direction(e),t):i},t.duration=function(e){return arguments.length?(l=e,p.duration(e),t):l},t.delay=function(e){return arguments.length?(o=e,p.delay(e),t):o},t.seriesClick=function(e){return arguments.length?(w=e,t):w},t}function x(){function t(r){return r.each(function(r){function a(t){z=e.hierarchy(t,function(t){return t.children}),R(z),N=z.descendants(),N.forEach(function(t){y(t,2*t.depth*(g?l.width:l.height))}),H=N.slice(1)}function c(t){b(t,w(t)),x(t,k(t)),t.children&&t.children.length&&t.children.forEach(c)}function m(t,e){var n=k(t)-(g?0:l.height-3*i),r=w(t)-(g?l.width-2*i:0),a=k(e),o=w(e),s=g?(r+o)/2:r,c=g?n:(n+a)/2,u=g?(r+o)/2:o,d=g?a:(n+a)/2;return"M"+r+","+n+"C"+s+","+c+" "+u+","+d+" "+o+","+a}function v(t){t.children?(t._children=t.children,t.children=null):(t.children=t._children,t._children=null)}function S(e){v(e.data),t.update(e)}function D(t){var e="node-"+A(t);return e}function L(t){var e="link-"+(t.parent?A(t.parent):0)+"-"+A(t);return e}var T=e.select(this),E=r,P=e.transition("tree").duration(o).ease(e.easeLinear),z=null,N=null,H=null,_=null,R=e.tree().size([null,null]).nodeSize([g?l.height:l.width,1]).separation(function J(t,e){return t.parent==e.parent,1}),O={width:parseInt(T.style("width"),10)-n.left-n.right,height:parseInt(T.style("height"),10)-n.top-n.bottom},V=T.selectAll("g.sc-chart-wrap").data([1]),W=V.enter().append("g").attr("class","sc-chart-wrap sc-chart-tree"),G=T.select(".sc-chart-wrap").merge(W),j=W.append("defs"),Y=G.select("defs").merge(j),q=B.dropShadow("node_back_"+p,Y,{blur:2});j.append("clipPath").attr("id","sc-edge-clip-"+p).append("rect");var X=Y.select("#sc-edge-clip-"+p+" rect");X.attr("width",O.width).attr("height",O.height).attr("x",n.left).attr("y",n.top),G.attr("clip-path",F?"url(#sc-edge-clip-"+p+")":""),W.append("rect").attr("class","sc-chart-background").attr("width",O.width).attr("height",O.height).attr("transform",B.translation(n.left,n.top)).style("fill","transparent");var Z=G.select(".sc-chart-background"),K=W.append("g").attr("class","sc-tree-wrap"),U=G.select(".sc-tree-wrap");K.append("g").attr("class","sc-wrap sc-tree");var $=G.select(".sc-wrap.sc-tree");t.setZoom=function(){_=e.zoom().scaleExtent([s.min,s.max]).on("zoom",function(){U.attr("transform","translate("+e.event.transform.x+","+e.event.transform.y+")scale("+e.event.transform.k+")"),d(e.event.transform.k)})},t.unsetZoom=function(t){_.on("zoom",null)},t.resetZoom=function(){G.call(_.transform,e.zoomIdentity)},t.orientation=function(e){g="horizontal"!==e&&g?!1:!0,R.nodeSize([g?l.height:l.width,1]),t.update(z)},t.showall=function(){function e(t){t._children&&t._children.length&&(t.children=t._children,t._children=null),t.children&&t.children.length&&t.children.forEach(e)}E=r,e(E),t.update(z)},t.zoomStep=function(t){var n=e.zoomTransform(G.node()),r=n.k+t;return this.zoomLevel(r)},t.zoomLevel=function(t){var n=e.zoomTransform(G.node()),r=Math.min(Math.max(t,s.min),s.max),a=n.k,i=[n.x,n.y],o=Z.node().getBoundingClientRect(),l=[o.width,o.height],c=[(l[0]-l[0]*r)/2,(l[1]-l[1]*r)/2],u=[r*(i[0]-(l[0]-l[0]*a)/2)/a,r*(i[1]-(l[1]-l[1]*a)/2)/a],d=[c[0]+u[0],c[1]+u[1]],f=e.zoomIdentity.translate(d[0],d[1]).scale(r);return G.call(_.transform,f),r},t.zoomScale=function(){var t=e.zoomTransform(G.node());return t.k},t.filter=function(e){function n(t){A(t)===e?(E=t,a=!0):!a&&t.children&&t.children.forEach(n)}var a=!1;n(r),t.update(z)},t.update=function(e){function n(t){if(A(e)===A(z))return m(z,z);var n={x:M(e),y:I(e)};return m(n,n)}function r(t){return m(t,t.parent)}function s(){return m(d,d)}var d={x:0,y:0};a(E);var p=(g?i-l.width:l.width/-2)+"px",v=(g?(i-l.height)/2:2*i-l.height)+"px",y=$.selectAll("g.sc-card").data(N,A),b;b=y.enter().insert("g").attr("class","sc-card").attr("id",D).attr("opacity",function(t){return A(e)===A(t)?1:0}).attr("transform",function(t){return A(e)===A(z)?"translate("+w(z)+","+k(z)+")":"translate("+(g?I(e):M(e))+","+(g?M(e):I(e))+")"}),b.each(function(t){var e,n;Y.select("#"+C(t)).empty()&&(e=Y.append("svg").attr("class","sc-foreign-object").attr("id",C(t)).attr("version","1.1").attr("xmlns","http://www.w3.org/2000/svg").attr("xmlns:xlink","http://www.w3.org/1999/xlink").attr("x",p).attr("y",v).attr("width",l.width+"px").attr("height",l.height+"px").attr("viewBox","0 0 "+l.width+" "+l.height).attr("xml:space","preserve"),n=e.append("g").attr("class","sc-tree-node-content").attr("transform","translate("+i+","+i+")"),u(n,t,l.width-2*i,l.height-3*i))}),b.append("use").attr("xlink:href",function(t){return"#"+C(t)}).attr("filter",q).on("click",h);var x;x=$.selectAll("g.sc-card").merge(b),x.transition(P).duration(o).attr("opacity",1).attr("transform",function(t){return A(e)===A(t)&&(d={x:g?k(t):w(t),y:g?w(t):k(t)}),"translate("+w(t)+","+k(t)+")"}).on("end",f);var F;F=y.exit().transition(P).duration(o).attr("opacity",0).attr("transform",function(t){return"translate("+M(e)+","+I(e)+")"}).remove(),F.selectAll(".sc-expcoll").style("stroke-opacity",1e-6),Y.selectAll(".sc-foreign-object").attr("x",p).attr("y",v);var T;T=b.append("g").attr("class","sc-expcoll").style("opacity",1e-6).on("click",S),T.append("circle").attr("class","sc-circ-back").attr("r",i),T.append("line").attr("class","sc-line-vert").attr("x1",0).attr("y1",.5-i).attr("x2",0).attr("y2",i-.5).style("stroke","#bbb"),T.append("line").attr("class","sc-line-hrzn").attr("x1",.5-i).attr("y1",0).attr("x2",i-.5).attr("y2",0).style("stroke","#fff");var _;_=$.selectAll("g.sc-expcoll").merge(T),_.style("opacity",function(t){return t.data.children&&t.data.children.length||t.data._children&&t.data._children.length?1:0}),_.select(".sc-circ-back").style("fill",function(t){return t.data._children&&t.data._children.length?"#777":t.data.children?"#bbb":"none"}),_.select(".sc-line-vert").style("stroke",function(t){return t.data._children&&t.data._children.length?"#fff":"#bbb"});var B=$.selectAll("path.link").data(H,L),R=B.enter().insert("path","g").attr("d",n).attr("class","link").attr("id",L).attr("opacity",0),O;O=$.selectAll("path.link").merge(R),O.transition(P).duration(o).attr("d",r).attr("opacity",1),B.exit().transition(P).duration(o).attr("d",s).attr("opacity",0).remove(),c(z),t.resize(A(e)===A(z))},t.render=function(){t.resize(!0)},t.resize=function(r){r="undefined"==typeof r?!0:r,t.resetZoom(),O={width:parseInt(T.style("width"),10)-n.left-n.right,height:parseInt(T.style("height"),10)-n.top-n.bottom};var a=[Math.abs(e.min(N,w))+Math.abs(e.max(N,w))+l.width,Math.abs(e.min(N,k))+Math.abs(e.max(N,k))+l.height],i=O.width/a[0],s=O.height/a[1],c=e.min([i,s]),u=[Math.abs(e.min(N,w))+(s>i?0:(O.width/c-a[0])/2),Math.abs(e.min(N,k))+(s>i?(O.height/c-a[1])/2:0)],d=[l.width/(g?1:2),l.height/(g?2:1)],f=[(u[0]+d[0])*c+n.left/(g?2:1),(u[1]+d[1])*c+n.top/(g?1:2)];X.attr("width",O.width).attr("height",O.height),Z.attr("width",O.width).attr("height",O.height),$.transition(P).duration(r?0:o).attr("transform","translate("+f+")scale("+c+")")},t.setZoom(),G.call(_),a(E),c(z),t.update(z)}),t}var n={top:10,right:10,bottom:10,left:10},r=null,a=null,i=6,o=0,s={min:.25,max:2},l={width:100,height:50},c="../img/",u=function(t){return'<div class="sc-tree-node"></div>'},d=function(t){},f=function(t){},h=function(t){},g=!1,p=Math.floor(1e4*Math.random()),m=function(t,e){return B.defaultColor()(t,e)},v=function(t,e){return m(t,e)},y=function(t,e){t.y=e},b=function(t,e){t.data.x0=e},x=function(t,e){t.data.y0=e},w=function(t){return g?t.y:t.x},k=function(t){return g?t.x:t.y},M=function(t){return g?t.data.y0:t.data.x0},I=function(t){return g?t.data.x0:t.data.y0},A=function(t){return t.id||t.data.id},C=function(t){return"card-"+A(t)},S=!1,F=!0,D=!0,L=e.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout");return t.dispatch=L,t.options=B.optionsFunc.bind(t),t.id=function(e){return arguments.length?(p=e,t):p},t.margin=function(e){return arguments.length?(n=e,t):n},t.width=function(e){return arguments.length?(r=e,t):r},t.height=function(e){return arguments.length?(a=e,t):a},t.x=function(e){return arguments.length?(w=e,t):w},t.y=function(e){return arguments.length?(k=B.functor(e),t):k},t.showLabels=function(e){return arguments.length?(D=e,t):D},t.color=function(e){return arguments.length?(m=e,t):m},t.fill=function(e){return arguments.length?(v=e,t):v},t.useClass=function(e){return arguments.length?(S=e,
t):S},t.radius=function(e){return arguments.length?(i=e,t):i},t.duration=function(e){return arguments.length?(o=e,t):o},t.zoomExtents=function(e){return arguments.length?(s=e,t):s},t.zoomCallback=function(e){return arguments.length?(d=e,t):d},t.nodeSize=function(e){return arguments.length?(l=e,t):l},t.nodeImgPath=function(e){return arguments.length?(c=e,t):c},t.nodeRenderer=function(e){return arguments.length?(u=e,t):u},t.nodeCallback=function(e){return arguments.length?(f=e,t):f},t.nodeClick=function(e){return arguments.length?(h=e,t):h},t.horizontal=function(e){return arguments.length?(g=e,t):g},t.getId=function(e){return arguments.length?(A=e,t):A},t.getCardId=function(e){return arguments.length?(C=e,t):C},t}e="default"in e?e["default"]:e;var w="@sugarcrm/sucrose-sugar",k="0.7.4",M="Interactive Charts for Business Applications",I=["charts","d3","visualization","svg","mobile","canvas"],A="http://sucrose.io/",C="Apache-2.0",S={name:"Henry Rogers",url:"https://github.com/hhrogersii"},F="build/sucrose.node.js",D="build/sucrose.js",L="index",T={"extends":"stylelint-config-standard"},E=["> 5%"],P={type:"git",url:"https://github.com/sugarcrm/sucrose.git"},z={instrument:"rimraf ./tests/fixtures/build && nyc instrument ./build/sucrose.js ./test/fixtures/ && cp ./build/d3.min.js ./test/fixtures/build/d3.min.js && cp ./build/sucrose.min.css ./test/fixtures/build/sucrose.min.css","cover-all":"nyc tape ./test/specs/**/*-test.js --cover","cover-unit":"nyc tape ./test/specs/unit/*-test.js","cover-dom":"nyc tape ./test/specs/dom/*-test.js","cover-int":"nyc tape ./test/specs/int/*-test.js --cover","cover-rpt":"nyc report","report-coverage":"nyc report --reporter=lcov > coverage.lcov && codecov",test:"npm run instrument && npm run cover-all","test-all":"tape 'test/specs/**/*-test.js' | faucet","test-unit":"tape test/specs/unit/*-test.js","test-dom":"tape test/specs/dom/*-test.js","test-int":"tape test/specs/int/*-test.js",lintcss:'stylelint "src/less/**/*.less" --syntax less',"package":"json2module package.json > build/package.js"},N={include:["**/build/sucrose.js"],reporter:["lcov","clover"],cache:!1,"temp-directory":".coverage"},H={"@sugarcrm/d3-sugar":"4.9.1"},_={cldr:"^4.5.0","cldr-data":"^32.0.0",cldrjs:"^0.5.0","clean-css-cli":"^4.1.10",codecov:"^3.0.0","extend-tape":"^1.2.0",faucet:"^0.0.1",istanbul:"^0.4.5",jsdom:"11.2.0",jshint:"^2.9.4",json2module:"^0.0.3",less:"^2.6.0","less-plugin-autoprefix":"^1.5.1","less-plugin-clean-css":"^1.5.1","make-help":"^1.0.1",nightmare:"^2.10.0",nyc:"^11.3.0","package-preamble":"^0.1.0",postcss:"^5.2.17",rimraf:"^2.6.1",rollup:"^0.36.3","rollup-plugin-ascii":"0.0.3","rollup-plugin-cleanup":"^1.0.0","rollup-plugin-eslint":"^3.0.0","rollup-plugin-node-resolve":"^2.0.0","rollup-plugin-replace":"^1.1.1",stylelint:"^8.2.0","stylelint-config-standard":"^17.0.0",tape:"^4.8.0",tapes:"^4.1.0","uglify-js":"2.6.1"},B={};B.identity=function(t){return t},B.functor=function Y(t){return"function"==typeof t?t:function(){return t}},B.isFunction=function(t){var e={};return t&&"[object Function]"==e.toString.call(t)},B.rebind=function(t,e){for(var r=1,a=arguments.length,i;++r<a;)t[i=arguments[r]]=n(t,e,e[i]);return t},B.optionsFunc=function(t){return t?(e.map(t).each(function(t,e){var n=this[e],r=B.toNative(t);B.isFunction(n)&&(Array.isArray(r)?n.apply(r):n(r))}.bind(this)),this):this},B.windowSize=function(){var t={};return window.innerWidth&&window.innerHeight?(t.width=window.innerWidth,t.height=window.innerHeight):document.body&&document.body.offsetWidth?(t.width=document.body.offsetWidth,t.height=document.body.offsetHeight):"CSS1Compat"===document.compatMode&&document.documentElement&&document.documentElement.offsetWidth?(t.width=document.documentElement.offsetWidth,t.height=document.documentElement.offsetHeight):(t.width=640,t.height=480),t},B.windowResize=function(t){window.attachEvent?window.attachEvent("onresize",t):window.addEventListener&&window.addEventListener("resize",t,!0)},B.windowUnResize=function(t){window.detachEvent?window.detachEvent("onresize",t):window.removeEventListener&&window.removeEventListener("resize",t,!0)},B.resizeOnPrint=function(t){if(window.matchMedia){var e=window.matchMedia("print");e.addListener(function(e){e.matches&&t()})}else window.attachEvent?window.attachEvent("onbeforeprint",t):window.onbeforeprint=t},B.unResizeOnPrint=function(t){if(window.matchMedia){var e=window.matchMedia("print");e.removeListener(function(e){e.matches&&t()})}else window.detachEvent?window.detachEvent("onbeforeprint",t):window.onbeforeprint=null},B.getColor=function(t){return arguments.length?Array.isArray(t)?function(e,n){return e.color||t[n%t.length]}:"[object String]"===Object.prototype.toString.call(t)?function(e){return e.color||"#"+t.replace("#","")}:t:B.defaultColor()},B.defaultColor=function(){var t=e.scaleOrdinal(e.schemeCategory20).range();return function(e,n){return e.color||t[n%t.length]}},B.getTextContrast=function(t,n,r){var a=t,i=e.lab(a),o=i.l,s=o>60?i.darker(4+(o-75)/25).l:i.brighter(4+(18-o)/25).l,l=e.lab(s,0,0),c=l.toString();return r&&r(i,l),c},B.customTheme=function(t,n,r){var a;return n=n||function(t){return t.key},r=r||e.scaleOrdinal(e.schemeCategory20).range(),a=r.length,function(e,i){var o=n(e);return a||(a=r.length),"undefined"!=typeof t[o]?"function"==typeof t[o]?t[o]():t[o]:r[--a]}},B.colorLinearGradient=function(t,n,r,a,i){var o="lg_gradient_"+n,s=i.select("#"+o);return s.empty()&&("middle"===r.position?B.createLinearGradient(o,r,i,[{offset:"0%","stop-color":e.rgb(a).darker().toString(),"stop-opacity":1},{offset:"20%","stop-color":e.rgb(a).toString(),"stop-opacity":1},{offset:"50%","stop-color":e.rgb(a).brighter().toString(),"stop-opacity":1},{offset:"80%","stop-color":e.rgb(a).toString(),"stop-opacity":1},{offset:"100%","stop-color":e.rgb(a).darker().toString(),"stop-opacity":1}]):B.createLinearGradient(o,r,i,[{offset:"0%","stop-color":e.rgb(a).darker().toString(),"stop-opacity":1},{offset:"50%","stop-color":e.rgb(a).toString(),"stop-opacity":1},{offset:"100%","stop-color":e.rgb(a).brighter().toString(),"stop-opacity":1}])),"url(#"+o+")"},B.createLinearGradient=function(t,e,n,r){var a="horizontal"===e.orientation?"0%":"100%",i="horizontal"===e.orientation?"100%":"0%",o,s,l=n.append("linearGradient");l.attr("id",t).attr("x1","0%").attr("y1","0%").attr("x2",a).attr("y2",i).attr("spreadMethod","pad");for(var c=0;c<r.length;c+=1)o=r[c],s=l.append("stop"),Object.getOwnPropertyNames(o).forEach(function(t){s.attr(t,o[t])})},B.colorRadialGradient=function(t,n,r,a,i){var o="rg_gradient_"+n,s=i.select("#"+o);return s.empty()&&B.createRadialGradient(o,r,i,[{offset:r.s,"stop-color":e.rgb(a).brighter().toString(),"stop-opacity":1},{offset:"100%","stop-color":e.rgb(a).darker().toString(),"stop-opacity":1}]),"url(#"+o+")"},B.createRadialGradient=function(t,e,n,r){var a,i,o;o=n.append("radialGradient").attr("id",t).attr("r",e.r).attr("cx",e.x).attr("cy",e.y).attr("gradientUnits",e.u).attr("spreadMethod","pad");for(var s=0;s<r.length;s+=1)a=r[s],i=o.append("stop"),Object.getOwnPropertyNames(a).forEach(function(t){i.attr(t,a[t])})},B.roundedRectangle=function(t,e,n,r,a){var i="M"+t+","+e+"h"+(n-2*a)+"a"+a+","+a+" 0 0 1 "+a+","+a+"v"+(r-2-2*a)+"a"+a+","+a+" 0 0 1 "+-a+","+a+"h"+(2*a-n)+"a"+-a+","+a+" 0 0 1 "+-a+","+-a+"v"+(-r+2*a+2)+"a"+a+","+a+" 0 0 1 "+a+","+-a+"z";return i},B.dropShadow=function(t,e,n){var r=n||{},a=r.height||"130%",i=r.offset||2,o=r.blur||1,s,l;return e.select("#"+t).empty()&&(s=e.append("filter").attr("id",t).attr("height",a),s.append("feOffset").attr("in","SourceGraphic").attr("result","offsetBlur").attr("dx",i).attr("dy",i),s.append("feColorMatrix").attr("in","offsetBlur").attr("result","matrixOut").attr("type","matrix").attr("values","1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 1 0"),s.append("feGaussianBlur").attr("in","matrixOut").attr("result","blurOut").attr("stdDeviation",o),l=s.append("feMerge"),l.append("feMergeNode"),l.append("feMergeNode").attr("in","SourceGraphic")),"url(#"+t+")"},B.createTexture=function(t,e,n,r){var a="#sc-diagonalHatch-"+e,i="#sc-textureMask-"+e;return t.append("pattern").attr("id","sc-diagonalHatch-"+e).attr("patternUnits","userSpaceOnUse").attr("width",8).attr("height",8).append("path").attr("d","M-1,1 l2,-2 M0,8 l8,-8 M7,9 l1,-1").attr("class","texture-line").attr("stroke","#fff").attr("stroke-linecap","square"),t.append("mask").attr("id","sc-textureMask-"+e).attr("x",0).attr("y",0).attr("width","100%").attr("height","100%").append("rect").attr("x",n||0).attr("y",r||-1).attr("width","100%").attr("height","100%").attr("fill","url("+a+")"),i},B.stringSetLengths=function(t,e,n,r,a){var i=[],o=e.select(".tmp-text-strings").select("text");return o.empty()&&(o=e.append("g").attr("class","tmp-text-strings").append("text")),o.classed(r,!0),o.style("display","inline"),t.forEach(function(t,e){o.text(n(t,e)),i.push(o.node().getBoundingClientRect().width)}),o.text("").attr("class","tmp-text-strings").style("display","none"),i},B.stringSetThickness=function(t,e,n,r,a){var i=[],o=e.select(".tmp-text-strings").select("text");return o.empty()&&(o=e.append("g").attr("class","tmp-text-strings").append("text")),o.classed(r,!0),o.style("display","inline"),t.forEach(function(t,e){o.text(n(t,e)),i.push(o.node().getBoundingClientRect().height)}),o.text("").attr("class","tmp-text-strings").style("display","none"),i},B.maxStringSetLength=function(t,n,r,a){var i=B.stringSetLengths(t,n,r,a);return e.max(i)},B.stringEllipsify=function(t,e,n){var r=e.select(".tmp-text-strings").select("text"),a=t,i=0,o=0,s=0;for(r.empty()&&(r=e.append("g").attr("class","tmp-text-strings").append("text")),r.style("display","inline"),r.text("..."),o=r.node().getBoundingClientRect().width,r.text(a),i=r.node().getBoundingClientRect().width,s=i;i>n&&i>30;)a=a.slice(0,-1),r.text(a),i=r.node().getBoundingClientRect().width+o;return r.text(""),a+(s>n?"...":"")},B.getTextBBox=function(t,e){var n=t.node().getBoundingClientRect(),r={width:e?n.width:parseInt(n.width,10),height:e?n.height:parseInt(n.height,10),top:e?n.top:parseInt(n.top,10),left:e?n.left:parseInt(n.left,10)};return r},B.strip=function(t){return t.replace(/(\s|&)/g,"")},B.isRTLChar=function(t){var e="---",n=new RegExp("["+e+"]");return n.test(t)},B.NaNtoZero=function(t){return B.isNumeric(t)?t:0},B.polarToCartesian=function(t,e,n,r){var a=B.angleToRadians(r),i=t+n*Math.cos(a),o=e+n*Math.sin(a);return[i,o]},B.angleToRadians=function(t){return t*Math.PI/180},B.angleToDegrees=function(t){return 180*t/Math.PI},B.getAbsoluteXY=function(t){var e=document.documentElement,n=t.getBoundingClientRect(),r=e.scrollLeft+document.body.scrollLeft,a=e.scrollTop+document.body.scrollTop,i=n.left+r,o=n.top+a;return{left:i,top:o}},B.translation=function(t,e){return"translate("+t+","+e+")"},B.isNumeric=function(t){return!isNaN(t)&&"number"==typeof t&&isFinite(t)},B.toNative=function(t){var e=B.isNumeric(parseFloat(t))?parseFloat(t):"true"===t?!0:"false"===t?!1:t;return e},B.toBoolean=function(t){var e=B.isNumeric(parseFloat(t))?!!parseFloat(t):"true"===t?!0:"false"===t?!1:t;return e},B.round=function(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n},B.countSigFigsAfter=function(t){return Math.floor(t)!==parseFloat(t)?parseFloat(t).toString().split(".").pop().length||0:0},B.countSigFigsBefore=function(t){return Math.floor(t).toString().replace(/0+$/g,"").length},B.siDecimal=function(t){return Math.pow(10,Math.floor(Math.log(t)*Math.LOG10E))},B.siValue=function(t){if(B.isNumeric(t))return B.siDecimal(t);var e={y:1e-24,yocto:1e-24,z:1e-21,zepto:1e-21,a:1e-18,atto:1e-18,f:1e-15,femto:1e-15,p:1e-12,pico:1e-12,n:1e-9,nano:1e-9,"":1e-6,micro:1e-6,m:.001,milli:.001,k:1e3,kilo:1e3,M:1e6,mega:1e6,G:1e9,giga:1e9,T:1e12,tera:1e12,P:1e15,peta:1e15,E:1e18,exa:1e18,Z:1e21,zetta:1e21,Y:1e24,yotta:1e24};return e[t]||0},B.numberFormat=function(t,n,r,a){var i,o,s;return r="boolean"==typeof r?r:!1,!B.isNumeric(t)||0===t&&!r?t.toString():(n=B.isNumeric(n)?n:r?2:0,s=B.countSigFigsAfter(t),n=s&&r?n:Math.min(n,s),i="undefined"==typeof a?e.format:e.formatLocale(a).format,o=r?"$,":",",o+=s?"."+n+"f":"",i(o)(t))},B.numberFormatFixed=function(t,n,r,a){var i,o;return B.isNumeric(t)?(r="boolean"==typeof r?r:!1,n=B.isNumeric(n)?n:r?2:0,i="undefined"==typeof a?e.format:e.formatLocale(a).format,o=r?"$,":",",o+="."+n+"f",i(o)(t)):t.toString()},B.numberFormatSI=function(t,n,r,a){var i,o,s;if(!B.isNumeric(t))return t;if(r="boolean"==typeof r?r:!1,n=B.isNumeric(n)?n:0,i="undefined"==typeof a?e.format:e.formatLocale(a).format,s=B.countSigFigsAfter(t),o=r?"$,":",",r&&s&&1e3>t)t=B.round(t,n),s=B.countSigFigsAfter(t),n=Math.min(s,n),1===n&&(n=2),o+="."+n+"f";else if(Math.abs(t)<1)o+=0===+t.toFixed(n)?".1s":"."+Math.min(n,s)+"f";else{if(!(Math.abs(t)<1e3)){if(i="undefined"==typeof a?e.formatPrefix:e.formatLocale(a).formatPrefix,0!==n){var l=i("."+n+"s",t)(t),c=l.split(".").pop().replace(/[^\d]+$/,"").match(/0+$/g);Array.isArray(c)&&(n-=c.pop().length)}return o+="."+n+"s",i(o,t)(t)}t=B.round(t,n)}return i(o)(t)},B.numberFormatSIFixed=function(t,n,r,a,i){var o,s;return B.isNumeric(t)?(r="boolean"==typeof r?r:!1,n=B.isNumeric(n)?n:r?2:0,o="undefined"==typeof a?e.formatPrefix:e.formatLocale(a).formatPrefix,i=B.siValue(i),s=r?"$,":",",s+="."+n+"s",o(s,i)(t)):t.toString()},B.daysInMonth=function(t,e){return new Date(e,t+1,0).getDate()},B.isValidDate=function(t){return t?t instanceof Date&&!isNaN(t.valueOf()):!1},B.parseDatetime=function(t){var e,n;return B.isNumeric(Math.floor(t))&&4===t.toString().length?e=new Date(Math.floor(t)+"-1-1 GMT"):parseInt(t,10).toString()===t||parseInt(t,10)===t?e=new Date(parseInt(t,10)):(e=new Date(t),"Z"===t.toString().substr(-1)||-1!==t.toString().indexOf("GMT")||t.toString().match(/\d\d\d\d-\d\d-\d\dT/)||e.setUTCMilliseconds(e.getUTCMilliseconds()-6e4*e.getTimezoneOffset())),B.isValidDate(e)||(e=t),e},B.getDateFormat=function(t,n){var r=["multi","%x, %I:%M:%S.%L %p","%x, %I:%M:%S %p","%x, %I:%M %p","%x, %I %p","%x","%b %d","%B %Y","%Y"],a=t.length?e.min(t,function(t){n===!0&&t.setUTCMilliseconds(t.getUTCMilliseconds()+6e4*t.getTimezoneOffset());var r=new Date(t),a;return a=+e.timeSecond(t)<+r?1:+e.timeMinute(t)<+r?2:+e.timeHour(t)<+r?3:+e.timeDay(t)<+r?4:+e.timeMonth(t)<+r?5:+e.timeYear(t)<+r?7:8}):8;return r[a]},B.getDateFormatUTC=function(t){var n=["multi","%x, %I:%M:%S.%L %p","%x, %I:%M:%S %p","%x, %I:%M %p","%x, %I %p","%x","%b %d","%B %Y","%Y"],r=t.length?e.min(t,function(t){var n=new Date(t),r;return r=+e.utcSecond(t)<+n?1:+e.utcMinute(t)<+n?2:+e.utcHour(t)<+n?3:+e.utcDay(t)<+n?4:+e.utcMonth(t)<+n?5:+e.utcYear(t)<+n?7:8}):8;return n[r]},B.multiFormat=function(t,e){return e===!1?B.getDateFormat([t]):B.getDateFormatUTC([t])},B.dateFormat=function(t,n,r){var a,i,o,s=t.toString(),l=B.parseDatetime(t);return B.isValidDate(l)?(r&&r.hasOwnProperty("utcFormat")?(i=r.utcFormat,o=n?-1!==n.indexOf("%")?n:B.multiFormat(l):"%Y"):(a=B.buildLocality(r),i=e.timeFormatLocale(a).utcFormat,o=n?-1!==n.indexOf("%")?n:a[n]||B.multiFormat(l):"%Y"),i(o)(l)):t},B.buildLocality=function(t,e){var n=t||{},r=!!e,a=function(t){return t.join("|").split("|").map(function(t){return t?isNaN(t)?t:+t:""})},i={decimal:".",thousands:",",grouping:[3],currency:["$",""],periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],date:"%b %-d, %Y",time:"%-I:%M:%S %p",dateTime:"%B %-d, %Y at %X GMT%Z",full:"%A, %c","long":"%c",medium:"%x, %X","short":"%-m/%-d/%y, %-I:%M %p",yMMMEd:"%a, %x",yMEd:"%a, %-m/%-d/%Y",yMMMMd:"%B %-d, %Y",yMMMd:"%x",yMd:"%-m/%-d/%Y",yMMMM:"%B %Y",yMMM:"%b %Y",MMMd:"%b %-d",MMMM:"%B",MMM:"%b",y:"%Y"},o;return Object.getOwnPropertyNames(n).forEach(function(t){o=n[t],i[t]=r&&Array.isArray(o)?a(o):o}),i},B.displayNoData=function(t,e,n,r,a){var i=t?[]:[n],o=e.selectAll(".sc-no-data").data(i),s=o.enter().append("text").attr("class","sc-no-data").attr("dy","-.7em").style("text-anchor","middle"),l=e.selectAll(".sc-no-data").merge(s);return o.exit().remove(),i.length?(l.attr("x",r).attr("y",a).text(B.identity),e.selectAll(".sc-chart-wrap").remove(),!0):!1};var R={};R.show=function(t,e,n,r,a,i){var o=document.createElement("div"),s=document.createElement("div"),l=document.createElement("div");return n=n||"s",r=r||5,s.className="tooltip-inner",l.className="tooltip-arrow",s.innerHTML=e,o.style.left=0,o.style.top=-1e3,o.style.opacity=0,o.className="tooltip xy-tooltip in",o.appendChild(s),o.appendChild(l),a.appendChild(o),R.position(a,o,t,n,r),o.style.opacity=1,o},R.cleanup=function(){for(var t=document.getElementsByClassName("tooltip"),e=[],n=t.length;n>0;)n-=1,-1!==t[n].className.indexOf("xy-tooltip")&&(e.push(t[n]),t[n].style.transitionDelay="0 !important",t[n].style.opacity=0,t[n].className="sctooltip-pending-removal out");setTimeout(function(){for(var t;e.length;)t=e.pop(),t.parentNode.removeChild(t)},500)},R.position=function(t,e,n,r,a){function i(){var t=u[0]-d/2;return p>t&&(t=p),t+d>h&&(t=h-d),t}function o(){var t=u[1]-f/2;return m>t&&(t=m),t+f>m+g&&(t=m-f),t}function s(t){var n=u[0]-d/2-t-5,r=e.getElementsByClassName("tooltip-arrow")[0];r.style.marginLeft=n+"px"}function l(t){var n=u[1]-f/2-t-5,r=e.getElementsByClassName("tooltip-arrow")[0];r.style.marginTop=n+"px"}r=r||"s",a=a||5;var c=t.getBoundingClientRect(),u=[n.clientX-c.left,n.clientY-c.top],d=parseInt(e.offsetWidth,10),f=parseInt(e.offsetHeight,10),h=t.clientWidth,g=t.clientHeight,p=t.scrollLeft,m=t.scrollTop,v=e.className.replace(/ top| right| bottom| left/g,""),y,b;switch(r){case"e":b=o(),y=u[0]-d-a,l(b),p>y?(y=u[0]+a,v+=" right"):v+=" left";break;case"w":b=o(),y=u[0]+a,l(b),y+d>h?(y=u[0]-d-a,v+=" left"):v+=" right";break;case"n":y=i(),b=u[1]+a,s(y),b+f>m+g?(b=u[1]-f-a,v+=" top"):v+=" bottom";break;case"s":y=i(),b=u[1]-f-a,s(y),m>b?(b=u[1]+a,v+=" bottom"):v+=" top"}e.style.left=y+"px",e.style.top=b+"px",e.className=v};var O={axis:r,funnel:a,gauge:i,headers:s,line:c,menu:o,multibar:u,pie:d,scatter:l,scroller:f},V={bubbleChart:h,funnelChart:g,gaugeChart:p,lineChart:m,multibarChart:v,paretoChart:y,pieChart:b,treeChart:x},W=function(t,n,r){function a(t){return(t.hasOwnProperty("label")?t.label:String(t))||p}function i(t,e){var n={group:e+1,label:a(t)};return t.values&&(n.total=A(t.values)),n}function o(t){return t.key||a(t)}function s(t){return t&&t.filter(function(t){return t.values&&t.values.length}).length>0}function l(t,e){var n=["multibar","line","area","pie","funnel","gauge"];return-1!==n.indexOf(t)&&s(e)}function c(t){return Array.isArray(t)&&t.length&&Array.isArray(t[0])}function u(t){return 1===e.max(t,function(t){return t.values.length})}var d=[],f,h=t.properties?Array.isArray(t.properties)?t.properties[0]:t.properties:{},g=0,p="Undefined",m=!0,v=!1,y=!1,b=[],x=h.groups||t.label||h.labels||h.label||[],w=[],k="datetime"===h.xDataType||!1,M="ordinal"===h.xDataType||!1,I="numeric"===h.xDataType||!1,A=function(t){return t?t.reduce(function(t,e){return parseFloat(t)+e},0):0};if(v=c(t.values),v?(b=h.keys||t.values.splice(0,1)[0].splice(1),x=[],f=e.transpose(t.values.map(function(t,e){var n=t.splice(0,1)[0];return M&&x.push(i(n,e)),t.map(function(t,r){return k||I?[n,t]:M?[e+1,t]:void 0})})),d=b.map(function(t,e){return{key:t,values:f[e]}})):d=t.data,m=l(n,d)){v=c(d[0].values),y=u(d);var C=v?function(t){return t[0]}:function(t){return t.x},S=v?function(t){return t[1]}:function(t){return t.y},F=v?function(t,e){return{x:D(t[0],e),y:L(t[1],e)}}:function(t,e){return t.x=D(t.x,e),t.y=L(t.y,e),t},D=k?function(t,e,n){var r=4===t.toString().length?"1/1/"+t.toString():t;-1===r.indexOf("GMT")&&(r+=" GMT");var a=new Date(r);return a.toUTCString()}:M?function(t,e){return e+1}:I?function(t,e){return parseFloat(t)}:function(t){return t},L=function(t){return parseFloat(t)};switch(n){case"multibar":"basic"===r?1===d.length?(d=d.map(function(t,e){return t.key=o(t)||"Series "+e,t.values=t.values.map(function(t,e){return F(t,e)}),t}),h.seriesLength=d[0].values.length):(d=[{key:h.key||"Series 0",values:d.reduce(function(t,e,n){return e?v?t.values.map(function(t,n){return{x:D(C(t),n),y:L(S(t),n)+S(e.values[n])}}):t.values.map(function(t,n){return t.x=D(C(t),n),t.y=L(S(t),n)+S(e.values[n]),t}):t})}],h.seriesLength=d[0].values.length):y?(d=d.map(function(t,e){return{key:o(t),values:d.map(function(t,n){var r=t.values[0];return e===n?v?{x:D(C(r),n),y:L(S(r),n)}:(r.x=D(C(r),n),r.y=L(S(r),n),r):{x:D(C(r),n),y:0}})}}),h.seriesLength=d.length):(d=d.map(function(t,e){return t.key=o(t),t.values=t.values.map(function(t,e){return F(t,e)}),t}),h.seriesLength=d.length);break;case"pie":d=d.map(function(t,e){var n={key:o(t),disabled:t.disabled||!1,value:A(t.values)};return void 0!==t.color&&(n.color=t.color),void 0!==t.classes&&(n.classes=t.classes),n}),h.seriesLength=d.length;break;case"funnel":d=d.reverse().map(function(t,n){return{key:o(t),disabled:t.disabled||!1,values:[{series:n,x:0,y:e.sum(t.values,function(t){return S(t)}),y0:0}]}}),h.seriesLength=d.length;break;case"area":case"line":d.forEach(function(t,n){t.seriesIndex=n,t.key=o(t),t.values=v?t.values.map(function(t,e){return{x:D(t[0],n,e),y:parseFloat(t[1])}}):t.values.map(function(t,e){return t.x=D(t.x,n,e),t.y=parseFloat(t.y),t}),t.total=e.sum(t.values,function(t){return t.y}),t.total||(t.disabled=!0)}),h.seriesLength=d.length;break;case"gauge":g=t.values.shift().gvalue;var T=0;d=d.map(function(t,e){var n={key:a(t),y:parseFloat(t.values[0])+T};return T+=parseFloat(t.values[0]),n}),w=[{group:1,label:"Sum",total:g}],h.seriesLength=w.length}x.length&&(h.groups=x.map(i))}else switch(n){case"bubble":if(!t.data){var E={"Negotiation/Review":"Negotiat./Review","Perception Analysis":"Percept. Analysis","Proposal/Price Quote":"Proposal/Quote","Id. Decision Makers":"Id. Deciders"};d={data:t.records.map(function(t){return{id:t.id,x:t.date_closed,y:Math.round(parseInt(t.likely_case,10)/parseFloat(t.base_rate)),shape:"circle",account_name:t.account_name,assigned_user_name:t.assigned_user_name,sales_stage:t.sales_stage,sales_stage_short:E[t.sales_stage]||t.sales_stage,probability:parseInt(t.probability,10),base_amount:parseInt(t.likely_case,10),currency_symbol:"$"}}),properties:{title:"Bubble Chart Data",yDataType:"string",xDataType:"datetime",seriesLength:t.records.length}}}}return{properties:h,data:d}},G=!1,j="sgr";t.development=G,t.build=j,t.version=k,t.utility=B,t.utils=B,t.tooltip=R,t.models=O,t.charts=V,t.transform=W,Object.defineProperty(t,"__esModule",{value:!0})});
